-- This file has been generated by Dungeon Editor 1.3.6

--- level 1 ---

mapName("Upper Sewer Level")
setWallSet("sewers")
playStream("assets/samples/music/dungeon_ambient.ogg")
mapDesc([[
################################
#...############################
#.##############################
#...############################
#.#.#..#########################
#.#....#########################
################################
####################..##########
####################..##########
################...##..#########
################.#...#.#########
##########.#####.##.....########
##########.###.....###..########
##########.###.###.#.#.#########
##########.##..#...#.#.#########
###.............#..#...#########
##..#########..##.#..#.#########
##..######...##.#.#..#.#########
##..####..........#.#...#.######
##..####.#...##.##..##.#...#####
##..####.#######....#...#.######
##..##...........##.#...#.######
##..##.#.##########..#.#..######
##..##.#...........#.....#######
##..##.#...###...#####.#########
##..##.#...#.#.##......#########
##..#...###.......##############
#####.......####################
#####...########################
################################
################################
#############################.##
]])
spawn("script_entity", 10,0,2, "texts")
	:setSource("-- Text and variables library\
\
t = {}\
\
function setT(name, value)\
   t[name] = value\
end\
\
function getT(name)\
   return t[name]\
end\
\
-- Letter (starting item) --\
setT(\"commission_letter\",[[\
This document is a binding commission of service to\
the Lords and Sovereign City of Waterdeep. \
The bearers of this document are agents of the Lords\
of Waterdeep and are granted full rights of passage\
beneath the City of Waterdeep. Any who woud dare\
interfere risk the full penalty of our wrath.\
Information has been presented to us that there is\
a plot afoot in our city. Evidence points to the\
sewers that run beneath Waterdeep. We have no\
information about the exact nature of the threat,\
but we feel the urgency is grave. We commission you\
to find the nature of the danger, and to destroy it\
if you are able. You are granted full rights of\
Marque. All treasures , artifacts, or other valuables\
are yours by right of conquest.\
\
This writ is made legal and binding, by our Mark on\
this fifth day of Marpenoth in the year of Shadows.\
]])\
\
-- TEXTS in alphabetical order --\
\
setT(\"carving_to_place\", \"What an odd Carving to place here.\")\
setT(\"character_can_translate_rune\", \" can translate this text.\\nIt is the Kobold rune for Entrance.\")\
setT(\"character_cannot_translate_rune\", \" This Rune is unrecognized.\\nNo one in the party can translate it.\")\
setT(\"dagger_fits\", \"The Dagger fits.\")\
setT(\"dagger_undetachable\", \"The dagger is undetachable!\")\
setT(\"dead_end\", \"Dead end?\")\
setT(\"dead_end_show\", \"yes\")\
setT(\"door_appears_stuck\",\"The door appears stuck.\")\
setT(\"door_appears_stuck_pressed\",\"no\")\
setT(\"door_member_try_open_ok\",\" forces the door!\")\
setT(\"door_member_try_open_failed\",\" tries to force the door and fails.\")\
setT(\"door_party_try_open\",\"The party tries to force the door...\")\
setT(\"door_party_try_open_ok\",\"The party forces the door.\")\
setT(\"door_party_try_open_failed\",\"The party tries to force the door and fails.\")\
setT(\"door_party_try_open_again\",\"You can try to force the door again by moving to it once more...\")\
setT(\"feel_dizzy\", \"You feel dizzy.\")\
setT(\"feels_no_longer_hungry\", \"feels no longer hungry!\")\
setT(\"goind_down\",\"Going down...\")\
setT(\"goind_up\",\"Going up...\")\
setT(\"hollow_laughter\",\"A hollow laughter echoes faintly.\")\
setT(\"look_like_travel_marker\", \"This looks like a Travel marker.\")\
setT(\"not_all_is_as_it_appears\", \"Not all is as it appears\")\
setT(\"only_the_strong\",\"Only the Strong shall pass.\")\
setT(\"room_move\",\"The Room seems to move.\")\
setT(\"smells_terrible_here\",\"It smells terrible here.\")\
setT(\"special_quest_for_this_level\", \"Special Quest for this level!\")\
setT(\"watch_your_step\", \"Watch your step.\")\
setT(\"entrance_is_blocked\",\"...the Entrance to the sewers is now blocked...\")\
setT(\"welcome_to_eob\", \"Welcome to the Eye of the Beholder recreation!\")\
setT(\"whispering_voice_illusion\", \"A whispering voice says 'Illusion, solid illusion'\")")
spawn("eob_rock", 10,15,0, "eob_rock_1")
spawn("eob_rock", 10,15,3, "eob_rock_2")
spawn("eob_sewers_door_metal", 16,11,2, "dungeon_door_metal_2")
	:addPullChain()
spawn("eob_sewers_door_metal", 18,13,0, "dungeon_door_metal_3")
	:addPullChain()
spawn("eob_lever", 13,14,0, "eob_lever_1")
	:addConnector("any", "eob_sewers_door_metal_1", "toggle")
spawn("eob_sewers_cave_in", 10,14,0, "eob_sewers_cave_in_1")
spawn("pressure_plate_hidden", 18,13,2, "pressure_plate_hidden_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_1", "openSW1")
spawn("eob_sewers_door_metal", 17,23,3, "dungeon_door_metal_4")
	:setDoorState("open")
spawn("eob_sewers_door_metal", 14,18,1, "dungeon_door_metal_5")
spawn("script_entity", 10,8,3, "script_entity_1")
	:setSource("-- scripts for LEVEL 1 --\
\
-- open secret walls at route 1 if 2 is closed\
function openSW1()\
\9if dungeon_secret_door_3:isClosed() and\
\9dungeon_secret_door_4:isClosed() then\
\9\9dungeon_secret_door_1:open()\
\9\9dungeon_secret_door_2:open()\
\9\9dungeon_secret_door_6:open()\
\9\9dungeon_secret_door_7:open()\
\9\9spawn(\"eob_wall_button\", 1, 8, 22, 3, \"wallbutton_route1\")\
\9\9wallbutton_route1:addConnector(\"toggle\",\"dungeon_door_metal_6\",\"toggle\")\
\9end\
end\
\
-- open secret walls at route 2 if 1 is closed\
function openSW2()\
\9if dungeon_secret_door_1:isClosed() and\
\9dungeon_secret_door_2:isClosed() then\
\9\9dungeon_secret_door_3:open()\
\9\9dungeon_secret_door_4:open()\
\9\9dungeon_secret_door_8:open()\
\9\9dungeon_secret_door_9:open()\
\9\9spawn(\"eob_wall_button\", 1, 9, 21, 2, \"wallbutton_route2\")\
\9\9wallbutton_route2:addConnector(\"toggle\",\"dungeon_door_metal_6\",\"toggle\")\
\9end\
end\
\
function MessageSmellsTerrible()\
\9hudPrint(texts.getT(\"smells_terrible_here\"))\
end\
\
function SpecialQuest1()\
\9if counter_1:getValue() == 0 then\
\9\9local itc = libObject.containsItem(dungeon_alcove_1, \"eob_dagger\")\
\9\9if itc then\
\9\9\9counter_1:increment()\
\9\9\9if itc:getStackSize()>1 then\
\9\9\9\9itc:setStackSize(itc:getStackSize()-1)\
\9\9\9else\
\9\9\9\9itc:destroy()\
\9\9\9end\
\9\9\9hudPrint(texts.getT(\"special_quest_for_this_level\"))\
\9\9\9dungeon_alcove_1:addItem(spawn(\"eob_dagger_guinsoo\"))\
\9\9\9secret_1:activate()\
\9\9end\
\9end\
end")
spawn("pressure_plate_hidden", 16,11,0, "pressure_plate_hidden_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_1", "openSW2")
spawn("eob_sewers_door_metal", 8,21,2, "dungeon_door_metal_6")
spawn("eob_sewers_door_metal", 19,19,0, "dungeon_door_metal_7")
spawn("eob_lever", 18,19,0, "eob_lever_2")
	:addConnector("any", "dungeon_door_metal_7", "toggle")
spawn("eob_rock", 20,17,2, "eob_rock_4")
spawn("eob_sewers_door_metal", 22,13,0, "dungeon_door_metal_8")
spawn("eob_sewers_pressure_plate", 22,17,1, "dungeon_pressure_plate_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:addConnector("activate", "dungeon_door_metal_9", "open")
	:addConnector("deactivate", "dungeon_door_metal_9", "close")
spawn("eob_sewers_door_metal", 22,19,0, "dungeon_door_metal_9")
spawn("eob_rock", 21,21,2, "eob_rock_5")
spawn("eob_sewers_door_metal", 22,23,2, "dungeon_door_metal_10")
	:addPullChain()
spawn("eob_arrow", 16,24,1, "eob_arrow_3")
spawn("eob_shield", 10,25,2, "eob_shield_1")
spawn("eob_sewers_pressure_plate", 16,23,3, "dungeon_pressure_plate_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:addConnector("activate", "dungeon_door_metal_4", "close")
spawn("eob_sewers_alcove", 12,25,0, "dungeon_alcove_1")
	:setActivateAlways(true)
	:addItem(spawn("eob_scroll_armor"))
	:addItem(spawn("eob_scroll_bless"))
	:addConnector("activate", "script_entity_1", "SpecialQuest1")
spawn("eob_sewers_secret_button_large", 19,21,3, "eob_sewers_secret_button_4")
	:addConnector("toggle", "eob_sewers_secret_door_cube_1", "toggle")
	:addConnector("toggle", "eob_secret_door_empty_1", "toggle")
	:addConnector("toggle", "eob_secret_door_empty_2", "toggle")
	:addConnector("toggle", "secret_3", "activate")
spawn("eob_remains_of_tod_uphill", 14,14,2, "eob_remains_of_tod_uphill_1")
spawn("secret", 11,25,1, "secret_1")
spawn("secret", 26,20,1, "secret_2")
spawn("eob_dart_2", 25,18,0, "eob_dart_2_1")
spawn("eob_leech", 9,25,0, "eob_leech_1")
spawn("eob_leech", 5,27,0, "eob_leech_2")
spawn("eob_kobold", 11,17,1, "eob_kobold_1")
	:addItem(spawn("eob_dagger"))
spawn("eob_kobold", 12,19,0, "eob_kobold_2")
spawn("eob_kobold", 24,19,1, "eob_kobold_3")
	:addItem(spawn("eob_dagger"))
spawn("eob_kobold", 11,18,1, "eob_kobold_4")
	:addItem(spawn("eob_dagger"))
spawn("eob_kobold", 11,27,3, "eob_kobold_5")
	:addItem(spawn("eob_dagger"))
spawn("eob_kobold", 16,12,3, "eob_kobold_6")
spawn("eob_kobold", 20,8,1, "eob_kobold_7")
	:addItem(spawn("eob_dagger"))
spawn("eob_kobold", 20,15,1, "eob_kobold_8")
	:addItem(spawn("eob_dagger"))
spawn("torch_holder", 15,15,1, "torch_holder_2")
	:addTorch()
spawn("torch_holder", 11,19,2, "torch_holder_3")
	:addTorch()
spawn("torch_holder", 15,24,2, "torch_holder_4")
	:addTorch()
spawn("torch_holder", 6,28,2, "torch_holder_5")
	:addTorch()
spawn("torch_holder", 23,11,1, "torch_holder_6")
	:addTorch()
spawn("counter", 12,24,0, "counter_1")
spawn("eob_wall_button", 23,12,2, "eob_wall_button_1")
	:addConnector("toggle", "dungeon_door_metal_8", "toggle")
spawn("eob_wall_button", 15,19,3, "eob_wall_button_2")
	:addConnector("toggle", "dungeon_door_metal_5", "toggle")
spawn("pressure_plate_hidden", 25,19,0, "pressure_plate_hidden_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_1", "MessageSmellsTerrible")
spawn("script_entity", 11,1,0, "script_beginning")
	:setSource("function EOBsetDefaultParty()\
 -- set default party (not used for now, there is new feature from AH)\
\
\9party:getChampion(1):setName(\"Allabar\")\
\9party:getChampion(1):setRace(\"Human\")\
\9party:getChampion(1):setClass(\"Fighter\")\
\9party:getChampion(1):setSex(\"male\")\
\9party:getChampion(1):setPortrait(\"mod_assets/textures/portraits/eob1-allabar.tga\")\
\9\
\9party:getChampion(2):setName(\"Ariel\")\
\9party:getChampion(2):setRace(\"Human\")\
\9party:getChampion(2):setClass(\"Ranger\")\
\9party:getChampion(2):setSex(\"female\")\
\9party:getChampion(2):setPortrait(\"mod_assets/textures/portraits/eob1-ariel.tga\")\
\9\
\9party:getChampion(3):setName(\"Tenmiyana\")\
\9party:getChampion(3):setRace(\"Lizardman\")\9\
\9party:getChampion(3):setSex(\"female\")\
\9party:getChampion(3):setPortrait(\"mod_assets/textures/portraits/eob1-tenmiyana.tga\")\
\9\
\9party:getChampion(4):setName(\"Valanau\")\
\9party:getChampion(4):setRace(\"Human\")\
\9party:getChampion(4):setSex(\"male\")\
\9party:getChampion(4):setPortrait(\"mod_assets/textures/portraits/eob1-valanau.tga\")\
end\
\
function EOBsetDefaultItems()\
 -- set default items for the party [WIP] --\
\9party:getChampion(1):insertItem(7,spawn(\"eob_short_sword\"))\
\9party:getChampion(1):insertItem(11,spawn(\"eob_note_commission\"))\
\9party:getChampion(1):getItem(11):setScrollText(texts.getT(\"commission_letter\"))\
\9party:getChampion(1):insertItem(12,spawn(\"eob_note_map_level1\"))\
\9party:getChampion(1):getItem(12):setScrollImage(\"mod_assets/textures/gui/scroll_images/sewers_level1_map512.dds\")\
\9party:getChampion(1):insertItem(13,spawn(\"eob_iron_rations\"))\
\9party:getChampion(1):insertItem(14,spawn(\"torch\"))\
\9party:getChampion(2):insertItem(7,spawn(\"hand_axe\"))\
\9party:getChampion(2):insertItem(11,spawn(\"eob_iron_rations\"))\
\9party:getChampion(3):insertItem(11,spawn(\"eob_iron_rations\"))\
\9party:getChampion(3):insertItem(7,spawn(\"compass\"))\
\9party:getChampion(3):insertItem(8,spawn(\"eob_dagger\"))\
\9party:getChampion(4):insertItem(12,spawn(\"eob_iron_rations\"))\
end\
\
\
-- helper function for set the Wall text for Kobold runes\
function setWallTextForRune(wt)\
\9local reader = libParty.getFirstPartyRace(\"Lizardman\")\
\9local txt = findEntity(wt)\
\9if reader then\
\9\9txt:setWallText(party:getChampion(reader):getName()..texts.getT(\"character_can_translate_rune\"))\
\9else\
\9\9txt:setWallText(texts.getT(\"character_cannot_translate_rune\"))\
\9end\
end\
\
function TextRune1()\
\9setWallTextForRune(\"dungeon_wall_text_rune1\")\
end\
\
function TextRune2()\
\9setWallTextForRune(\"dungeon_wall_text_rune2\")\
end\
\
function FallingRocks()\
\9spawn(\"fx\", 1, 10, 14, 2, \"dust1\")\
\9dust1:setParticleSystem(\"earthquake_dust\")\
\9-- spawn(\"fx\", 1, 10, 15, 0, \"dust2\")\
\9-- dust2:setParticleSystem(\"earthquake_dust\")\
\9party:shakeCamera(1,1)\
\9playSoundAt(\"rockfall_01\", 1, 10, 14)\
end\
\
-- EOBsetDefaultParty()\
EOBsetDefaultItems()\
\
playSoundAt(\"waterfall_loop\", 1, 15, 14)\
\
hudPrint(\" \")\
hudPrint(\" \")\
hudPrint(\" \")\
hudPrint(texts.getT(\"welcome_to_eob\"))\
hudPrint(\" \")\
hudPrint(texts.getT(\"entrance_is_blocked\"))")
spawn("pressure_plate_hidden", 18,12,1, "pressure_plate_hidden_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "script_beginning", "TextRune1")
spawn("pressure_plate_hidden", 15,23,1, "pressure_plate_hidden_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "script_beginning", "TextRune2")
spawn("eob_lock_picks", 14,14,3, "eob_lock_picks_1")
spawn("eob_rations", 20,7,3, "eob_rations_2")
spawn("eob_rations", 10,19,2, "eob_rations_3")
spawn("eob_rations", 11,19,2, "eob_rations_4")
spawn("eob_sewers_wall_text_rune1", 18,12,1, "dungeon_wall_text_rune1")
	:setWallText("")
spawn("floor_dirt", 14,16,0, "floor_dirt_1")
spawn("eob_sewers_wall_text_rune1", 15,23,0, "dungeon_wall_text_rune2")
	:setWallText("")
spawn("sewers_fog", 18,15,2, "sewers_fog_2")
spawn("sewers_fog", 22,11,1, "sewers_fog_3")
spawn("sewers_fog", 22,21,2, "sewers_fog_4")
spawn("sewers_fog", 10,23,2, "sewers_fog_5")
spawn("sewers_fog", 6,27,2, "sewers_fog_6")
spawn("sewers_fog", 10,18,0, "sewers_fog_7")
spawn("eob_sewers_secret_door", 17,15,2, "dungeon_secret_door_1")
spawn("eob_sewers_secret_door", 17,17,0, "dungeon_secret_door_2")
spawn("eob_sewers_secret_door", 20,11,1, "dungeon_secret_door_3")
spawn("eob_sewers_secret_door", 22,11,3, "dungeon_secret_door_4")
spawn("eob_sewers_secret_door", 14,24,2, "dungeon_secret_door_6")
spawn("eob_sewers_secret_door", 14,26,0, "dungeon_secret_door_7")
spawn("eob_sewers_secret_door", 14,26,3, "dungeon_secret_door_8")
spawn("eob_sewers_secret_door", 12,26,1, "dungeon_secret_door_9")
spawn("eob_sewers_secret_door", 25,21,0, "dungeon_secret_door_5")
spawn("floor_dirt", 10,17,1, "floor_dirt_4")
spawn("floor_dirt", 10,19,3, "floor_dirt_5")
spawn("floor_dirt", 8,24,3, "floor_dirt_6")
spawn("floor_dirt", 5,28,0, "floor_dirt_7")
spawn("floor_dirt", 14,24,3, "floor_dirt_8")
spawn("floor_dirt", 25,22,2, "floor_dirt_9")
spawn("floor_dirt", 23,20,2, "floor_dirt_10")
spawn("floor_dirt", 21,18,2, "floor_dirt_11")
spawn("floor_dirt", 21,7,3, "floor_dirt_13")
spawn("floor_dirt", 23,12,1, "floor_dirt_14")
spawn("eob_sewers_door_metal", 14,14,0, "eob_sewers_door_metal_1")
spawn("eob_sewers_pressure_plate", 13,18,2, "eob_sewers_pressure_plate_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:addConnector("activate", "dungeon_door_metal_5", "toggle")
spawn("eob_sewers_pressure_plate", 22,14,2, "eob_sewers_pressure_plate_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:addConnector("activate", "dungeon_door_metal_8", "toggle")
spawn("sewers_fog", 25,19,1, "sewers_fog_8")
spawn("dungeon_wall_dirt_1", 25,18,3, "dungeon_wall_dirt_1_2")
spawn("dungeon_wall_dirt_2", 25,18,1, "dungeon_wall_dirt_2_1")
spawn("floor_dirt", 26,19,2, "floor_dirt_12")
spawn("floor_dirt", 24,19,2, "floor_dirt_16")
spawn("eob_sewers_secret_button_large", 25,21,1, "eob_sewers_secret_button_1")
	:addConnector("toggle", "dungeon_secret_door_5", "toggle")
	:addConnector("toggle", "secret_2", "activate")
spawn("floor_dirt", 6,21,2, "floor_dirt_18")
spawn("floor_dirt", 13,21,2, "floor_dirt_19")
spawn("floor_dirt", 20,25,1, "floor_dirt_20")
spawn("floor_dirt", 17,26,1, "floor_dirt_21")
spawn("floor_dirt", 12,26,2, "floor_dirt_22")
spawn("floor_dirt", 19,22,1, "floor_dirt_23")
spawn("floor_dirt", 19,11,0, "floor_dirt_24")
spawn("dungeon_ivy_1", 25,22,1, "dungeon_ivy_1_1")
spawn("dungeon_ivy_1", 24,19,0, "dungeon_ivy_1_2")
spawn("dungeon_ivy_1", 26,19,0, "dungeon_ivy_1_3")
spawn("dungeon_ivy_1", 26,19,1, "dungeon_ivy_1_4")
spawn("dungeon_ivy_1", 25,20,1, "dungeon_ivy_1_5")
spawn("dungeon_ivy_1", 24,19,2, "dungeon_ivy_1_6")
spawn("dungeon_ivy_2", 25,20,3, "dungeon_ivy_2_1")
spawn("dungeon_ivy_2", 25,18,0, "dungeon_ivy_2_2")
spawn("dungeon_ivy_1", 10,15,2, "dungeon_ivy_1_7")
spawn("dungeon_ivy_1", 20,7,0, "dungeon_ivy_1_8")
spawn("dungeon_ivy_2", 23,18,2, "dungeon_ivy_2_3")
spawn("dungeon_ivy_1", 23,20,1, "dungeon_ivy_1_9")
spawn("dungeon_ivy_2", 7,28,1, "dungeon_ivy_2_4")
spawn("dungeon_ivy_1", 7,28,2, "dungeon_ivy_1_10")
spawn("dungeon_ivy_1", 11,21,2, "dungeon_ivy_1_11")
spawn("dungeon_ivy_2", 11,17,0, "dungeon_ivy_2_5")
spawn("eob_wall_button", 16,24,1, "eob_wall_button_3")
	:addConnector("toggle", "dungeon_door_metal_4", "open")
spawn("floor_dirt", 16,14,2, "floor_dirt_25")
spawn("dungeon_ivy_1", 17,18,1, "dungeon_ivy_1_12")
spawn("temple_ceiling_lamp", 25,19,0, "temple_ceiling_lamp_1")
spawn("eob_sewers_ceiling_shaft", 25,19,0, "eob_sewers_ceiling_shaft_1")
spawn("script_entity", 13,1,1, "libParty")
	:setSource("-- Library of helper functions for the party entity --\
\
-- returns first Champion of race = race(string) in the party (order_id), otherwise returns nil\
function getFirstPartyRace(race)\
\9for p=1,4 do\
\9\9if party:getChampion(p):getRace() == race then\
\9\9\9return p\
\9\9end\
\9end\
\9return nil\
end\
\
-- returns strength of whole party (number) --\
function getPartyStrength()\
\9local s = 0\
\9for p=1,4 do\
\9\9if party:getChampion(p):getEnabled() and party:getChampion(p):isAlive() then\
\9\9\9s = s + party:getChampion(p):getStat(\"strength\")\
\9\9end\
\9end\
\9return s\
end\
\
-- returns the strongest member of the party (order_id) --\
function getStrongestMember()\
\9local m = 0\
\9for p=1,4 do\
\9\9if party:getChampion(p):getEnabled() and party:getChampion(p):isAlive() then\
\9\9\9if m == 0 then\
\9\9\9\9m = p\
\9\9\9else\
\9\9\9\9if party:getChampion(p):getStat(\"strength\") > party:getChampion(m):getStat(\"strength\") then\
\9\9\9\9\9m = p\
\9\9\9\9end\
\9\9\9end\
\9\9end\
\9end\
\9return m\
end\
")
spawn("teleporter", 2,16,3, "teleporter_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(19,23,3,2)
spawn("eob_sewers_wall_text_long", 3,16,1, "eob_sewers_wall_text_long_3")
	:setWallText("Teleport to Level 2")
spawn("eob_sewers_wall_text_long", 3,15,3, "eob_sewers_wall_text_long_5")
	:setWallText("This room is for the Testing only, you can teleport to lower levels.")
spawn("dungeon_ivy_1", 13,16,3, "dungeon_ivy_1_14")
spawn("dungeon_ceiling_root_2", 13,16,2, "dungeon_ceiling_root_2_1")
spawn("dungeon_ceiling_root_3", 14,16,2, "dungeon_ceiling_root_3_1")
spawn("script_entity", 1,11,3, "illusion_pits")
	:setSource("function activate(pit)\
\9for e in entitiesAt(pit.level,pit.x ,pit.y) do\
\9\9if e.name == 'eob_sewers_pit_illusion_off' then\
\9\9\9e:destroy()\
\9\9end\
\9end\
\9spawn(\"eob_sewers_pit_illusion_on\", pit.level, pit.x, pit.y, 0)\
\9fw.debugPrint(\"Illusionary pit and Teleporter at \"..pit.x..\",\"..pit.y..\" deactivated\")\
end\
\
function deactivate(pit)\
\9for e in entitiesAt(pit.level,pit.x ,pit.y) do\
\9\9if e.name == 'eob_sewers_pit_illusion_on' then\
\9\9\9e:destroy()\
\9\9end\
\9end\
\9spawn(\"eob_sewers_pit_illusion_off\", pit.level, pit.x, pit.y, 0)\
\9fw.debugPrint(\"Illusionary pit and Teleporter at \"..pit.x..\",\"..pit.y..\" activated\")\
end\
\
function toggle(pit)\
\9for e in entitiesAt(pit.level,pit.x ,pit.y) do\
\9\9if e.name == 'teleporter' then\
\9\9\9if e:isActivated() then\
\9\9\9\9e:deactivate()\
\9\9\9\9self.deactivate(pit)\
\9\9\9else\
\9\9\9\9e:activate()\
\9\9\9\9self.activate(pit)\
\9\9\9end\
\9\9end\
\9end\
end\
\
function damageToPartyActivate()\
\9fw.addHooks('party','teleporter_pits', {\
\9\9onMove = function(self,dir)\
\9\9\9local p = false\
\9\9\9local t = false\
\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9if e.name == 'eob_sewers_pit_illusion_on' then\
\9\9\9\9\9p = true\
\9\9\9\9end\
\9\9\9\9if e.name == 'teleporter' then\
\9\9\9\9\9t = e\
\9\9\9\9end\
\9\9\9end\
\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9if e.name == 'eob_sewers_pit_illusion_on' then\
\9\9\9\9\9p = true\
\9\9\9\9end\
\9\9\9\9if e.name == 'teleporter' then\
\9\9\9\9\9t = e\
\9\9\9\9end\
\9\9\9end\
\9\9\9if p and t then\
\9\9\9\9local timer = findEntity(\"teleporter_pits_timer\")\
\9\9\9\9if (not timer) then\
\9\9\9\9\9timer = spawn(\"timer\", t.level, t.x, t.y, t.facing, \"teleporter_pits_timer\")\
\9\9\9\9\9timer:setTimerInterval(0.4)\
\9\9\9\9\9timer:addConnector('activate','illusion_pits','doDamageToParty')\
\9\9\9\9end\
\9\9\9\9timer:activate()\
\9\9\9\9playSound(\"party_fall\")\
\9\9\9end\
\9\9end\
\9})\
\9fw.debugPrint(\"Party damage from illusionary pits activated\")\
end\
\
function doDamageToParty()\
\9power = 30\
\9damageTile(party.level, party.x, party.y, 0, 0, \"physical\", power)\
\9playSound(\"party_land\")\
\9party:shakeCamera(0.3,0.3)\
\9fw.debugPrint(\"Party gets damage from illusionary pits by power = \"..power)\
\9-- timer = findEntity(\"teleporter_pits_timer\")\
\9-- timer:deactivate()\
\9teleporter_pits_timer:deactivate()\
end\
")
spawn("script_entity", 1,12,0, "throwable_portcullis")
	:setSource("activeThrowableDoor = {}\
\
function activate()\
\
\9fw.addHooks('party','throwable_portcullis', {\
\9\9onMove = function(self,dir)\
\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9if ( (e.name == 'door_throwable' or e.name == 'door_throwable_force') and \
\9\9\9\9\9e.facing == (dir + 2)%4) then\
\9\9\9\9\9throwable_portcullis.doTheMagic(e)\
\9\9\9\9end\
\9\9\9end\
\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9if ( (e.name == 'door_throwable' or e.name == 'door_throwable_force') and \
\9\9\9\9\9e.facing == dir) then\
\9\9\9\9\9throwable_portcullis.doTheMagic(e)\
\9\9\9\9end\
\9\9\9end\
\9\9end\
\9})\
\
\9local timer = spawn(\"timer\", 1, 1, 1, 0, \"throwable_door_timer\")\
\9timer:setTimerInterval(0.1)\
\9timer:addConnector('activate','throwable_portcullis','deactivate')\
\9\9\
\9fw.debugPrint(\"Throwable portcullis activated\")\
end\
\
function doTheMagic(script)\
\9if script.getState() == \"closed\" then\
\9for e in help.entitiesAtSameTile(script) do\
\9\9if ( (e.name == 'eob_sewers_door_portcullis') and\
\9\9\9e.facing == script.facing) then\
\9\9\9e:setDoorState('closed')\
\9\9\9-- if not findEntity(\"blocker_\"..e.id) then\
\9\9\9--\9spawn(\"blocker\", e.level, e.x, e.y, e.facing, \"blocker_\"..e.id)\
\9\9\9-- end\
\9\9\9local timer = findEntity(\"throwable_door_timer\")\
\9\9\9timer:activate()\
\9\9\9throwable_portcullis.activeThrowableDoor[script.id] = e.id\
\9\9end\
\9end\9\
\9end\
end\
\
function deactivate()\
\9for id,eid in pairs(throwable_portcullis.activeThrowableDoor) do\
\9\9local door = findEntity(eid)\
\9\9door:setDoorState('open')\
\9\9throwable_portcullis.activeThrowableDoor[id] = nil\
\9\9for e in help.entitiesAtSameTile(door) do\
\9\9\9if ( e.name == 'door_throwable_force' ) then\
\9\9\9\9if (forceable_doors.isForced()) then\
\9\9\9\9\9self.open(e)\
\9\9\9\9end\
\9\9\9end\
\9\9end\
\9end\
\9local timer = findEntity(\"throwable_door_timer\")\
\9timer:deactivate()\
end\
\
function open(script)\
\9if script.getState() == \"closed\" then\
\9\9script.setState(\"open\")\
\9\9local fake = findEntity(\"fake_portcullis_\"..script.id)\
\9\9local door = findEntity(\"portcullis_\"..script.id)\
\9\9local block = findEntity(\"blocker_\"..script.id)\
\9\9fake:destroy()\
\9\9block:destroy()\
\9\9door:setDoorState(\"closed\")\
\9\9door:open()\
\9end\
end\
\
function close(script)\
\9if script.getState() == \"open\" then\
\9\9script.setState(\"closed\")\
\9\9local door = findEntity(\"portcullis_\"..script.id)\
\9\9spawn(\"blocker\", script.level, script.x, script.y, script.facing, \"blocker_\"..script.id)\
\9\9door:setDoorState(\"open\")\
\9\9door:close()\
\9\9local timer = findEntity(\"timer_\"..script.id)\
\9\9timer:activate()\
\9end\
end\
\
function spawnFakePortcullis(script)\
\9spawn(\"eob_portcullis_throwable\", script.level, script.x, script.y, script.facing, \"fake_portcullis_\"..script.id)\
\9local door = findEntity(\"portcullis_\"..script.id)\
\9local timer = findEntity(\"timer_\"..script.id)\
\9timer:deactivate()\
\9door:setDoorState(\"open\")\
end")
spawn("script_entity", 1,13,2, "ladders_updown")
	:setSource("\
function activate()\
\9fw.addHooks('party','ladders_updown', {\
\9\9onMove = function(self,dir)\
\9\9\9local ldn = false\
\9\9\9local lup = false\
\9\9\9local t = false\
\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9if e.name == 'eob_ladder_down' then\
\9\9\9\9\9ldn = true\
\9\9\9\9end\
\9\9\9\9if e.name == 'eob_ladder_up' then\
\9\9\9\9\9lup = true\
\9\9\9\9end\
\9\9\9\9if e.name == 'teleporter' then\
\9\9\9\9\9t = e\
\9\9\9\9end\
\9\9\9end\9\9\
\9\9\9if ldn and t then\
\9\9\9\9playSound(\"ladder_steps2\")\
\9\9\9\9hudPrint(\"Going down...\")\
\9\9\9end\
\9\9\9if lup and t then\
\9\9\9\9playSound(\"ladder_steps2\")\
\9\9\9\9hudPrint(\"Going up...\")\
\9\9\9end\
\9\9end\
\9})\
\9fw.debugPrint(\"Party ladders activated\")\
end")
spawn("eob_sewers_wall_drainage", 14,14,1, "eob_sewers_wall_drainage_2")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 16,14,3, "eob_sewers_wall_drainage_3")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 17,17,1, "eob_sewers_wall_drainage_4")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 19,17,3, "eob_sewers_wall_drainage_5")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 25,21,3, "eob_sewers_wall_drainage_6")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 23,21,1, "eob_sewers_wall_drainage_7")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 13,21,2, "eob_sewers_wall_drainage_8")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 13,21,0, "eob_sewers_wall_drainage_9")
	:setWallText("")
spawn("script_entity", 21,0,2, "logfw_init")
	:setSource("spawn(\"LoGFramework\", 1,1,1,0,'fwInit')\
fwInit:open()\
\
function main()\
\9fw.debug.enabled = false\
\9fwInit:close() --must be called\
end\
\
\
\
\
")
spawn("timer", 0,8,0, "timer_script_activation")
	:setTimerInterval(0.6)
	:activate()
	:addConnector("activate", "script_start", "activate")
	:addConnector("activate", "timer_script_activation_off", "deactivate")
spawn("script_entity", 1,9,0, "timer_script_activation_off")
	:setSource("function deactivate()\
\9timer_script_activation:deactivate()\
end")
spawn("script_entity", 1,8,2, "script_start")
	:setSource("-- Start scripts on timer --\
\
function activate()\
\9\
\9if (not fw.debug.enabled) then script_beginning.FallingRocks() end\
\9illusion_pits.damageToPartyActivate()\
\9throwable_portcullis.activate()\
\9ladders_updown.activate()\
\9forceable_doors.activate()\
\9party_rotators.activate()\
\9\
\9-- Wently's Notes --\
\9spawn(\"WentlysNoteSpawner\", 1,1,1,0,'wnInit')\
\9wnInit:open()\
\9wnInit:destroy()\
\9wentlys_notes.activate()\
end")
spawn("script_entity", 17,1,1, "scriptEffects")
	:setSource("-- script for timed effects [WIP, testing...] --\
-- \
--  \"strBoost\": increasing strength \
-- \
\
ActiveEffect = {}\
\
function activateEffect(effect, champion, amount, duration)\
\9if self.ActiveEffect[effect..\"_\"..champion] then\
\9\9return false\
\9end\
\9fw.debugPrint(\"Effect \"..effect..\" is activated: Champion=\"..champion..\", Amount=\"..amount..\", Duration=\"..duration..\"s\")\
\9self.ActiveEffect[effect..\"_\"..champion] = { amount=amount, duration=duration }\
\9local timer = findEntity(\"timer_effect_\"..effect..\"_\"..champion)\
\9timer:setTimerInterval(duration)\
\9timer:activate()\
\9return true\
end\
\
function stopEffect_strBoost(id)\
\9local champion = party:getChampion(id)\
\9champion:setStatMax(\"strength\", champion:getStatMax(\"strength\") - self.ActiveEffect[\"strBoost_\"..id].amount)\
\9self.ActiveEffect[\"strBoost_\"..id] = nil\
\9local timer = findEntity(\"timer_effect_strBoost_\"..id)\
\9timer:deactivate()\
\9playSound(\"generic_spell\")\
\9fw.debugPrint(\"strBoost deactivated for champion=\"..id)\
\9fw.debugPrint(\"Actual Stat=\"..champion:getStat(\"strength\")..\", StatMax=\"..champion:getStatMax(\"strength\"))\
\9hudPrint(champion:getName()..\" feels less stronger!\")\
end\
function stopEffect_strBoost_1()\
\9self.stopEffect_strBoost(1)\
end\
function stopEffect_strBoost_2()\
\9self.stopEffect_strBoost(2)\
end\
function stopEffect_strBoost_3()\
\9self.stopEffect_strBoost(3)\
end\
function stopEffect_strBoost_4()\
\9self.stopEffect_strBoost(4)\
end\
\
spawn(\"timer\",1,1,1,0, \"timer_effect_strBoost_1\")\
timer_effect_strBoost_1:addConnector(\"activate\",\"scriptEffects\",\"stopEffect_strBoost_1\")\
spawn(\"timer\",1,1,1,0, \"timer_effect_strBoost_2\")\
timer_effect_strBoost_2:addConnector(\"activate\",\"scriptEffects\",\"stopEffect_strBoost_2\")\
spawn(\"timer\",1,1,1,0, \"timer_effect_strBoost_3\")\
timer_effect_strBoost_3:addConnector(\"activate\",\"scriptEffects\",\"stopEffect_strBoost_3\")\
spawn(\"timer\",1,1,1,0, \"timer_effect_strBoost_4\")\
timer_effect_strBoost_4:addConnector(\"activate\",\"scriptEffects\",\"stopEffect_strBoost_4\")\
")
spawn("floor_corpse", 25,19,1, "floor_corpse_2")
spawn("secret", 18,21,2, "secret_3")
spawn("script_entity", 1,14,2, "forceable_doors")
	:setSource("forceable_doors_to_close = {}\
\
function activate()\
\9fw.addHooks('party','force_door', {\
\9\9onMove = function(self,dir)\
\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9if ((e.name == 'eob_sewers_door_metal_force') and e.facing == (dir + 2)%4) then\
\9\9\9\9\9forceable_doors.force(e)\
\9\9\9\9end\
\9\9\9end\
\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9if ((e.name == 'eob_sewers_door_metal_force') and e.facing == dir) then\
\9\9\9\9\9forceable_doors.force(e)\
\9\9\9\9end\
\9\9\9end\
\9\9end\
\9})\
\9fw.debugPrint(\"Forceable / Stucked doors activated\")\
end\
\
function isForced()\
\9local member = party:getChampion(libParty.getStrongestMember())\
\9local partystr = member:getStat(\"strength\")\
\9local doorstr = math.random(1,25)\
\9fw.debugPrint(\"ForceDoor: partyStr=\"..partystr..\", doorStr=\"..doorstr)\
\9if (partystr>doorstr) then\
\9\9hudPrint(member:getName()..texts.getT(\"door_member_try_open_ok\"))\
\9\9return true\
\9else\
\9\9hudPrint(member:getName()..texts.getT(\"door_member_try_open_failed\"))\
\9\9hudPrint(texts.getT(\"door_party_try_open_again\"))\
\9\9return false\
\9end\
end\
\
function force(door)\
\9if door:isClosed() then\
\9\9if (self.isForced()) then\
\9\9\9door:open()\
\9\9else\
\9\9\9door:open()\
\9\9\9local timer = findEntity(\"force_open_door_timer\")\
\9\9\9if (not timer) then\
\9\9\9\9timer = spawn(\"timer\", self.level, self.x, self.y, self.facing, \"force_open_door_timer\")\
\9\9\9\9timer:setTimerInterval(0.4)\
\9\9\9\9timer:addConnector(\"activate\",\"forceable_doors\",\"close\")\
\9\9\9end\
\9\9\9forceable_doors.forceable_doors_to_close[door.id] = door\
\9\9\9timer:activate()\
\9\9end\
\9end\
end\
\
function close()\
\9force_open_door_timer:deactivate()\
\9for id,door in pairs(forceable_doors.forceable_doors_to_close) do\
\9\9door:close()\
\9\9forceable_doors.forceable_doors_to_close[id] = nil\
\9end\
end")
spawn("eob_sewers_cave_in_ceiling", 10,14,0, "eob_sewers_cave_in_ceiling_2")
spawn("eob_sewers_cave_in_ceiling", 10,13,0, "eob_sewers_cave_in_ceiling_3")
spawn("script_entity", 1,15,2, "party_rotators")
	:setSource("function activate()\
\
fw.addHooks('party','party_rotator', {\
\9onMove = function(self,dir)\
\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9if e.name == 'teleporter_rotator90' then\
\9\9\9\9e:setTeleportTarget(e.x, e.y, (self.facing + 1)%4)\
\9\9\9\9fw.debugPrint(\"Party rotated by 90\")\
\9\9\9end\
\9\9\9if e.name == 'teleporter_rotator180' then\
\9\9\9\9e:setTeleportTarget(e.x, e.y, (self.facing + 2)%4)\
\9\9\9\9fw.debugPrint(\"Party rotated by 180\")\
\9\9\9end\
\9\9\9if e.name == 'teleporter_rotator270' then\9\9\9\9\9\
\9\9\9\9e:setTeleportTarget(e.x, e.y, (self.facing + 3)%4)\
\9\9\9\9fw.debugPrint(\"Party rotated by 270\")\
\9\9\9end\
\9\9end\
\9end\
})\
fw.debugPrint(\"Teleporter rotators activated\")\
\
end")
spawn("script_entity", 1,16,3, "wentlys_notes")
	:setSource("function activate()\
\
wentlys_note_found = {}\
\
fw.addHooks('party','wentlys_notes', {\
\9onPickUpItem = function(self,item)\
\9\9if item.name == 'wentlys_note' then\
\9\9\9local isfound = false\9\
\9\9\9for id,note in pairs(wentlys_notes.wentlys_note_found) do\
\9\9\9\9if item.id == note then\
\9\9\9\9\9isfound = true\
\9\9\9\9end\
\9\9\9end\
\9\9\9if (not isfound) then\
\9\9\9\9-- wentlys_notes.wentlys_note_found[item.id] = item.id\
\9\9\9\9local n = #wentlys_notes.wentlys_note_found\
\9\9\9\9wentlys_notes.wentlys_note_found[n+1] = item.id\
\9\9\9\9hudPrint(\"New Wently's note found! (\"..#wentlys_notes.wentlys_note_found..\"/\"..wentlys_note_total:getValue()..\")\")\
\9\9\9\9playSound(\"discover_spell\")\
\9\9\9end\
\9\9end\
\9end\
})\
fw.debugPrint(\"Wently's Note counter activated\")\
\
end")
spawn("eob_scroll_detect_magic", 11,18,1, "eob_scroll_detect_magic_1")
spawn("blocker", 8,18,2, "blocker_5")
spawn("blocker", 6,21,3, "blocker_6")
spawn("blocker", 11,26,2, "blocker_8")
spawn("eob_leech", 6,25,0, "eob_leech_3")
spawn("eob_ladder_down", 18,23,1, "eob_ladder_down_2")
spawn("teleporter", 18,23,3, "teleporter_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(19,23,3,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_sewers_pit_fake", 18,23,3, "eob_sewers_pit_fake_2")
spawn("blocker", 22,9,3, "blocker_9")
spawn("script_entity", 15,1,2, "libObject")
	:setSource("-- Library of helper functions for the objects --\
\
-- returns Item if alcove contains the given item (by name)\
function containsItem(alcove, item_name)\
    if alcove:getItemCount() == 0 then\
\9\9return false\
\9end\
\9for it in alcove:containedItems() do\
      \9if it.name == item_name then\
         \9return it\
      \9end\
   \9end\
   \9return false\
end")
spawn("eob_sewers_wall_pipe", 20,11,2, "eob_sewers_wall_pipe_1")
	:setWallText("This slimy, smelly drain pipe reveals nothing.")
spawn("eob_sewers_wall_pipe", 20,13,0, "eob_sewers_wall_pipe_2")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 20,23,2, "eob_sewers_wall_pipe_3")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 20,25,0, "eob_sewers_wall_pipe_4")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 6,24,1, "eob_sewers_wall_pipe_5")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 8,24,3, "eob_sewers_wall_pipe_6")
	:setWallText("")
spawn("script_entity", 23,0,2, "add_spells")
	:setSource("settings = {}\
\
function activate()\
\9fw_magic.enableSpellBook()\
\9defineSpells()\
\9\
\9for i,champ in ipairs(help.getChampions()) do\
\9\9if champ:getClass() == 'Mage' then\
\9\9\9initChampion(champ)\
\9\9end\
\9end\
\
\
\9\
\9fw.setHook('items_spell_book.fw_magic.onLearnSpell',add_spells.onLearnSpell)\
end\
\
function defineSpells()\
\
\
\9fw_magic.defineSpell{\
\9\9name='magic_missile',\
\9\9level=1,\
\9\9book_page=1,\
\9\9skill='spellcraft',\
\9\9projectile='spell_projectile',\
\9\9sound='fireball_launch',\
\9\9onHitSound='fireball_hit',\
\9\9particleEffect='magic_missile',\
\9\9onHitParticleEffect='magic_missile_hit',\
\9\9speed=12,\
\9\9damageType = 'physical',\
\9\9calculateDamage=function(caster)\
\9\9\9local damage = 5\
\9\9\9local modifier = 2\
\9\9\9if caster.getOrdinal then\
\9\9\9\9modifier = math.ceil(caster:getLevel()/2)\
\9\9\9\9damage = math.random(modifier*2,damage * modifier)\9\
\9\9\9end\9\
\9\9\9return damage\
\9\9end\
\9}\
\9\
\9fw_magic.defineSpell{\
\9\9name='fireball',\
\9\9level=3,\
\9\9book_page=3,\
\9\9projectile='spell_projectile',\
\9\9sound='fireball_launch',\
\9\9onHitSound='fireball_hit',\
\9\9particleEffect='fireball',\
\9\9onHitParticleEffect='fireball_hit',\
\9\9speed=14,\
\9\9damageType = 'fire',\
\9\9calculateDamage=function(caster)\
\9\9\9local damage = 6\
\9\9\9if caster.getOrdinal then\
\9\9\9\9damage = math.random(caster:getLevel()*2,damage * caster:getLevel())\
\9\9\9end\
\9\9\9return damage\
\9\9end\
\9}\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='flame_arrow',\
\9\9level=3,\
\9\9book_page=3,\
\9\9projectile='arrow',\
\9\9sound='frostbolt_launch',\
\9\9onHitSound='fireball_hit',\
\9\9particleEffect='fireball',\
\9\9onHitParticleEffect='fireball_hit',\
\9\9speed=14,\
\9\9damageType = 'fire',\
\9\9calculateDamage=function(caster)\
\9\9\9local modifier = 1\9\9\9\
\9\9\9local damage = 3\9\
\9\9\9if caster.getOrdinal then\
\9\9\9\9originator = 2 ^ (caster:getOrdinal()+1) \
\9\9\9\9if caster:getLevel() > 9 then modifier = 2 end\
\9\9\9end\
\9\9\9damage = math.random(damage * modifier,damage * 10 * modifier)\
\9\9\9return damage\
\9\9end\
\9}\9\9\
\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='melfs_acid_arrow',\
\9\9level=3,\
\9\9book_page=3,\
\9\9projectile='spell_projectile',\
\9\9sound='poison_bolt_launch',\
\9\9onHitSound='poison_bolt_hit',\
\9\9particleEffect='poison_bolt',\
\9\9onHitParticleEffect='hit_slime',\
\9\9speed=14,\
\9\9onHit = add_spells.melfs_acid_arrow_onHit\
\9}\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='lightning_bolt',\
\9\9level=3,\
\9\9book_page=3,\
\9\9projectile='spell_projectile',\
\9\9sound='lightning_bolt_launch',\
\9\9onHitSound='lightning_bolt_hit',\
\9\9particleEffect='lightning_bolt',\
\9\9onHitParticleEffect='lightning_bolt_hit',\
\9\9speed=14,\
\9\9area = {from={0,0},to={1,0}},\
\9\9damageType = 'shock',\
\9\9calculateDamage=function(caster)\
\9\9\9local damage = 6\
\9\9\9if caster.getOrdinal then\
\9\9\9\9damage = math.random(caster:getLevel(),caster:getLevel()*damage)\9\
\9\9\9end\9\
\9\9\9return damage\
\9\9end\9\9\
\9}\9\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='cone_of_cold',\
\9\9level=5,\
\9\9book_page=3,\
\9\9sound='frostbolt_launch',\
\9\9onHitSound='frostbolt_hit',\
\9\9particleEffect='frostbolt',\
\9\9onHitParticleEffect='frostbolt_hit',\
\9\9speed=14,\
\9\9area = {from={0,0},to={2,0}},\
\9\9damageType = 'cold',\
\9\9calculateDamage=function(caster)\
\9\9\9local damage = 5\
\9\9\9if caster.getOrdinal then\
\9\9\9\9damage = math.random(caster:getLevel()*2,caster:getLevel()*damage)\9\
\9\9\9end\9\
\9\9\9return damage\
\9\9end,\9\9\
\9\9onCast = function(caster)\
\9\9\9local entity = caster\
\9\9\9if caster.getOrdinal then\
\9\9\9\9entity = party\
\9\9\9end\
\9\9\9local x,y = help.getCoordsOfTileAtDir(entity,entity.facing,1)\
\9\9\9fw_magic.dealSpellDamage('cone_of_cold',caster,x,y)\
\9\9end\
\9}\9\9\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='ice_storm',\
\9\9level=4,\
\9\9book_page=4,\
\9\9sound='frostbolt_launch',\
\9\9onHitSound='frostbolt_hit',\
\9\9particleEffect='ice_shards',\
\9\9onHitParticleEffect='ice_shards',\
\9\9speed=14,\
\9\9area = {from={-1,-1},to={1,1}},\
\9\9damageType = 'cold',\
\9\9calculateDamage=function(caster)\
\9\9\9return math.random(3,30)\
\9\9end,\9\9\
\9\9onCast = function(caster)\
\9\9\9local range = 4 \
\9\9\9local entity = caster\
\9\9\9if caster.getOrdinal then\
\9\9\9\9entity = party\
\9\9\9\9range = caster:getLevel()\
\9\9\9end\
\9\9\9if range < 4 then range = 4 end\
\9\9\9\
\9\9\9local target = help.nextEntityAheadOf(entity, range,'monster',true)\9\
\9\9\9local x,y = 0,0\9\
\9\9\9if target then\
\9\9\9\9x = target.x\
\9\9\9\9y = target.y\
\9\9\9else\
\9\9\9\9x,y = help.getCoordsOfTileAtDir(entity,entity.facing,range)\
\9\9\9end\
\9\9\9-- cross shaped damage area hack --\
\9\9\9fw_magic.spells['ice_storm'].area = {from={-1,0},to={1,0}}\
\9\9\9fw_magic.dealSpellDamage('ice_storm',caster,x,y)\
\9\9\9fw_magic.spells['ice_storm'].area = {from={0,1},to={0,1}}\
\9\9\9fw_magic.dealSpellDamage('ice_storm',caster,x,y)\
\9\9\9fw_magic.spells['ice_storm'].area = {from={0,-1},to={0,-1}}\
\9\9\9fw_magic.dealSpellDamage('ice_storm',caster,x,y)\
\9\9end\
\9}\9\
\9\9\
\9fw_magic.defineSpell{\
\9\9name='shield',\
\9\9level=1,\
\9\9book_page=1,\
\9\9onCast = add_spells.shield\
\9}\9\9\
\9\
\9fw_magic.defineSpell{\
\9\9name='armor',\
\9\9level=1,\
\9\9book_page=1,\
\9\9onCast = add_spells.armor\
\9}\9\
\9\9\
\9fw_magic.defineSpell{\
\9\9name='haste',\
\9\9level=3,\
\9\9book_page=3,\
\9\9onCast = add_spells.haste\
\9}\9\
\
\9fw_magic.defineSpell{\
\9\9name='invisibility',\
\9\9level=2,\
\9\9book_page=2,\
\9\9onCast = add_spells.invisibility\
\9}\9\9\
\9fw_magic.defineSpell{\
\9\9name='invisibility_10_radius',\
\9\9level=3,\
\9\9book_page=3,\
\9\9onCast = add_spells.invisibility_10_radius\
\9}\9\
\
\9fw_magic.defineSpell{\
\9\9name='hold_monster',\
\9\9level=5,\
\9\9book_page=5,\
\9\9onCast = add_spells.hold_monster\
\9}\9\9\9\9\
\
\9\
\9fw_magic.defineSpell{\
\9\9name='burning_hands',\
\9\9level=1,\
\9\9book_page=1,\
\9\9onCast = function(caster, x, y, direction, skill)\
\9\9\9local dx,dy = getForward(direction)\
\9\9\9playSoundAt(\"fireburst\",party.level,x,y)\
\9\9\9local originator = 2 ^ (caster:getOrdinal()+1) \
\9\9\9local skill = caster:getLevel()\
\9\9\9damageTile(party.level, x+dx, y+dy, direction, originator, 'fire', 3+skill*2)\
\9\9end\
\9}\9\
\
\9fw_magic.defineSpell{\
\9\9name='stoneskin',\
\9\9level=4,\
\9\9book_page=4,\
\9\9onCast = add_spells.stoneskin\
\9}\9\9\9\9\9\9\
\
end\
\
-- SPELLS ++\
\
melfs_acid_arrow_onHit = function(projectile,target,damage,damageType)\
\9\9\9if target.getOrdinal then\
\9\9\9\9target = party\
\9\9\9end\
\9\9\9local caster = fw.getById(data.get(projectile,'caster_id')) \
\9\9\
\9\9\9local callback = function(caster_id,target_id)\
\9\9\9\9\9local target = fw.getById(target_id) \
\9\9\9\9\9local caster = fw.getById(caster_id) \
\9\9\9\9\9local originator = 0 \
\9\9\9\9\9local modifier = 1\
\9\9\9\9\9local damage = math.random(2,6)\9\
\9\9\9\9\9\
\9\9\9\9\9if caster.getOrdinal then\
\9\9\9\9\9\9originator = 2 ^ (caster:getOrdinal()+1) \
\9\9\9\9\9\9modifier = math.ceil(caster:getLevel()/2)\
\9\9\9\9\9end\
\9\9\9\9\9\9\9\
\9\9\9\9\9damageTile(target.level,target.x,target.y,(target.facing + 2)%4,originator+1, 'physical',damage)\
\9\9\9\9\9local fx = spawn('fx',target.level,target.x,target.y,target.facing)\
\9\9\9\9\9fx:setParticleSystem('hit_slime')\
\9\9\9\9\9fx:translate(0,1,0)\9\9\
\9\9\9end\
\9\9\9local casterLevel = 4\
\9\9\9if caster.getLevel then\
\9\9\9\9casterLevel = caster:getLevel()\
\9\9\9end\
\9\9\9local attacks = math.ceil(casterLevel/3)\9\
\9\9\9fw.repeatFunction(attacks,1,{fw.getId(caster),fw.getId(target)},callback,true)\9\9\9\
\9\9\9return false\
end\
\
-- SHIELD --\
\
settings.shield = {}\
settings.shield.level = 1\
settings.shield.duration = 5 --seconds + (skill/2)\
settings.shield.missiles = 6 -- how many damagepoints are subtracted (max value)\
settings.shield.throwing = 8 -- how many damagepoints are subtracted (max value)\
\
function shield(caster, x, y, direction, skill)\
\9skill = 1\
\9if (caster.getLevel) then\
\9 \9skill = caster:getLevel() \
\9end\
\9\
\9local timerId = fw_magic.createSpellTimer(caster,settings.shield.duration+skill/2,{'add_spells','shieldDestructor'})\
\9playSoundAt(\"fireball_launch\",party.level,x,y)\
\9\
\9fw.addHooks(fw.getId(caster),timerId,{\
\9\9onProjectileHit = function(champion,projectile,damage,damageType)\
\9\9\9if projectile.name == 'magic_missile'  then\
\9\9\9\9hudPrint('Magic missile deflected')\
\9\9\9\9return false\
\9\9\9end\
\9\9\9if help.isEntityType(projectile,'item_missileweapon') then\
\9\9\9\9champion:damage(damage - math.random(add_spells.settings.shield.missiles), damageType)\
\9\9\9\9hudPrint('Shield spell deflected some damage')\
\9\9\9\9champion:playDamageSound()\
\9\9\9\9return false\
\9\9\9end\
\9\9\9if help.isEntityType(projectile,'item_throwingweapon') then\
\9\9\9\9champion:damage(damage - math.random(add_spells.settings.shield.throwing), damageType)\
\9\9\9\9hudPrint('Shield spell deflected some damage')\
\9\9\9\9champion:playDamageSound()\
\9\9\9\9return false\
\9\9\9end\9\9\9\
\9\9\
\9\9end\
\9}\
\9)\
end\
\
function shieldDestructor(timer)\
\9fw_magic.spellTimerDestructor(timer)\
\9hudPrint('The effect of the shield spell has worn out.')\
end\
\
-- STONESKIN--\
\
\
function stoneskin(caster, x, y, direction, skill)\
\9local selector = fw_magic.createTargetSelector()\
\9selector.skill = caster:getLevel()\
\9selector.onSelectChampion = add_spells.castStoneskin\
end\
\
function castStoneskin(target,skill)\9\
\9\
\9skill = math.random(1,4) + math.floor(skill/2)\
\9playSoundAt(\"generic_spell\",party.level,party.x,party.y)\
\
\9data.set(target,'add_spells_stoneskin_count',skill)\
\9target:setCondition('fire_shield',10000)\
\9fw.addHooks(fw.getId(target),'add_spells_stoneskin',{\
\9\9onProjectileHit = function(champion,projectile,damage,damageType)\
\9\9\9return add_spells.stoneskinCheck(champion,damageType,projectile)\
\9\9end,\
\9\9onDamage = function(champion,damage,damageType)\
\9\9\9return add_spells.stoneskinCheck(champion,damageType)\
\9\9end\9\9\
\9}\
\9)\
end\
\
function stoneskinCheck(champion,damageType,projectile)\
\9if projectile and projectile.name == 'spell_projectile' then\
\9\9return\
\9end\9\
\
\9if damageType == 'physical' then \
\9\9local count = data.get(champion,'add_spells_stoneskin_count')\
\9\9count = count - 1\
\9\9data.set(champion,'add_spells_stoneskin_count',count)\
\9\9hudPrint('('..champion:getName()..') Stoneskin spell prevented the attack.')\
\9\9\
\9\9if count < 1 then\
\9\9\9fw.removeHooks(fw.getId(champion),'add_spells_stoneskin')\
\9\9\9champion:setCondition('fire_shield',0)\
\9\9\9hudPrint('('..champion:getName()..') Stoneskin spell has worn out.')\
\9\9\9data.unset(champion,'add_spells_stoneskin_count')\
\9\9end\9\
\9\9\
\9\9return false \
\9end\
end\
\
-- HOLD MONSTER --\
\
settings.hold_monster = {}\
settings.hold_monster.level = 5\
settings.hold_monster.duration = 9 --seconds + (skill/2)\9\
settings.hold_monster.immune= {\
\9skeleton_archer=true,\
\9skeleton_warrior=true\
}\
\
\
function hold_monster(caster, x, y, direction, skill)\
\
\9skill = 1\
\9if caster.getOrdinal then\
\9\9skill = caster:getLevel()\
\9\9caster = party\
\9\9\
\9end\9\
\9\
\9local target = help.nextEntityAheadOf(caster,3,{'monster','party'})\
\9\
\9if not target then return false end\
\9if add_spells.settings.hold_monster.immune[target.name] then return false end\
\9\
\9playSoundAt(\"frostbolt_launch\",caster.level,caster.x,caster.y)\
\
\9\
\9--dynamically add hooks which prevents monster to attack or move\9\
\9-- use timerId as hook-id so the hook can be removed on destructor\
\9local hold_monsterHook = function() return false end\
\9\
\9local timerId = fw_magic.createSpellTimer(target,add_spells.settings.hold_monster.duration+skill)\
\9\
\9local fx = spawn('fx',target.level,target.x,target.y,target.facing)\
\9fx:setParticleSystem('hold_monster')\
\9fx:translate(0,1,0)\9\9\9\
\9\
\9fw.addHooks(target.id,timerId,{\
\9\9onMove = hold_monsterHook,\
\9\9onAttack = hold_monsterHook,\
\9\9onRangedAttack = hold_monsterHook,\
\9\9onTurn = hold_monsterHook\
\9},\
\0091)\
\9return true\
end\
\
\
-- HASTE --\
\
\
settings.haste = {}\
settings.haste.level = 3\
settings.haste.duration = 10\
 \
settings.haste.count = 0\
function haste(caster, x, y, direction, skill)\
\9local selector = fw_magic.createTargetSelector()\
\9selector.skill = caster:getLevel()\
\9selector.caster_id = fw.getId(caster)\
\9if settings.haste.count == 0 then\
\9\9settings.haste.count = caster:getLevel()\
\9\9if settings.haste.count > 4 then\
\9\9\9settings.haste.count = 4\
\9\9end\
\9end\
\9selector.onSelectChampion = add_spells.castHaste\
\9selector.afterCast = add_spells.hasteAfterCast\
end\
\
function castHaste(target,skill,caster_id)\
\9target:setCondition('haste',settings.haste.duration + skill)\
\9playSoundAt('generic_spell',party.level,party.x,party.y)\
\
end\
\
function hasteAfterCast(caster_id)\
\9settings.haste.count = settings.haste.count - 1\
\9\
\9if settings.haste.count > 0 then\
\9\9add_spells.haste(fw.getById(caster_id))\
\9end\
end\
\
\
-- ARMOR --\
\
settings.armor = {}\
-- threshold + skill (how much damage champion can get before spell is deactivated)\
settings.armor.threshold = 8 \
settings.armor.protection = 6 -- sets protection stat to this level\
\
\
function armor(caster, x, y, direction, skill)\
\9local selector = fw_magic.createTargetSelector()\
\9selector.skill = caster:getLevel()\
\9selector.onSelectChampion = add_spells.castArmor\
end\
\
\
function castArmor(champion,skill)\
\9if champion:getStat('protection') >= add_spells.settings.armor.protection then\
\9\9hudPrint('Armor spell has no effect on '..champion:getName())\
\9\9return false\
\9end\
\9\
\9skill = champion:getLevel() \
\
\9playSoundAt(\"generic_spell\",party.level,party.x,party.y)\
\9data.set(champion,'spell_armor_orig_protection',champion:getStat('protection'))\
\9data.set(champion,'spell_armor_max_protection',champion:getStatMax('protection'))\9\
\9champion:setStatMax('protection',add_spells.settings.armor.protection)\
\9champion:setStat('protection',add_spells.settings.armor.protection)\
\
\9data.set(champion,'spell_armor_damage_threshold',add_spells.settings.armor.threshold + skill)\
\9\
\9fw.addHooks(fw.getId(champion),'spell_armor',{\
\9\
\9\9onDamage = function(champion,damage)\
\9\9\9local damageThreshold = data.get(champion,'spell_armor_damage_threshold') - damage\
\9\9\9if damageThreshold < 1 then\
\9\9\9\9fw.removeHooks(fw.getId(champion),'spell_armor')\
\9\9\9\9champion:setStat('protection',data.get(champion,'spell_armor_orig_protection'))\
\9\9\9\9champion:setStatMax('protection',data.get(champion,'spell_armor_max_protection'))\
\9\9\9\9hudPrint('Effect of armor spell worn out.')\9\9\9\9\
\9\9\9else\
\9\9\9\9data.set(champion,'spell_armor_damage_threshold',damageThreshold)\
\9\9\9end\
\9\9end\
\9\
\9})\9\
\9\
end\
\
-- INVISIBILITY --\
\
settings.invisibility = {}\
settings.invisibility.level = 2\
\
\
function invisibility(caster, x, y, direction, skill)\
\9local selector = fw_magic.createTargetSelector()\
\9selector.skill = skill\
\9selector.onSelectChampion = add_spells.castInvisibility\9\
end\
\
function castInvisibility(champion,skill)\
\9champion:setCondition('invisibility',10000)\
\9playSoundAt('generic_spell',party.level,party.x,party.y)\
\9fw.addHooks(fw.getId(champion),'spell_inivisibility',{\
\9\9onDamage = function(self)\
\9\9\9self:setCondition('invisibility',0)\
\9\9\9fw.removeHooks(fw.getId(self),'spell_inivisibility')\
\9\9end \
\9})\
end\
\
-- INVISIBILITY 10' RADIUS --\
\
settings.invisibility_10_radius = {}\
settings.invisibility_10_radius.level = 3\
\
function invisibility_10_radius(caster, x, y, direction, skill)\
\9for i,champ in ipairs(help.getChampions()) do\
\9\9castInvisibility(champ)\
\9end\
end\
\
-- SPELLS --\
\
function initChampion(champ)\
\9\
\9data.set(champ,'spellPoints',{0,0,0,0,0})\
\9updateSpellPoints(champ)\
\9updateSpellBookDescription(champ)\
\9\
\9fw.addHooks(fw.getId(champ),'add_spells_level_up',{\
\9\9\9onLevelUp = function(champ)\
\9\9\9\9add_spells.updateSpellPoints(champ)\
\9\9\9end\
\9\9}\9\
\9)\
end\
\
function updateSpellPoints(champ)\
\9if champ:getLevel() > 14 then\
\9\9return\
\9end\
\9local progressionTable = {\
\9{1},\
\9{1},\
\9{0, 1},\
\9{1, 1},\
\9{1, 0, 1},\
\9{0, 0, 1},\
\9{0, 1, 0, 1},\
\9{0, 0, 1, 1},\
\9{0, 0, 0, 0, 1},\
\9{0, 1, 0, 0, 1},\
\9{0, 0, 1, 1, 1},\
\9{0, 0, 0, 1, 1},\
\9{1, 1, 1, 0, 0},\
\9{0, 0, 0, 1, 1},\
}\
\9local spellPoints = data.get(champ,'spellPoints')\
\9\
\9for spellLevel,points in ipairs(progressionTable[champ:getLevel()]) do\
\9\9spellPoints[spellLevel] = points + (spellPoints[spellLevel] or 0)\
\9end\
\9\
\9data.set(champ,'spellPoints',spellPoints)\
\9updateSpellBookDescription(champ)\
end\
\
function updateSpellBookDescription(champ)\
\9local sp = data.get(champ,'spellPoints')\
\9local book = champ:getItem(11)\
\9local description = 'Available spell points\\n'\
\9for level,points in ipairs(sp) do\
\9\9description = description..\"\\nLevel \"..level..\":  \"..points\
\9end\
\9description = description..\"\\nYou can learn spells by right clicking the\\ndesired spell scroll from this book.\"\
\9book:setScrollText(description)\
end\
\
function onLearnSpell(scroll,champion)\
\9local spellName = string.sub(scroll.name,12)\
\9local sp = data.get(champion,'spellPoints')\
\9local sl = fw_magic.spells[spellName].level\
\9if (sp[sl] < 1) then\
\9\9hudPrint('Not enough spell points.')\
\9\9return false\
\9end\
\9sp[sl] = sp[sl] - 1\
\9data.set(champion,'spellPoints',sp)\
\9-- overwrite the onLearnSpell-hook\
\9fw_magic.learnSpell(spellName,champion,scroll)\
\9add_spells.updateSpellBookDescription(champion)\
\9return true\
end")
spawn("script_entity", 22,0,0, "fw_magic")
	:setSource("activeSpells = {}\
selector = {\
\9skill = 0,\
\9onSelectChampion = nil,\
\9caster_id = nil\
}\
\
spells = {}\
\
mages = {}\
\
testMode = false\
\
function setTestMode(enabled)\
\9testMode = enabled\
end\
\
function activate()\
\9-- scroll hook --\
\9\
\9fw.addHooks('scrolls','fw_magic',{\
\9\9onReadScroll = function(scroll,champ) \
\9\9\9local spellName = string.sub(scroll.name,8)\
\9\9\9if champ:getClass() ~= 'Mage' or fw_magic.spells[spellName].level > champ:getLevel() then\
\9\9\9\9return false\
\9\9\9end\
\9\9\9fw.executeHooks(spellName,'onCast',champ, party.x, party.y, party.facing, champ:getLevel())\
\9\9\9return true\
\9\9end\
\9})\9\
end\
\
function enableSpellBook()\
\9for i,champ in ipairs(help.getChampions()) do\
\9\9if champ:getClass() == 'Mage' then\
\9\9\9data.set(champ,'learnedSpells',{})\9\
\9\9\9addSpellBookToChampion(champ)\
\9\9end\
\9end\9\
\9\
\9if not testMode then\
\9\9fw.addHooks('party','fw_magic',{\
\9\9\9onCastSpell = fw_magic.canCast\
\9\9},1)\
\9end\9\9\
\9fw.addHooks('items_spell_book','fw_magic',{\
\9\9onLearnSpell = fw_magic.onLearnSpell\
\9})\9\
end\
\
function onLearnSpell(scroll,champion)\
\9local spellName = string.sub(scroll.name,12)\
\9local spellDef = fw_magic.spells[spellName]\
\9if spellDef.skill then\
\9\9if champion:getSkillLevel(spellDef.skill) < spellDef.level then\
\9\9\9hudPrint(\"Not skillfull enough to learn this spell\")\
\9\9\9return false\
\9\9end\
\9elseif champion:getLevel() < spellDef.level then\
\9\9hudPrint(\"Not skillfull enough to learn this spell\")\
\9\9return false\9\
\9end\
\9learnSpell(spellName,champion,scroll)\
\
\9return true\
end\
\
function learnSpell(spellName,champion,scroll)\
\9local spells = data.get(champion,'learnedSpells')\
\9spells[spellName] = true\
\9data.set(champion,'learnedSpells',spells)\
\9hudPrint('Learned a new spell: '..scroll:getUIName())\
\9playSound('discover_spell')\
\9--spawnSpellBook(champion)\
end\
\
\
function defineSpell(spellDef)\
\9spells[spellDef.name] = spellDef\
\9\
\9if not spellDef.onCast then\
\9\9fw.setHookVars(spellDef.name,'fw_magic_spells','onCast',spellDef.name)\
\9\9spellDef.onCast = function(caster)\
\9\9 \9local spellName = fw.getHookVars()\
\9\9\9fw_magic.shootSpell(spellName,caster)\
\9\9end\
\9end\
\9\
\9--default onHit-hook\
\9\
\9if spellDef.projectile and not spellDef.onHit then\
\9\9spellDef.onHit = function(projectile,target,damage,damageType)\
\9\9\9if target.getOrdinal then\
\9\9\9\9target = party\
\9\9\9end\9\
\9\9\9local spellName = fw.getHookVars()\
\9\9\9local caster = fw.getById(data.get(projectile,'caster_id')) \
\9\9\9fw_magic.dealSpellDamage(spellName,caster,target.x,target.y)\
\9\9\9return false\
\9\9end\9\
\9end\
\
\9fw.addHooks(spellDef.name,'fw_magic_spells',{\
\9\9onCast = spellDef.onCast\
\9})\9\9\
\9for i=1, #mages do\
\9\9spawnSpellBook(party:getChampion(mages[i]))\
\9end\
\
end\
\
function dealSpellDamage(spellName,caster,target_x,target_y)\
\9\
\9\9local dir = caster.facing\
\9\9if caster.getOrdinal then\9\
\9\9\9dir = party.facing\9\9\
\9\9end\
\
\9\9\9local damageArea = fw_magic.spells[spellName].area\
\9\9\9\9\9\
\9\9\9if (damageArea) then\
\9\9\9\9\
\9\9\9\9local from_x,to_x,from_y,to_y = 0,0,0,0\
\9\9\9\9if dir == 0 then\
\9\9\9\9\9from_x = damageArea.from[2]\
\9\9\9\9\9to_x =  damageArea.to[2]\
\9\9\9\9\9from_y = - damageArea.to[1]\
\9\9\9\9\9to_y =  - damageArea.from[1]\9\9\9\9\9\
\9\9\9\9elseif dir == 1 then\
\9\9\9\9\9from_x = damageArea.from[1]\
\9\9\9\9\9to_x =  damageArea.to[1]\
\9\9\9\9\9from_y = damageArea.from[2]\
\9\9\9\9\9to_y =  damageArea.to[2]\9\9\9\9\9\
\9\9\9\9elseif dir == 2 then\
\9\9\9\9\9from_x = damageArea.from[2]\
\9\9\9\9\9to_x =  damageArea.to[2]\
\9\9\9\9\9from_y = damageArea.from[1]\
\9\9\9\9\9to_y =  damageArea.to[1]\9\9\9\9\9\9\
\9\9\9\9else\
\9\9\9\9\9from_x = -damageArea.to[1]\
\9\9\9\9\9to_x =  -damageArea.from[1]\
\9\9\9\9\9from_y = -damageArea.to[2]\
\9\9\9\9\9to_y =  -damageArea.from[2]\9\9\9\9\9\
\9\9\9\9end\
\9\9\9\9\
\9\9\9\9for x = from_x,to_x do\
\9\9\9\9\9for y = from_y,to_y do\
\9\9\9\9\9\9fw_magic.doDamage(spellName,caster,target_x + x, target_y + y)\9\9\
\9\9\9\9\9end\
\9\9\9\9end \
\9\9\9else\
\9\9\9\9fw_magic.doDamage(spellName,caster,target_x,target_y)\9\
\9\9\9end\
\9\9\
end\
\
function doDamage(spellName,caster,x,y)\
\9\9local originator = 0\
\9\9local damage = fw_magic.spells[spellName].calculateDamage(caster)\
\9\9local damageType = fw_magic.spells[spellName].damageType\
\9\9\
\9\9if caster.getOrdinal then\
\9\9\9originator = 2 ^ (caster:getOrdinal()+1) \9\
\9\9\9caster = party\9\9\
\9\9end\
\9\9\
\9\9damageTile(caster.level,x, y,(caster.facing + 2)%4,originator+1, damageType,damage)\
\9\9local fxName = fw_magic.spells[spellName].onHitParticleEffect\
\9\9local fx = spawn('fx',caster.level,x ,y ,0)\9\9\
\9\9fx:setParticleSystem(fxName)\
\9\9fx:translate(0,1,0)\9\9\9\9\
\9\9local light = fw_fx.getLightPreset(spellName..'_hit')\
\9\9if light then\
\9\9\9fx:setLight(unpack(light))\9\
\9\9end\
\
\9\9if fw_magic.spells[spellName].onHitSound then\
\9\9\9playSoundAt(fw_magic.spells[spellName].onHitSound,caster.level,x,y)\
\9\9end \9\9\
\9\9\9\
end\
\
\
function addSpell(spellName,hookFunction,projectileName)\
\9fw.addHooks(spellName,'fw_magic_spells',{\
\9\9\9onCast = hookFunction\
\9\9}\
\9)\
\9\
\9local onHitHook = function(projectile,target,damage,damageType)\
\9\9\9if target.getOrdinal then\
\9\9\9\9target = party\
\9\9\9end\9\
\9\9\9local caster = fw.getById(data.get(projectile,'caster_id')) \
\9\9\9\
\9\9\9if caster.getOrdinal then\
\9\9\9\9local originator = 2 ^ (caster:getOrdinal()+1) \9\9\9\
\9\9\9\9damageTile(target.level,target.x,target.y,(target.facing + 2)%4,originator, damageType,damage)\
\9\9\9\9return false\
\9\9\9end\
\9\9\9\
\9\9end\9\
\9\
\9if projectileName then\
\9\9fw.addHooks(projectileName,'fw_magic_spells',{\
\9\9\9onHit = onHitHook\
\9\9})\9\
\9end\
end\
\
\
function createTargetSelector()\
\9if inventory_scanner then\
\9\9destroyTargetSelector()\9\
\9end\
\9local selectorCursor = spawn('spell_selector',nil,nil,nil,nil,'spell_selector')\
\9setMouseItem(selectorCursor)\
\9spawn('timer',party.level,0,0,0,'inventory_scanner')\
\9inventory_scanner:setTimerInterval(0.1)\
\9inventory_scanner:addConnector('activate','fw_magic','scanInventory')\
\9inventory_scanner:activate()\
\9return selector\
end\
\
function destroyTargetSelector()\
\9\9local selectorCursor = findEntity('spell_selector')\
\9\9if (selectorCursor) then\
\9\9\9selectorCursor:destroy()\
\9\9end\
\9\9inventory_scanner:deactivate()\
\9\9inventory_scanner:destroy()\9\
end\
\
function scanInventory()\
\9\
\9for ordinal, champ in ipairs(help.getChampions()) do\
\9\9for slot=1,31 do \
\9\9\9local item = champ:getItem(slot)\
\9\9\9if item and item.name == 'spell_selector' then\
\9\9\9\9champ:removeItem(slot)\
\9\9\9\9selector.onSelectChampion(champ,selector.skill,selector.caster_id)\
\9\9\9\9if (getMouseItem() and getMouseItem().name == 'spell_selector') then\
\9\9\9\9\9setMouseItem()\
\9\9\9\9elseif getMouseItem() then\
\9\9\9\9\9champ:insertItem(slot,getMouseItem())\
\9\9\9\9\9setMouseItem()\
\9\9\9\9end\
\9\9\9\9item:destroy()\
\9\9\9\9break\
\9\9\9end\
\9\9end\
\9end\
\9if getMouseItem() == nil or getMouseItem().name ~= 'spell_selector' then\
\9\9destroyTargetSelector()\9\
\9\9if selector.afterCast then\
\9\9\9selector.afterCast(selector.caster_id)\
\9\9end\
\9end\
end\
\
-- creates a  spell timer\
-- entity = affected entity, \
-- time = how many seconds spells effect  lasts \
-- destructorName = name of the function which is called when the effect of the spell is worn out.\
--                  {script_entity_name,function_name}\
-- returns id of timer\
function createSpellTimer(entity,time,destructorName)\
\9local timer = spawn('timer',party.level,0,0,0)\
\9timer:setTimerInterval(time)\
\9-- store entity.id to table indexed by timer.id so we can access it in spell-destructor\
\9activeSpells[timer.id] = fw.getId(entity)\
\9\
\9if (not destructorName) then\
\9\9destructorName = {'fw_magic','spellTimerDestructor'}\
\9end\
\9\
\9timer:addConnector('activate',destructorName[1],destructorName[2])\
\9timer:activate()\
\9return timer.id\
end\
\
function spellTimerDestructor(timer)\
\9fw.removeHooks(fw_magic.activeSpells[timer.id],timer.id)\
\9fw.debugPrint(fw_magic.activeSpells[timer.id]..' spell effect ended')\
\9fw_magic.activeSpells[timer.id] = nil\
\9timer:deactivate()\
\9timer:destroy()\
\
end\
\
function castSpell(spellName,caster)\
\9fw.executeHooks(spellName,'onCast',caster)\
end\
\
function shootSpell(spellName,caster,speed,damage,fx,onHitFx,sound,onHitSound,area)\
\
\9local spellDef = spells[spellName]\
\9sound = sound or spellDef.sound\
\9onHitSound = onHitSound or spellDef.onHitSound\
\9speed = speed or spellDef.speed\
\9\
\9if spellDef.calculateDamage then\
\9\9damage = spellDef.calculateDamage(caster) \
\9else\
\9\9damage = damage or 0\
\9end\
\9\
\9fx = fx or spellDef.particleEffect\
\9onHitFx = onHitFx or spellDef.onHitParticleEffect\
\
    local caster_id = fw.getId(caster)\
\
\9if caster.getOrdinal then \
\9\9caster = party \
\9end\
\
\9shootProjectile(spellDef.projectile, caster.level, caster.x, caster.y, caster.facing, speed, 0, 0, 0, 0, 0,\
\9\9damage, caster, true)\
\
\9local projectile = nil\
\9for ent in entitiesAt(caster.level, caster.x, caster.y) do\
\9\9if ent.name == spellDef.projectile then\
\9\9\9projectile = ent\
\9\9\9break\
\9\9end\
\9end\
\9data.set(projectile,'caster_id',caster_id)\
\9\
\9fw.setHookVars(projectile.id,'fw_magic_spells','onHit',spellDef.name)\
\9fw.addHooks(projectile.id,'fw_magic_spells',{\
\9\9onHit=spellDef.onHit\
\9})\
\9if fx then\
    \9local effect = fw_fx.addProjectileEffect(projectile,fx,speed,onHitFx,sound,onHitSound)\
\9end\
\9\
\9return projectile \9\
end\
\
function canCast(caster,spellName)\
\9if data.get(caster,'learnedSpells')[spellName] then return true end\
\9hudPrint(caster:getName()..\" haven't learned this spell yet\")\
\9playSound('swipe')\
\9return false\9\
end\
\
-- SPELL BOOK ++\
\
function addSpellBookToChampion(champion)\
\9spawnSpellBook(champion)\
\9table.insert(mages,champion:getOrdinal())\
\9preventPickingUpSpellBook()\
end\
\
function spawnSpellBook(champion)\
\9local champId = '_'..champion:getOrdinal()\
\
\9local book = champion:getItem(11)\
\9if book and string.sub(book.name,1,11) == 'spell_book_' then\
\9\9champion:removeItem(11)\
\9\9-- this is the only way to close the container gui if it's opened\
\9\9for c in book:containedItems() do\
\9\9\9champion:insertItem(11,c)\
\9\9\9champion:removeItem(11)\
\9\9end\
\9end\
\9\
\9book = spawn('spell_book_mage',nil,nil,nil,nil,'spell_book_mage'..champId)\
\9\
\9for i=1,5 do \
\9\9local chapter = spawn('spell_book_level_'..i,nil,nil,nil,nil,'spell_book_level'..i..champId)\
\9\9book:addItem(chapter)\
\9\9for spellName,properties in pairs(fw_magic.spells) do\
\9\9\9if properties.book_page == i then\
\9\9\9\9if data.get(champion,'learnedSpells')[spellName] then\
\9\9\9\9\9chapter:addItem(spawn('spell_book_'..spellName..'_learned',nil,nil,nil,nil,'spell_book_'..spellName..champId))\
\9\9\9\9else\
\9\9\9\9\9chapter:addItem(spawn('spell_book_'..spellName,nil,nil,nil,nil,'spell_book_'..spellName..champId))\9\
\9\9\9\9end\
\9\9\9end\
\9\9end\
\9end\
\9\
\9local item = champion:getItem(11)\
\9if (item) then\
\9\9if string.sub(item.name,1,11) ~= 'spell_book_' then\
\9\9\9setMouseItem(item)\
\9\9end\
\9\9champion:removeItem(11)\
\9end\
\9champion:insertItem(11,book)\9\
end\
\
\
\
function preventPickingUpSpellBook()\
\9if spell_book_timer then\
\9\9return\
\9end\
\9local sbtimer = timers:create('spell_book_timer') \
\
\9sbtimer:setTimerInterval(0.3)\
\9sbtimer:addConnector('activate','fw_magic','spellBookScanner')\
\9sbtimer:setConstant()\
\9sbtimer:activate()\
end\
\
function spellBookScanner()\
\9local mouseItem = getMouseItem()\
\9for _,i in ipairs(mages) do\
\9\9local book = findEntity('spell_book_mage_'..i)\
\9\9-- respawn spell book if it is in dungeon or \
\9\9-- the book or any of it pages is set as mouse item\
\9\9if book or (mouseItem and string.sub(mouseItem.name,1,11) == 'spell_book_') then\
\9\9\9if book then\
\9\9\9\9book:destroy()\
\9\9\9end\9\
\9\9\9setMouseItem()\
\9\9\9spawnSpellBook(party:getChampion(i))\
\9\9end\
\9end\
\9\
end\
\
-- monsters spell support\
\
function addSpellsToMonsters(monsterNamespace,spellName,amount,targets,range,propability,cooldown)\
\
\9local spellHook = function(monster,dir)\
\9\9\9if data.get(monster,'spell_cooldown') then\
\9\9\9\9return false\
\9\9\9end\
\9\9\9local v = fw.getHookVars()\
\9\9\9if math.random() > v.prop then return end\
\9\9\9if (help.nextEntityAheadOf(monster, v.range,v.targets,true)) then\9\9\9\9\
\9\9\9\9local count = data.get(monster,v.spellName..'_count') or v.amount\
\9\9\9\9if count < 1 then\
\9\9\9\9\9return\
\9\9\9\9end\
\9\9\9\9fw.executeHooks(v.spellName,'onCast',monster)\
\9\9\9\9data.set(monster,v.spellName..'_count',count - 1)\
\9\9\9\9data.set(monster,'spell_cooldown',true)\
\9\9\9\9fw.repeatFunction(1,v.cooldown,{monster.id},function(monster_id)\
\9\9\9\9\9\9local monster = fw.getById(monster_id)\
\9\9\9\9\9\9if monster then\
\9\9\9\9\9\9\9data.unset(monster,'spell_cooldown')\
\9\9\9\9\9\9end\
\9\9\9\9\9end\
\9\9\9\9)\
\9\9\9\9return false\
\9\9\9end\
\9\9end\
\9\9\
\9local vars = {}\
\9vars.spellName=spellName\
\9vars.amount=amount\
\9vars.targets=targets\9\9\
\9vars.range = range or 5\
\9vars.prop = propability or 0.5\
\9vars.cooldown = cooldown or 2\
\9\
\9fw.setHookVars(monsterNamespace,'fw_magic_monsters_'..spellName,'onMove',vars)\
\9fw.setHookVars(monsterNamespace,'fw_magic_monsters_'..spellName,'onTurn',vars)\9\
\9\
\9fw.addHooks(monsterNamespace,'fw_magic_monsters_'..spellName,{\
\9\9onMove = spellHook,\
\9\9onTurn = spellHook\
\9})\
end")
spawn("eob_sewers_wall_text_long", 3,17,1, "eob_sewers_wall_text_long_14")
	:setWallText("Teleport to Level 3")
spawn("teleporter", 2,17,1, "teleporter_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(26,4,1,3)
spawn("script_entity", 8,14,1, "script_entity_11")
	:setSource("function levelUp()\
\9party:getChampion(4):levelUp()\
end")
spawn("eob_sewers_wall_text_long", 8,15,0, "eob_sewers_wall_text_long_13")
	:setWallText("Level UP button for character in slot 4 (default mage).\
This is feature to testing AD&D Spells")
spawn("eob_wall_button", 8,15,0, "eob_wall_button_13")
	:addConnector("toggle", "script_entity_11", "levelUp")
spawn("note", 9,14,3, "note_1")
	:setScrollText("Hi!\
We, developers of this mod, frequently test various\
aspects of the dungeon. To make it easier, we've\
put couple things here: experience button, teleports\
to lower levels and possibly other cheaty stuff.\
\
We are currently under dark spell of forgetfullness,\
so we forgot to hide our secret lair and it's open\
now. Be a nice player and don't use any of those.\
\
                        Your friendly developers")
spawn("eob_sewers_door_metal_force", 9,15,3, "eob_sewers_door_metal_force_5")
spawn("teleporter", 2,18,0, "teleporter_12")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(16,14,0,4)
spawn("teleporter", 2,19,3, "teleporter_14")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(10,24,3,5)
spawn("teleporter", 2,20,1, "teleporter_15")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(17,22,1,6)
spawn("teleporter", 2,21,0, "teleporter_16")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(1,19,0,7)
spawn("teleporter", 2,22,3, "teleporter_17")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(7,28,3,8)
spawn("teleporter", 2,23,1, "teleporter_18")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(21,4,1,9)
spawn("teleporter", 2,24,2, "teleporter_19")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(1,11,2,10)
spawn("teleporter", 2,25,2, "teleporter_20")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(14,10,2,11)
spawn("teleporter", 2,26,0, "teleporter_21")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(15,11,0,12)
spawn("eob_sewers_wall_text_long", 3,18,1, "eob_sewers_wall_text_long_16")
	:setWallText("Teleport to Level 4")
spawn("eob_sewers_wall_text_long", 3,19,1, "eob_sewers_wall_text_long_17")
	:setWallText("Teleport to Level 5")
spawn("eob_sewers_wall_text_long", 3,20,1, "eob_sewers_wall_text_long_18")
	:setWallText("Teleport to Level 6")
spawn("eob_sewers_wall_text_long", 3,21,1, "eob_sewers_wall_text_long_19")
	:setWallText("Teleport to Level 7")
spawn("eob_sewers_wall_text_long", 3,22,1, "eob_sewers_wall_text_long_20")
	:setWallText("Teleport to Level 8")
spawn("eob_sewers_wall_text_long", 3,23,1, "eob_sewers_wall_text_long_21")
	:setWallText("Teleport to Level 9")
spawn("eob_sewers_wall_text_long", 3,24,1, "eob_sewers_wall_text_long_22")
	:setWallText("Teleport to Level 10")
spawn("eob_sewers_wall_text_long", 3,25,1, "eob_sewers_wall_text_long_23")
	:setWallText("Teleport to Level 11")
spawn("eob_sewers_wall_text_long", 3,26,1, "eob_sewers_wall_text_long_24")
	:setWallText("Teleport to Level 12")
spawn("script_entity", 30,31,3, "t")
	:setSource("-- this script is for testing purposes only, you can call these functions from console. \
-- Eg. type t.to(floor_dirt_13) to console and the party is moved to the location of floor_dirt_13\
-- or t.t(22,16,1) moves the party to location level x=22,y=16,level=1. Level is optional (default is party.level)\
\
-- move party to x,y,[level]\
-- if the first argument is an entity then teleport to it's location\
function to(x,y,level)\
\9local to_level = level or party.level\
\9local to_x = x\
\9local to_y = y\
\9local to_facing = party.facing\
\9if x == nil then \
\9\9print('Invalid entity name')\
\9\9return\
\9end\
\9\
\9if (type(x) == 'table' and x.x) then\
\9\9to_x = x.x\
\9\9to_y = x.y\
\9\9to_level = x.level\
\9\9to_facing = x.facing\
\9end\
\9party:setPosition(to_x, to_y, to_facing,to_level)\
end\
\
-- teleports party to testpoint location and executes testpoint.activate function if defined\
-- eg. t.run(testpoint_1)\
function run(tp)\
\9if type(tp) ~= 'table' or tp.name ~= 'testpoint'  then \
\9\9print('Invalid testpoint')\
\9\9return\
\9end\
\9to(tp)\
\9if tp.activate then\
\9\9tp.activate()\
\9end\
end\
\
-- lists all entities whose name matches to entityName (even partially)\
-- eg. t.list('scroll',3) list all entities whose name contains a string 'scroll'\
function list(entityName,plevel)\
\9grimq.fromAllEntitiesInWorld():where(\
\9\9function(e) \
\9\9\9if string.find(e.name, entityName) and (not plevel or e.level == plevel) then\
\9\9\9\9print('X:'..e.x..', Y:'..e.y..', L:'..e.level..', N:'..e.name..' ID:'..e.id)\
\9\9\9end \
\9\9end\
\9)\
end\
\
\
\
")
spawn("script_entity", 21,2,1, "illusion_walls")
	:setSource("\
function isIllusionWall(entity)\
\9return grimq.isDoor(entity) and string.find(entity.name,'illusion_wall')\
end\
\
function activate()\
\9\
\9fw.addHooks('party','illusion_walls',{\
\9\9\9onMove = function(self,dir)\
\9\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e) and e.facing == (dir + 2)%4) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\
\9\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e) and e.facing == dir) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\9\9\9\
\9\9\9end,\
\9\9\9onAttack = function(champion,weapon)\
\9\9\9\9fw.hooks.party.illusion_walls.onMove(party,party.facing)\
\9\9\9end\
\9\9}\
\9)\
\
end --activate\
\
function doTheMagic(wall,opener)\
\9if wall:isOpen() then return end\
\9fw.debugPrint(\"open illusionwall secret door id=\"..wall.id)\
\9wall:setDoorState('open')\
end\
")
spawn("testpoint", 29,31,3, "testpoint_1")
	:setSource("-- (This script is here just for a syntax reference, and of course it can be used as a template for your testpoints) \
-- If you want to make a new testpoint just put a new testpoint entity to dungeon and copy paste \
-- the activate function in it.\9\9\
-- You can call t.run(testpoint_1) the party will be spawned to testpoint_1's location and the activate-function is called\
-- to run your testpoint just call t.run(your_testpoint_id)\
\
-- Skills and stats and inventory slots for a reference\
-- skills:air_magic,armors,assassination,athletics,axes,daggers,dodge,earth_magic,fire_magic,ice_magic,maces,\
--       missile_weapons,spellcraft,staves,swords,throwing_weapons, unarmed_combat.\
-- stats:health, energy, strength, dexterity, vitality, willpower, protection, evasion, resist_fire, resist_cold, \
--       resist_poison, resist_shock.\
-- inventory slots: 1 (head), 2 (torso), 3 (legs), 4 (feet), 5 (cloak), 6 (neck), 7 (handl), 8 (handr), \
--                  9 (gaunlets), 10 (bracers), 11-31 (backpack slots).\
\
function activate()\
\9help.modifyChampion{\
\9\9id = 1, -- champion ordinal\
\9\9levelUp = 1, -- raise level by 1 \
\9\9statsUp = {strength=1}, -- raise strength by 1\
\9\9skillsUp= {swords=4}, -- raise swords skill by 1\
\9\9items = {handr=eob_shield_1,[16]=note_1} -- move eob_shield_1 and note_1 from dungeon to inventory\
\9}\
\9help.modifyChampion{\
\9\9id = 2,\
\9\9levelUp = 1,\
\9\9skillsUp= {axes=4},\
\9\9items = {[15]=eob_remains_of_tod_uphill_1}\
\9}\9\
\9help.modifyChampion{\
\9\9id = 3,\
\9\9levelUp = 1,\
\9\9skillsUp = {dodge=2,missile_weapons=2},\
\9\9items = {[15]=eob_lock_picks_1,handl='rock*30'} -- spawn 30 rocks\
\9}\9\9\
\9help.modifyChampion{\
\9\9id = 4,\
\9\9levelUp = 1,\
\9\9skillsUp = {spellcraft=4},\
\9\9items = {[15]=eob_scroll_detect_magic}\
\9}\9\
end")
spawn("script_entity", 12,8,0, "encounters")
	:setSource("-- encounters\
\
function update(ctx, partx)\
\
\9local items=\"\"\
    for i in entitiesAt(party.level, party.x, party.y) do\
\9\9if i.class == \"ScriptEntity\" then\
\9\9\9processEncounter(ctx, i)\
\9\9end\
    end\
end\
\
function processEncounter(ctx, eventScript)\
\9if not sanityCheck(eventScript) then\
\9\9return\
\9end\
\
\9local state = eventScript.state\
\9if state == nil then\
\9\9state = 1\
\9end\
\
\9-- Check if image is defined for this event\
\9local image_x = eventScript.x\
\9local image_y = eventScript.y\
\9if not image_x then\
\9    image_x = 20\
\9end\
\9if not image_y then\
\9\9image_y = 20\
\9end\
\9if eventScript.image then\
\9   ctx.drawImage(eventScript.image, image_x, image_y)\
\9end\
\9\
\9\
\9-- Ok, now write a text\
\9local text_x = eventScript.text_x\
\9local text_y = eventScript.text_y\
\9if not text_x then\
\9\9text_x = 200\
\9end\
\9if not text_y then\
\9\9text_y = 50\
\9end\
\9\
\9stateData = eventScript.states[state]\
\9ctx.color(255, 255, 255)\
\9ctx.drawText(stateData[2], text_x, text_y)\
\9\9\
\9local tbl = eventScript.actions\
\9\9\
\9local buttons_x = eventScript.buttons_x\
\9local buttons_y = eventScript.buttons_y\
\9local buttons_width = eventScript.buttons_width\
\9\9\
\9printChoices(ctx, state, tbl, buttons_x, buttons_y, buttons_width)\
end\
\
function printChoices(ctx, current_state, states, x, y, width)\
\9for key1,value in pairs(states) do\
\9\9if value[1] == current_state then\
\9\9\9showButton(ctx, x, y, width, value[2], value[3])\
\9\9\9y = y + 30\
\9\9end\
\9end\
\
end\
\
function sanityCheck(e)\
\9if e.name ~= \"event\" then\
\9\9return false\
\9end\
    if e.states == nil then\
\9\9return false\
\9end\
\9\
\9if e.actions == nill then\
\9\9return false\
\9end\
\9\
\9if (e.enabled ~= true) then\
\9\9return false\
\9end\
\9\
\9return true\
\
end\
\
function showButton(ctx, x, y, width, text, callback)\
    -- draw button1 with text\
    ctx.color(128, 128, 128)\
    ctx.drawRect(x, y, width, 20)\
    ctx.color(255, 255, 255)\
    ctx.drawText(text, x + 10, y + 15)\
\9local name=\"button\"..x..y\
\9local height = 30\
    if ctx.button(\"button1\", x, y, width, height) then\
\9\9callback(ctx)\
\9end\
end")
spawn("script_entity", 31,1,2, "compass")
	:setSource("-- This example draws a compass as a GUI element. Depending on which\
-- activation mode is chosen, it can be visible all time, toggled\
-- with 'c' key or shown only when 'c' is pressed.\
\
-- draws actual compass\
-- this function is called when compass is visible all time\
function drawCompass(self, g)\
\9local x = 10\
\9local y = g.height - 200\
\9\
\9local dir = string.sub(\"NESW\", party.facing + 1, party.facing + 1)\
\9g.drawImage(\"mod_assets/textures/grimwidgets/compass_full_\"..dir..\".tga\", x, y)\
end\
\
-- this is a simple wrapper function that is called as key press\
-- hook. It calls drawCompass function.\
function callback(g)\
\9drawCompass(self, g)\
end\
\
function autoexec()\
\9local e = {}\
\9e.id = 'compass'\
\9e.draw = drawCompass\
\9e.callback = callback\
\9\
\9-- uncomment this to enabled/disable compass by pressing C\
\9gw.setKeyHook('c', true, e.callback)\
\9\
\9-- Uncomment this to show compass by pressing C\
\9-- gw.setKeyHook('c', false, e.callback)\
\9\
\9-- Uncomment this to have compass permanently visible\
\9-- gw.addElement(e,'gui')\
end")
spawn("sewers_wall_pipe_water", 20,11,2, "sewers_wall_pipe_water_1")
spawn("sewers_wall_pipe_water", 20,13,0, "sewers_wall_pipe_water_2")
spawn("sewers_drainage_water", 14,14,1, "sewers_drainage_water_1")
spawn("sewers_drainage_water", 16,14,3, "sewers_drainage_water_2")
spawn("eob_sewers_secret_door_cube", 19,20,0, "eob_sewers_secret_door_cube_1")
spawn("eob_secret_door_empty", 19,20,3, "eob_secret_door_empty_1")
spawn("eob_secret_door_empty", 19,20,2, "eob_secret_door_empty_2")
spawn("script_entity", 22,2,1, "illusion_walls_obsolete")
	:setSource("-- Illusion walls script - delete - 20/01/2013 --\
\
stayOpenAfterPartyPass = true\
\
--true = monsters can go through illusionary walls\
monstersCanPass = false \
\
function isIllusionWall(entity)\
\9return grimq.isDoor(entity) and string.find(entity.name,'illusion_wall')\
end\
\
function activate()\
\9\
\9fw.addHooks('party','illusion_walls',{\
\9\9\9onMove = function(self,dir)\
\9\9\9\9for e in help.entitiesAtDir(self,dir) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e) and e.facing == (dir + 2)%4) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\
\9\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e) and e.facing == dir) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\9\9\9\
\9\9\9end,\
\9\9\9onAttack = function(champion,weapon)\
\9\9\9\9fw.hooks.party.illusion_walls.onMove(party,party.facing)\
\9\9\9end\
\9\9}\
\9)\
\9if not monstersCanPass then\
\9\9return\
\9end\
\
\9fw.addHooks('monsters','illusion_walls',{\
\9\9onMove = function(self,dir)\
\9\9\9\9-- performace optimization\
\9\9\9\9if self.level ~= party.level then\
\9\9\9\9\9return\
\9\9\9\9end\
\9\9\9\9-- for monsters we have to get entities at 2 tiles ahead also, because if the door is facing towards the monster\
\9\9\9\9-- it can't move to that tile\
\9\9\9\9for e in help.entitiesAtDir(self,self.facing,2) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e) and e.facing == (dir + 2)%4) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\
\9\9\9\9for e in help.entitiesAtAhead(self) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e)) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\9\9\
\9\9\9\9for e in help.entitiesAtSameTile(self) do\
\9\9\9\9\9if (illusion_walls.isIllusionWall(e)) then\
\9\9\9\9\9\9illusion_walls.doTheMagic(e,self)\
\9\9\9\9\9end\
\9\9\9\9end\9\9\9\
\9\9\9end\
\9\9}\
\9)\
\9\
\
end --activate\
\
function doTheMagic(wall,opener)\
\9fw.debugPrint(\"doTheMagic\")\
\9--if data.get(wall,'found') then return end\
\9wall:setDoorState('open')\
end\
\
function doTheMagicOld(wall,opener)\
\9if fw.executeEntityHooks('doors','onPass',wall,opener) == false then\
\9\9data.unset(wall,'found')\
\9\9wall:setDoorState('closed')\
\9\9return\
\9end\
\9if data.get(wall,'found') then return end\
\9wall:setDoorState('open')\
\9if not findEntity(wall.id..'_fake') then\
\9\9spawn(wall.name..\"_fake\", wall.level, wall.x, wall.y, wall.facing, wall.id..'_fake')\
\9end\9\
\9if stayOpenAfterPartyPass and opener.name == 'party' then\
\9\9data.set(wall,'found',true)\
\9\9return\
\9else\
\9\9local iw_timer = timers:create()\
\9\9iw_timer:setTimerInterval(2)\
\9\9iw_timer:setTickLimit(1,true)\
\9\9iw_timer.wallId = wall.id\
\9\9iw_timer:addCallback(\
\9\9\9function(self)\
\9\9\9\9local iwall = findEntity(self.wallId)\
\9\9\9\9iwall:setDoorState('closed')\
\9\9\9end\
\9\9)\
\9\9\
\9\9iw_timer:activate()\
\9end\
end")

--- level 2 ---

mapName("Middle Sewer Level")
setWallSet("sewers")
playStream("assets/samples/music/dungeon_ambient.ogg")
mapDesc([[
################################
################################
###..#...######.....############
#........#...###.#.#......######
###..##.##.#...#.#...#..#.#..###
#........#...#.....##.....##.###
###..#...#.#..#.##....#.##...###
######...#.###.....#.#...#.#.###
##.#######.#...#.#.#...#...#.###
##.##..###.#.##....###...##..###
#......###.#....###...#.####.###
#...#..##....#....#...##.....###
##.#####..#.#..##.##.#...#######
##.......#...#.....#.#...#....##
#####.####.#...#.#.#.#..##.#..##
###..#...#...#...#.#.###...#.###
###....#..#######....#.....#..##
########..#.......####.#...#..##
####.#....#.#######....#########
####.###..#.#...###.#.#.....####
###....####.#.......#.#.#.#.####
#....####...#...###.#.#.....####
###....####.##.####.##.#.#.#####
###..####....#...#.......#.#####
#......#..######.##.##.##..#####
###.#####.#.......#.########...#
###.####..#.#.#####.##.....#...#
###..###.##...#........#...###.#
#......#....###.###.##...#.....#
#.#...####..##..###.##.....#####
##....#.....##..###...##########
################################
]])
spawn("script_entity", 1,1,2, "script_entity_2")
	:setSource("-- Base scripts for Level 2 --\
\
function TeleportR1()\
\9teleporter_3:setTeleportTarget(25, 29, (party.facing + 2)%4)\
end\
function TeleportR2()\
\9teleporter_2:setTeleportTarget(25, 26, (party.facing + 2)%4)\
end\
\
-- creates Illusionary Wall at 20,30\
function IluWall1()\
\9spawn(\"eob_sewers_wall_cube\", 2, 20, 30, 0, \"illusion_wall_2_20_30\")\
\9playSound(\"laugh_human_male_echo\")\
\9hudPrint(texts.getT(\"hollow_laughter\"))\
\9teleporter_4:setTeleportTarget(party.x, party.y, (party.facing + 1)%4)\
\9timer_1:activate()\
end\
function Teleport4Deact()\
\9teleporter_4:deactivate()\
\9timer_1:deactivate()\
end\
\
function MessageDeadEnd()\
\9if texts.getT(\"dead_end_show\") == \"yes\" then \
\9\9hudPrint(texts.getT(\"dead_end\"))\
\9\9texts.setT(\"dead_end_show\",\"no\")\
\9end\
end\
\
function DoorStuckOpen() \
\9if texts.getT(\"door_appears_stuck_pressed\") == \"no\" then\
\9\9eob_sewers_door_metal_stucked:open()\
\9\9timer_2:activate()\
\9end\
end\
function DoorStuckClose()\
\9if texts.getT(\"door_appears_stuck_pressed\") == \"no\" then\
\9\9texts.setT(\"door_appears_stuck_pressed\",\"yes\")\
\9\9hudPrint(texts.getT(\"door_appears_stuck\"))\
\9end\
\9eob_sewers_door_metal_stucked:close()\
\9timer_2:deactivate()\
end\
\
function SpecialQuest2(sender)\
\9if sender:getItemCount() == 0 then\
\9\9setMouseItem(nil)\
\9\9sender:addItem(spawn(\"eob_dagger\"))\
\9\9return false\
\9end\
\9if data.get(sender, \"activated\") then\
\9\9hudPrint(texts.getT(\"dagger_undetachable\"))\
\9\9return false\
\9end\
\9counter_sq2:increment()\
\9data.set(sender, \"activated\", true)\
\9playSound(\"key_lock\")\
\9fw.debugPrint(sender.id..\" is activated\")\
\9-- option for open door by insert dagger in carving\
\9if sender.id == \"eob_sewers_alcove_dagger_1\" and door_throwable_3.getState() == \"closed\" then\
\9\9door_throwable_3.open()\
\9end\
\9-- option for open door by insert dagger in carving\
\9if sender.id == \"eob_sewers_alcove_dagger_5\" and door_throwable_4.getState() == \"closed\" then\
\9\9door_throwable_4.open()\
\9end\
\9local dagger = libObject.containsItem(sender, \"eob_dagger\")\
\9if dagger:getStackSize()>1 then\
\9\9spawn(\"eob_dagger\", party.level, party.x, party.y, party.facing):setStackSize(dagger:getStackSize()-1)\
\9\9dagger:setStackSize(1)\
\9end\
\9if (counter_sq2:getValue() > 0 and counter_sq2:getValue() < 4) then\
\9\9hudPrint(texts.getT(\"dagger_fits\"))\
\9else\
\9\9hudPrint(texts.getT(\"special_quest_for_this_level\"))\
\9\9secret_sq2:activate()\
\9\9spawn(\"eob_rations\", party.level, party.x, party.y, party.facing)\
\9end\
end\
\
\
\
eob_sewers_walltext_rune_transport_1:setWallText(texts.getT(\"look_like_travel_marker\"))\
\
eob_sewers_wall_text_long_1:setWallText(texts.getT(\"not_all_is_as_it_appears\"))\
eob_sewers_wall_text_long_2:setWallText(texts.getT(\"watch_your_step\"))\
eob_sewers_wall_text_long_strength:setWallText(texts.getT(\"only_the_strong\"))\
-- eob_sewers_wall_text_carving_1:setWallText(texts.getT(\"carving_to_place\"))\
")
spawn("eob_sewers_door_metal", 19,24,2, "dungeon_door_metal_11")
spawn("eob_sewers_door_metal", 19,22,0, "dungeon_door_metal_12")
spawn("eob_sewers_door_metal", 20,23,1, "dungeon_door_metal_13")
spawn("eob_lock_silver", 19,24,1, "eob_lock_silver_1")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "dungeon_door_metal_11", "open")
spawn("eob_lock_silver", 20,23,0, "eob_lock_silver_2")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "dungeon_door_metal_13", "open")
spawn("eob_lock_silver", 19,22,3, "eob_lock_silver_3")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "dungeon_door_metal_12", "open")
spawn("eob_silver_key", 19,23,1, "eob_silver_key_1")
spawn("eob_sling", 19,28,3, "eob_sling_1")
spawn("eob_sewers_pressure_plate", 21,30,3, "eob_sewers_pressure_plate_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:addConnector("activate", "script_entity_2", "IluWall1")
spawn("eob_rock", 21,30,0, "eob_rock_3")
spawn("eob_sewers_alcove", 28,28,2, "eob_sewers_alcove_3")
	:addItem(spawn("eob_rations"))
	:addItem(spawn("eob_silver_key"))
	:addConnector("any", "script_entity_3", "AlcoveDoors")
spawn("eob_rations", 28,26,2, "eob_rations_1")
spawn("eob_arrow", 30,28,1, "eob_arrow_1")
spawn("eob_arrow", 30,28,2, "eob_arrow_2")
spawn("eob_sewers_wall_text_long", 19,26,1, "eob_sewers_wall_text_long_1")
	:setWallText("Not all is as it appears")
spawn("teleporter", 21,30,2, "teleporter_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(21,30,2,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("timer", 22,30,3, "timer_1")
	:setTimerInterval(1)
	:addConnector("activate", "script_entity_2", "Teleport4Deact")
spawn("pressure_plate_hidden", 17,27,1, "pressure_plate_hidden_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_2", "MessageDeadEnd")
spawn("blocker", 15,29,3, "blocker_1")
spawn("eob_scroll_shield", 15,27,3, "eob_scroll_shield_1")
spawn("eob_zombie", 14,29,1, "eob_zombie_1")
spawn("eob_zombie", 14,30,1, "eob_zombie_2")
spawn("eob_zombie", 29,13,3, "eob_zombie_3")
spawn("eob_zombie", 4,15,2, "eob_zombie_4")
spawn("eob_zombie", 5,16,1, "eob_zombie_5")
spawn("eob_zombie", 3,16,1, "eob_zombie_6")
spawn("eob_zombie", 6,10,3, "eob_zombie_7")
spawn("eob_zombie", 6,9,3, "eob_zombie_8")
spawn("eob_zombie", 12,13,2, "eob_zombie_9")
spawn("eob_zombie", 14,13,2, "eob_zombie_10")
spawn("eob_zombie", 19,6,1, "eob_zombie_11")
spawn("eob_skeleton", 21,21,0, "eob_skeleton_1")
spawn("eob_skeleton", 4,18,2, "eob_skeleton_2")
spawn("eob_skeleton", 16,7,2, "eob_skeleton_3")
spawn("eob_skeleton", 6,22,3, "eob_skeleton_4")
	:addItem(spawn("leather_cap"))
spawn("eob_skeleton", 6,24,3, "eob_skeleton_5")
spawn("eob_skeleton", 3,26,0, "eob_skeleton_6")
spawn("eob_skeleton", 1,24,1, "eob_skeleton_7")
spawn("eob_skeleton", 6,20,3, "eob_skeleton_8")
spawn("eob_skeleton", 23,4,2, "eob_skeleton_9")
spawn("eob_skeleton_g4", 2,8,2, "eob_skeleton_g4_1")
spawn("counter", 17,30,2, "counter_sq2")
spawn("eob_sewers_wall_text_long", 22,24,3, "eob_sewers_wall_text_long_2")
	:setWallText("Watch your step")
spawn("teleporter", 23,23,1, "teleporter_pit_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(2,30,1,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_lever", 22,24,1, "eob_lever_3")
	:addConnector("any", "script_illusion_pit", "toggle")
spawn("teleporter", 24,22,1, "teleporter_pit_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(3,29,1,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_sewers_pressure_plate", 24,21,2, "eob_sewers_pressure_plate_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:addConnector("any", "script_entity_5", "toggle")
spawn("teleporter", 22,22,2, "teleporter_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:setTeleportTarget(1,28,2,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("teleporter", 1,29,0, "teleporter_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(22,23,0,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_sewers_ceiling_shaft", 2,30,2, "eob_sewers_ceiling_shaft_2")
spawn("eob_sewers_ceiling_shaft", 3,29,2, "eob_sewers_ceiling_shaft_3")
spawn("teleporter", 23,21,0, "teleporter_pit_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(2,28,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("teleporter", 25,20,1, "teleporter_pit_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(4,27,1,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("teleporter", 26,23,3, "teleporter_pit_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(5,30,3,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("teleporter", 27,21,0, "teleporter_pit_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(6,28,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("eob_wall_button", 26,22,3, "eob_wall_button_4")
	:addConnector("toggle", "script_entity_6", "toggle")
	:addConnector("toggle", "script_entity_7", "toggle")
spawn("eob_sewers_ceiling_shaft", 5,30,2, "eob_sewers_ceiling_shaft_5")
spawn("eob_sewers_ceiling_shaft", 2,28,2, "eob_sewers_ceiling_shaft_6")
spawn("eob_sewers_ceiling_shaft", 6,28,2, "eob_sewers_ceiling_shaft_7")
spawn("eob_sewers_ceiling_shaft", 4,27,2, "eob_sewers_ceiling_shaft_8")
spawn("teleporter", 25,21,0, "teleporter_pit_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(4,28,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("eob_sewers_ceiling_shaft", 4,28,2, "eob_sewers_ceiling_shaft_9")
spawn("eob_sewers_pressure_plate", 27,20,1, "eob_sewers_pressure_plate_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:addConnector("activate", "script_entity_8", "toggle")
spawn("eob_rations", 25,24,3, "eob_rations_5")
spawn("eob_sewers_alcove", 23,19,0, "eob_sewers_alcove_1")
	:addItem(spawn("eob_rations"))
	:addItem(spawn("eob_silver_key"))
	:addConnector("deactivate", "script_entity_3", "AlcoveDoors")
spawn("eob_wall_button", 19,19,1, "eob_wall_button_5")
	:addConnector("toggle", "script_entity_2", "DoorStuckOpen")
spawn("eob_sewers_wall_text_long", 19,20,1, "eob_sewers_wall_text_long_strength")
	:setWallText("")
spawn("timer", 20,19,3, "timer_2")
	:setTimerInterval(0.5)
	:addConnector("activate", "script_entity_2", "DoorStuckClose")
spawn("eob_potion_healing", 2,30,3, "eob_potion_healing_1")
spawn("eob_potion_vitality", 21,21,2, "eob_potion_vitality_1")
spawn("sewers_fog", 24,23,1, "sewers_fog_9")
spawn("sewers_fog", 25,19,0, "sewers_fog_10")
spawn("sewers_fog", 19,27,3, "sewers_fog_11")
spawn("floor_dirt", 24,19,3, "floor_dirt_17")
spawn("floor_dirt", 26,24,3, "floor_dirt_26")
spawn("floor_dirt", 26,29,1, "floor_dirt_29")
spawn("floor_dirt", 26,26,1, "floor_dirt_30")
spawn("floor_dirt", 30,25,2, "floor_dirt_31")
spawn("dungeon_ivy_1", 28,25,0, "dungeon_ivy_1_13")
spawn("dungeon_ivy_2", 30,25,1, "dungeon_ivy_2_6")
spawn("dungeon_ivy_2", 15,30,2, "dungeon_ivy_2_7")
spawn("dungeon_ivy_2", 23,20,3, "dungeon_ivy_2_8")
spawn("sewers_fog", 22,18,1, "sewers_fog_12")
spawn("eob_sewers_secret_button_large", 25,15,0, "eob_sewers_secret_button_2")
	:addConnector("toggle", "eob_sewers_secret_door_1", "open")
spawn("eob_sewers_alcove", 29,17,1, "eob_sewers_alcove_2")
	:addItem(spawn("eob_silver_key"))
	:addItem(spawn("eob_rations"))
	:addItem(spawn("eob_potion_giant_strength"))
	:addConnector("any", "script_entity_3", "AlcoveDoors")
spawn("dungeon_ceiling_root_1", 17,27,2, "dungeon_ceiling_root_1_1")
spawn("teleporter_rotator90", 19,27,3, "teleporter_rotator90_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(19,27,3,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("dungeon_wall_dirt_1", 19,30,2, "dungeon_wall_dirt_1_1")
spawn("dungeon_ceiling_root_1", 19,30,3, "dungeon_ceiling_root_1_2")
spawn("script_entity", 23,23,1, "script_illusion_pit")
	:setSource("function toggle()\
\9illusion_pits.toggle(self)\
end")
spawn("eob_sewers_pit_illusion_on", 23,23,3, "eob_sewers_pit_illusion_on_1")
spawn("eob_sewers_pit_illusion_on", 24,22,2, "eob_sewers_pit_illusion_on_2")
spawn("script_entity", 24,22,1, "script_entity_5")
	:setSource("function toggle()\
\9illusion_pits.toggle(self)\
end")
spawn("eob_sewers_pit_illusion_on", 23,21,0, "eob_sewers_pit_illusion_on_3")
spawn("script_entity", 25,21,1, "script_entity_6")
	:setSource("function toggle()\
\9illusion_pits.toggle(self)\
end")
spawn("script_entity", 26,23,1, "script_entity_7")
	:setSource("function toggle()\
\9illusion_pits.toggle(self)\
end")
spawn("eob_sewers_pit_illusion_on", 26,23,2, "eob_sewers_pit_illusion_on_4")
spawn("eob_sewers_pit_illusion_off", 25,21,2, "eob_sewers_pit_illusion_off_1")
spawn("script_entity", 27,21,1, "script_entity_8")
	:setSource("function toggle()\
\9illusion_pits.toggle(self)\
end")
spawn("eob_sewers_pit_illusion_off", 27,21,0, "eob_sewers_pit_illusion_off_2")
spawn("eob_sewers_pit_illusion_on", 25,20,3, "eob_sewers_pit_illusion_on_5")
spawn("floor_dirt", 26,17,1, "floor_dirt_33")
spawn("dungeon_ivy_2", 26,17,1, "dungeon_ivy_2_9")
spawn("sewers_fog", 28,14,1, "sewers_fog_13")
spawn("floor_dirt", 29,14,0, "floor_dirt_34")
spawn("floor_dirt", 28,17,1, "floor_dirt_35")
spawn("dungeon_ivy_1", 29,13,1, "dungeon_ivy_1_15")
spawn("dungeon_ivy_2", 28,17,2, "dungeon_ivy_2_10")
spawn("dungeon_ivy_1", 26,29,1, "dungeon_ivy_1_16")
spawn("dungeon_ivy_1", 22,26,3, "dungeon_ivy_1_17")
spawn("eob_sewers_secret_door", 19,20,3, "eob_sewers_secret_door_a1")
spawn("eob_sewers_secret_door", 18,20,3, "eob_sewers_secret_door_a2")
spawn("eob_sewers_secret_door", 16,20,1, "eob_sewers_secret_door_a3")
spawn("script_entity", 29,19,2, "script_entity_3")
	:setSource("-- open secret door if alcove is empty\
function AlcoveDoors()\
\9for i=1,3 do\
\9\9local alcove = findEntity(\"eob_sewers_alcove_\"..i)\
\9\9if alcove:getItemCount() == 0 then\
\9\9\9local sd = findEntity(\"eob_sewers_secret_door_a\"..i)\
\9\9\9sd:open()\
\9\9\9fw.debugPrint(\"Secret door opened: \"..sd.id)\
\9\9end\
\9end\
end\
")
spawn("eob_stone_dagger", 13,21,2, "eob_stone_dagger_1")
spawn("sewers_fog", 14,20,2, "sewers_fog_14")
spawn("dungeon_ivy_2", 13,19,0, "dungeon_ivy_2_11")
spawn("dungeon_ivy_1", 15,21,2, "dungeon_ivy_1_18")
spawn("dungeon_ivy_1", 12,25,2, "dungeon_ivy_1_19")
spawn("dungeon_ivy_2", 11,27,3, "dungeon_ivy_2_12")
spawn("sewers_fog", 11,28,0, "sewers_fog_15")
spawn("floor_dirt", 11,25,1, "floor_dirt_36")
spawn("floor_dirt", 17,25,3, "floor_dirt_37")
spawn("dungeon_ceiling_root_3", 17,25,0, "dungeon_ceiling_root_3_2")
spawn("dungeon_ceiling_root_2", 17,25,1, "dungeon_ceiling_root_2_2")
spawn("dungeon_ceiling_root_2", 11,30,2, "dungeon_ceiling_root_2_3")
spawn("dungeon_ceiling_root_1", 8,28,3, "dungeon_ceiling_root_1_3")
spawn("eob_sewers_pressure_plate", 7,30,1, "eob_sewers_pressure_plate_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setActivateOnce(true)
	:addConnector("activate", "door_throwable_4", "open")
spawn("eob_potion_healing_extra", 8,30,3, "eob_potion_healing_extra_1")
spawn("eob_rations", 8,30,0, "eob_rations_6")
spawn("dungeon_ivy_2", 8,26,0, "dungeon_ivy_2_13")
spawn("secret", 9,29,2, "secret_sq2")
spawn("eob_teleporter_rats", 8,24,1, "eob_teleporter_rats_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(28,9,1,2)
spawn("eob_sewers_wall_drainage", 12,23,1, "eob_sewers_wall_drainage_1")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 26,24,2, "eob_sewers_wall_drainage_10")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 26,26,0, "eob_sewers_wall_drainage_11")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 14,23,3, "eob_sewers_wall_drainage_12")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 15,27,0, "eob_sewers_wall_drainage_13")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 15,25,2, "eob_sewers_wall_drainage_14")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 11,17,0, "eob_sewers_wall_drainage_15")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 11,15,2, "eob_sewers_wall_drainage_16")
	:setWallText("")
spawn("eob_leather_boots", 19,10,0, "eob_leather_boots_1")
spawn("eob_rations", 19,10,3, "eob_rations_7")
spawn("eob_sewers_door_metal", 20,12,0, "eob_sewers_door_metal_2")
spawn("eob_lock_silver", 20,12,1, "eob_lock_silver_4")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "eob_sewers_door_metal_2", "open")
spawn("eob_wall_button", 9,21,3, "eob_wall_button_6")
	:addConnector("toggle", "elevator_room", "Button1")
spawn("pressure_plate_hidden", 23,26,2, "pressure_plate_hidden_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_2", "TeleportR1")
spawn("teleporter", 23,26,0, "teleporter_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(25,29,0,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("pressure_plate_hidden", 23,29,2, "pressure_plate_hidden_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_2", "TeleportR2")
spawn("teleporter", 23,29,0, "teleporter_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(25,26,0,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("sewers_fog", 4,29,3, "sewers_fog_16")
spawn("eob_sewers_door_metal", 10,21,3, "elevator_door_1")
spawn("script_entity", 7,21,1, "elevator_room")
	:setSource("function PressButton(btn)\
\9local timer = findEntity(\"elevator_timer\")\
\9if (timer) then\
\9\9if timer:isActivated() then\
\9\9\9return\
\9\9end\
\9end\
\9local edoor = findEntity(\"elevator_door_\"..btn)\
\9if edoor:isOpen() then\
\9\9edoor:close()\
\9\9return \
\9else\
\9\9hudPrint(texts.getT(\"room_move\"))\
\9\9if (not timer) then\
\9\9\9timer = spawn(\"timer\", self.level, self.x, self.y, self.facing, \"elevator_timer\")\
\9\9\9timer:setTimerInterval(5.8)\
\9\9\9timer:addConnector(\"activate\",\"elevator_room\",\"MoveFrom\"..btn)\
\9\9end\
\9\9playSound(\"wall_sliding\")\
\9\9party:shakeCamera(0.5,0.5)\
\9\9elevator_timer:activate()\
\9end\
end\
\
-- move room: lvl (level number 1/2/3), dto (door to open 1/2/3)\
function MoveRoom(lvl,dto)\
\9elevator_timer:deactivate()\
\9elevator_timer:destroy()\
\9local eteleporter = findEntity(\"elevator_teleporter_\"..lvl)\
\9eteleporter:activate()\
\9local timer2 = findEntity(\"elevator_timer2\")\
\9if (not timer2) then\
\9\9timer2 = spawn(\"timer\", self.level, self.x, self.y, self.facing, \"elevator_timer2\")\
\9\9timer2:setTimerInterval(0.1)\
\9\9timer2:addConnector(\"activate\",\"elevator_room\",\"DeactivateTeleporters\")\
\9end\
\9elevator_timer2:activate()\
\9local edoor = findEntity(\"elevator_door_\"..dto)\
\9edoor:open()\
end\
\
function DeactivateTeleporters()\
\9playSound(\"party_land\")\
\9party:shakeCamera(0.3,0.3)\
\9elevator_timer2:deactivate()\
\9elevator_teleporter_1:deactivate()\
\9elevator_teleporter_2:deactivate()\
\9elevator_teleporter_3:deactivate()\
end\
\
function MoveFrom1()\
\9elevator_room.MoveRoom(1,2)\
end\
\
function Button1()\
\9elevator_room.PressButton(1)\
end\
\
function MoveFrom2()\
\9elevator_room.MoveRoom(2,3)\
end\
\
function Button2()\
\9elevator_room.PressButton(2)\
end\
\
function MoveFrom3()\
\9elevator_room.MoveRoom(3,1)\
end\
\
function Button3()\
\9elevator_room.PressButton(3)\
end")
spawn("teleporter", 9,21,0, "elevator_teleporter_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(1,21,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("eob_sewers_door_metal", 2,21,3, "elevator_door_2")
spawn("eob_sewers_wall_text_long", 1,21,2, "eob_sewers_wall_text_long_7")
	:setWallText("Correction Facility.")
spawn("eob_wall_button", 10,21,0, "eob_wall_button_7")
	:addConnector("toggle", "elevator_door_1", "open")
spawn("eob_wall_button", 2,21,0, "eob_wall_button_8")
	:addConnector("toggle", "elevator_door_2", "open")
spawn("teleporter", 1,21,0, "elevator_teleporter_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(6,18,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("teleporter", 6,18,0, "elevator_teleporter_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(9,21,0,2)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("eob_sewers_door_metal", 7,18,3, "elevator_door_3")
spawn("eob_wall_button", 7,18,0, "eob_wall_button_9")
	:addConnector("toggle", "elevator_door_3", "open")
spawn("eob_wall_button", 1,21,3, "eob_wall_button_10")
	:addConnector("toggle", "elevator_room", "Button2")
spawn("eob_wall_button", 6,18,3, "eob_wall_button_11")
	:addConnector("toggle", "elevator_room", "Button3")
spawn("eob_sewers_wall_text_long", 6,18,2, "eob_sewers_wall_text_long_8")
	:setWallText("Death section")
spawn("eob_sewers_door_metal", 2,24,3, "eob_sewers_door_metal_3")
	:addPullChain()
spawn("eob_sewers_door_metal", 3,26,0, "eob_sewers_door_metal_4")
	:addPullChain()
spawn("eob_sewers_door_metal", 5,24,1, "eob_sewers_door_metal_5")
	:addPullChain()
spawn("eob_sewers_door_metal", 6,22,3, "eob_sewers_door_metal_6")
	:addPullChain()
spawn("eob_sewers_door_metal", 6,20,3, "eob_sewers_door_metal_7")
	:addPullChain()
spawn("eob_sewers_door_metal", 4,19,0, "eob_sewers_door_metal_8")
	:addPullChain()
spawn("eob_bow", 6,20,2, "eob_bow_1")
spawn("eob_scroll_invisibility", 6,24,2, "eob_scroll_invisibility_1")
	:setScrollText("")
spawn("eob_sewers_secret_button_large", 3,26,3, "eob_sewers_secret_button_3")
	:addConnector("toggle", "eob_sewers_secret_door_cube_2", "open")
	:addConnector("toggle", "eob_secret_door_empty_4", "open")
	:addConnector("toggle", "eob_secret_door_empty_3", "open")
	:addConnector("toggle", "secret_4", "activate")
spawn("torch_holder", 13,20,3, "torch_holder_1")
	:addTorch()
spawn("torch_holder", 20,23,2, "torch_holder_7")
	:addTorch()
spawn("torch_holder", 26,16,1, "torch_holder_8")
	:addTorch()
spawn("eob_sewers_wall_text_long", 9,21,2, "eob_sewers_wall_text_long_9")
	:setWallText("Entry Level.")
spawn("sewers_fog", 4,22,0, "sewers_fog_17")
spawn("eob_gold_key", 3,15,0, "eob_gold_key_1")
spawn("eob_sewers_cave_in_ceiling", 9,16,0, "eob_sewers_cave_in_ceiling_1")
spawn("eob_rock", 9,16,0, "eob_rock_6")
spawn("sewers_fog", 4,16,3, "sewers_fog_18")
spawn("sewers_fog", 8,17,1, "sewers_fog_19")
spawn("floor_dirt", 8,19,0, "floor_dirt_2")
spawn("floor_dirt", 8,15,2, "floor_dirt_3")
spawn("dungeon_ivy_1", 9,16,1, "dungeon_ivy_1_20")
spawn("dungeon_ivy_2", 9,17,1, "dungeon_ivy_2_14")
spawn("dungeon_ivy_2", 9,19,2, "dungeon_ivy_2_15")
spawn("dungeon_ivy_1", 8,19,3, "dungeon_ivy_1_21")
spawn("dungeon_ivy_1", 7,15,0, "dungeon_ivy_1_22")
spawn("dungeon_ivy_1", 4,15,0, "dungeon_ivy_1_23")
spawn("floor_corpse", 9,18,2, "floor_corpse_1")
spawn("eob_metal_hooks_chain", 9,18,1, "eob_metal_hooks_chain_1")
spawn("eob_metal_hooks_chain", 3,15,0, "eob_metal_hooks_chain_2")
spawn("eob_sewers_secret_door", 17,12,0, "eob_sewers_secret_door_5")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 17,12,2, "eob_sewers_secret_door_6")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 16,13,3, "eob_sewers_secret_door_7")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 15,13,3, "eob_sewers_secret_door_8")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 11,12,0, "eob_sewers_secret_door_9")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 11,12,2, "eob_sewers_secret_door_10")
	:setDoorState("open")
spawn("eob_sewers_door_metal", 5,13,3, "eob_sewers_door_metal_11")
spawn("eob_sewers_pressure_plate", 5,14,0, "eob_sewers_pressure_plate_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:addConnector("activate", "eob_sewers_door_metal_11", "open")
	:addConnector("deactivate", "eob_sewers_door_metal_11", "close")
spawn("eob_sewers_secret_door", 12,9,2, "eob_sewers_secret_door_11")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 12,9,0, "eob_sewers_secret_door_12")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 16,2,2, "eob_sewers_secret_door_13")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 16,3,2, "eob_sewers_secret_door_14")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 21,3,3, "eob_sewers_secret_door_15")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 22,3,3, "eob_sewers_secret_door_16")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 22,8,0, "eob_sewers_secret_door_17")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 22,8,2, "eob_sewers_secret_door_18")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 21,8,1, "eob_sewers_secret_door_19")
	:setDoorState("open")
spawn("eob_sewers_secret_door", 13,12,1, "eob_sewers_secret_door_20")
spawn("eob_sewers_secret_door", 10,10,2, "eob_sewers_secret_door_21")
spawn("eob_sewers_secret_door", 11,5,3, "eob_sewers_secret_door_22")
spawn("eob_sewers_secret_door", 11,5,1, "eob_sewers_secret_door_23")
spawn("eob_sewers_secret_door", 12,4,0, "eob_sewers_secret_door_24")
spawn("eob_sewers_wall_drainage", 12,8,0, "eob_sewers_wall_drainage_17")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 12,6,2, "eob_sewers_wall_drainage_18")
	:setWallText("")
spawn("eob_sewers_secret_door", 17,2,1, "eob_sewers_secret_door_25")
spawn("eob_sewers_secret_door", 16,2,1, "eob_sewers_secret_door_26")
spawn("eob_sewers_secret_door", 22,5,0, "eob_sewers_secret_door_27")
spawn("eob_sewers_secret_door", 22,5,3, "eob_sewers_secret_door_28")
spawn("eob_sewers_secret_door", 22,5,1, "eob_sewers_secret_door_29")
spawn("eob_rations", 13,6,1, "eob_rations_8")
spawn("eob_teleporter_rats", 27,9,1, "eob_teleporter_rats_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setTeleportTarget(9,24,1,2)
spawn("torch_holder", 20,10,0, "torch_holder_9")
	:addTorch()
spawn("eob_sewers_door_metal", 4,10,1, "eob_sewers_door_metal_9")
spawn("eob_sewers_door_portcullis", 2,9,0, "portcullis_door_throwable_force_3")
	:setDoorState("open")
spawn("eob_wall_button", 2,8,0, "eob_wall_button_12")
	:setActivateOnce(true)
	:addConnector("toggle", "eob_sewers_secret_door_9", "close")
	:addConnector("toggle", "eob_sewers_secret_door_10", "close")
	:addConnector("toggle", "eob_sewers_secret_door_8", "close")
	:addConnector("toggle", "eob_sewers_secret_door_7", "close")
	:addConnector("toggle", "eob_sewers_secret_door_5", "close")
	:addConnector("toggle", "eob_sewers_secret_door_6", "close")
	:addConnector("toggle", "eob_sewers_secret_door_11", "close")
	:addConnector("toggle", "eob_sewers_secret_door_12", "close")
	:addConnector("toggle", "eob_sewers_secret_door_13", "close")
	:addConnector("toggle", "eob_sewers_secret_door_14", "close")
	:addConnector("toggle", "eob_sewers_secret_door_15", "close")
	:addConnector("toggle", "eob_sewers_secret_door_16", "close")
	:addConnector("toggle", "eob_sewers_secret_door_27", "close")
	:addConnector("toggle", "eob_sewers_secret_door_28", "close")
	:addConnector("toggle", "eob_sewers_secret_door_29", "close")
	:addConnector("toggle", "eob_sewers_secret_door_19", "open")
	:addConnector("toggle", "eob_sewers_secret_door_18", "open")
	:addConnector("toggle", "eob_sewers_secret_door_17", "open")
	:addConnector("toggle", "eob_sewers_secret_door_20", "open")
	:addConnector("toggle", "eob_sewers_secret_door_21", "open")
	:addConnector("toggle", "eob_sewers_secret_door_22", "open")
	:addConnector("toggle", "eob_sewers_secret_door_23", "open")
	:addConnector("toggle", "eob_sewers_secret_door_24", "open")
	:addConnector("toggle", "eob_sewers_secret_door_26", "open")
	:addConnector("toggle", "eob_sewers_secret_door_25", "open")
spawn("eob_lever", 2,8,1, "eob_lever_4")
	:addConnector("activate", "eob_sewers_door_metal_9", "open")
spawn("eob_potion_healing", 6,11,2, "eob_potion_healing_2")
spawn("sewers_fog", 14,11,0, "sewers_fog_20")
spawn("sewers_fog", 23,5,2, "sewers_fog_21")
spawn("floor_dirt", 6,9,2, "floor_dirt_38")
spawn("floor_dirt", 14,15,3, "floor_dirt_39")
spawn("floor_dirt", 14,4,3, "floor_dirt_40")
spawn("dungeon_ivy_1", 6,10,1, "dungeon_ivy_1_24")
spawn("dungeon_ivy_1", 15,9,0, "dungeon_ivy_1_25")
spawn("dungeon_ivy_2", 15,2,3, "dungeon_ivy_2_16")
spawn("dungeon_ivy_2", 19,2,1, "dungeon_ivy_2_17")
spawn("dungeon_ivy_2", 2,13,3, "dungeon_ivy_2_18")
spawn("sewers_fog", 4,10,2, "sewers_fog_22")
spawn("sewers_fog", 15,7,0, "sewers_fog_23")
spawn("sewers_fog", 24,12,3, "sewers_fog_24")
spawn("torch_holder", 22,13,3, "torch_holder_10")
	:addTorch()
spawn("dungeon_ivy_2", 23,14,2, "dungeon_ivy_2_19")
spawn("eob_sewers_door_metal", 28,5,2, "eob_sewers_door_metal_10")
spawn("eob_lock_golden", 27,6,0, "eob_lock_golden_1")
	:setOpenedBy("eob_gold_key")
	:addConnector("activate", "eob_sewers_door_metal_10", "open")
spawn("blocker", 18,13,3, "blocker_2")
spawn("blocker", 9,11,1, "blocker_3")
spawn("blocker", 25,8,2, "blocker_4")
spawn("floor_dirt", 1,11,2, "floor_dirt_15")
spawn("dungeon_ivy_1", 1,11,2, "dungeon_ivy_1_26")
spawn("sewers_fog", 18,4,2, "sewers_fog_25")
spawn("sewers_fog", 12,4,2, "sewers_fog_26")
spawn("sewers_fog", 10,11,2, "sewers_fog_27")
spawn("sewers_fog", 24,27,3, "sewers_fog_29")
spawn("secret", 2,26,3, "secret_4")
spawn("floor_corpse", 3,15,1, "floor_corpse_3")
spawn("eob_sewers_door_metal_force", 20,18,3, "eob_sewers_door_metal_stucked")
spawn("eob_sewers_door_metal_force", 27,13,1, "eob_sewers_door_metal_force_1")
spawn("eob_sewers_door_metal_force", 28,15,2, "eob_sewers_door_metal_force_2")
spawn("eob_sewers_door_metal_force", 7,13,3, "eob_sewers_door_metal_force_3")
spawn("eob_sewers_door_metal_force", 7,15,3, "eob_sewers_door_metal_force_4")
spawn("eob_sewers_door_portcullis", 22,16,1, "portcullis_door_throwable_3")
	:setDoorState("open")
spawn("eob_sewers_door_portcullis", 21,19,2, "portcullis_door_throwable_force_1")
	:setDoorState("open")
spawn("door_throwable", 22,16,1, "door_throwable_3")
	:setSource("state = \"closed\"\
function getState() return state end\
function setState(newstate) state = newstate end\
function open() throwable_portcullis.open(self) end\
function close() throwable_portcullis.close(self) end\
function spawnFakePortcullis() throwable_portcullis.spawnFakePortcullis(self) end\
\
-- spawn(\"eob_sewers_door_portcullis\", self.level, self.x, self.y, self.facing, \"portcullis_\"..self.id):setDoorState('open')\
spawn(\"blocker\", self.level, self.x, self.y, self.facing, \"blocker_\"..self.id)\
spawn(\"timer\", self.level, self.x, self.y, self.facing, \"timer_\"..self.id):setTimerInterval(1):addConnector('activate',self.id,'spawnFakePortcullis')\
self.spawnFakePortcullis()")
spawn("door_throwable", 8,30,1, "door_throwable_4")
	:setSource("state = \"closed\"\
function getState() return state end\
function setState(newstate) state = newstate end\
function open() throwable_portcullis.open(self) end\
function close() throwable_portcullis.close(self) end\
function spawnFakePortcullis() throwable_portcullis.spawnFakePortcullis(self) end\
\
-- spawn(\"eob_sewers_door_portcullis\", self.level, self.x, self.y, self.facing, \"portcullis_\"..self.id):setDoorState('open')\
spawn(\"blocker\", self.level, self.x, self.y, self.facing, \"blocker_\"..self.id)\
spawn(\"timer\", self.level, self.x, self.y, self.facing, \"timer_\"..self.id):setTimerInterval(1):addConnector('activate',self.id,'spawnFakePortcullis')\
self.spawnFakePortcullis()")
spawn("eob_sewers_door_portcullis", 8,30,1, "portcullis_door_throwable_4")
	:setDoorState("open")
spawn("door_throwable_force", 21,19,2, "door_throwable_force_1")
	:setSource("state = \"closed\"\
function getState() return state end\
function setState(newstate) state = newstate end\
function open() throwable_portcullis.open(self) end\
function close() throwable_portcullis.close(self) end\
function spawnFakePortcullis() throwable_portcullis.spawnFakePortcullis(self) end\
\
-- spawn(\"eob_sewers_door_portcullis\", self.level, self.x, self.y, self.facing, \"portcullis_\"..self.id):setDoorState('open')\
spawn(\"blocker\", self.level, self.x, self.y, self.facing, \"blocker_\"..self.id)\
spawn(\"timer\", self.level, self.x, self.y, self.facing, \"timer_\"..self.id):setTimerInterval(1):addConnector('activate',self.id,'spawnFakePortcullis')\
self.spawnFakePortcullis()")
spawn("door_throwable_force", 2,9,0, "door_throwable_force_3")
	:setSource("state = \"closed\"\
function getState() return state end\
function setState(newstate) state = newstate end\
function open() throwable_portcullis.open(self) end\
function close() throwable_portcullis.close(self) end\
function spawnFakePortcullis() throwable_portcullis.spawnFakePortcullis(self) end\
\
-- spawn(\"eob_sewers_door_portcullis\", self.level, self.x, self.y, self.facing, \"portcullis_\"..self.id):setDoorState('open')\
spawn(\"blocker\", self.level, self.x, self.y, self.facing, \"blocker_\"..self.id)\
spawn(\"timer\", self.level, self.x, self.y, self.facing, \"timer_\"..self.id):setTimerInterval(1):addConnector('activate',self.id,'spawnFakePortcullis')\
self.spawnFakePortcullis()")
spawn("eob_ladder_down", 22,22,0, "eob_ladder_down_1")
spawn("eob_ladder_up", 1,29,2, "eob_ladder_up_1")
spawn("eob_sewers_ceiling_shaft", 1,29,1, "eob_sewers_ceiling_shaft_4")
spawn("eob_sewers_pit_fake", 22,22,2, "eob_sewers_pit_fake_1")
spawn("teleporter", 18,23,1, "teleporter_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(17,23,1,1)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_ladder_up", 18,23,3, "eob_ladder_up_2")
spawn("eob_sewers_ceiling_shaft", 18,23,3, "eob_sewers_ceiling_shaft_10")
spawn("eob_sewers_pit_fake", 27,4,3, "eob_sewers_pit_fake_3")
spawn("eob_ladder_down", 27,4,3, "eob_ladder_down_3")
spawn("teleporter", 27,4,1, "teleporter_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(26,4,1,3)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_sewers_secret_door", 26,15,0, "eob_sewers_secret_door_1")
spawn("eob_sewers_alcove_dagger", 22,16,0, "eob_sewers_alcove_dagger_1")
	:addConnector("any", "script_entity_2", "SpecialQuest2")
spawn("eob_sewers_alcove_dagger", 21,30,2, "eob_sewers_alcove_dagger_3")
	:addConnector("any", "script_entity_2", "SpecialQuest2")
spawn("eob_sewers_alcove_dagger", 14,29,3, "eob_sewers_alcove_dagger_4")
	:addConnector("any", "script_entity_2", "SpecialQuest2")
spawn("eob_sewers_alcove_dagger", 9,30,2, "eob_sewers_alcove_dagger_5")
	:addConnector("any", "script_entity_2", "SpecialQuest2")
spawn("script_entity", 24,16,2, "door_throwable_3_opener")
	:setSource("-- sript to create the wall, button and open portcullis...\
\
spawn(\"eob_sewers_wall_blockage_2_24_16\", 2, 24, 16, 3, \"eob_sewers_wall_blockage_2_24_16_3\")\
spawn(\"eob_wall_button\", 2, 23, 16, 1, \"eob_wall_button_2_24_16_3\"):addConnector('toggle',self.id,'removewall')\
spawn(\"timer\", 2, 24, 16, 0, \"timer_\"..self.id):setTimerInterval(0.5):addConnector('activate',self.id,'removewall')\
\
function activate()\
\9playSoundAt(\"button\", 2, 23,16)\
\9door_throwable_3.open()\
\9timer_door_throwable_3_opener:activate()\
end\
\
function removewall()\
\9playSoundAt(\"pit_close\", 2, 23,16)\
\9eob_wall_button_2_24_16_3:destroy()\
\9eob_sewers_wall_blockage_2_24_16_3:destroy()\
\9timer_door_throwable_3_opener:deactivate()\
end")
spawn("eob_sewers_wall_pipe", 20,8,3, "eob_sewers_wall_pipe_7")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 18,8,1, "eob_sewers_wall_pipe_8")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 19,16,2, "eob_sewers_wall_pipe_9")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 19,18,0, "eob_sewers_wall_pipe_10")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 25,17,2, "eob_sewers_wall_pipe_11")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 25,19,0, "eob_sewers_wall_pipe_12")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 17,25,2, "eob_sewers_wall_pipe_13")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 17,27,0, "eob_sewers_wall_pipe_14")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 23,28,0, "eob_sewers_wall_pipe_15")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 23,26,2, "eob_sewers_wall_pipe_16")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 25,27,2, "eob_sewers_wall_pipe_17")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 25,29,0, "eob_sewers_wall_pipe_18")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 17,27,3, "eob_sewers_walltext_rune_transport_1")
	:setWallText("")
spawn("eob_sewers_wall_cube", 23,28,0, "eob_sewers_wall_cube_1")
spawn("eob_illusion_wall_door", 23,28,3, "eob_illusion_wall_door_1")
spawn("eob_illusion_wall_door", 23,29,0, "eob_illusion_wall_door_2")
spawn("eob_illusion_wall_door", 24,28,3, "eob_illusion_wall_door_3")
spawn("eob_sewers_wall_cube", 25,27,0, "eob_sewers_wall_cube_3")
spawn("eob_illusion_wall_door", 25,27,3, "eob_illusion_wall_door_4")
spawn("eob_illusion_wall_door", 25,27,0, "eob_illusion_wall_door_5")
spawn("eob_illusion_wall_door", 26,27,3, "eob_illusion_wall_door_6")
spawn("eob_sewers_wall_cube", 29,28,0, "eob_sewers_wall_cube_4")
spawn("eob_sewers_wall_cube", 30,27,0, "eob_sewers_wall_cube_5")
spawn("eob_illusion_wall_door", 28,28,1, "eob_illusion_wall_door_7")
spawn("eob_illusion_wall_door", 30,28,0, "eob_illusion_wall_door_8")
spawn("eob_sewers_wall_cube", 16,27,0, "eob_sewers_wall_cube_6")
spawn("eob_sewers_wall_cube", 15,28,0, "eob_sewers_wall_cube_7")
spawn("eob_illusion_wall_door", 17,27,3, "eob_illusion_wall_door_9")
spawn("eob_illusion_wall_door", 15,27,2, "eob_illusion_wall_door_10")
spawn("eob_sewers_walltext_rune_transport", 15,27,1, "eob_sewers_walltext_rune_transport_3")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 15,27,2, "eob_sewers_walltext_rune_transport_4")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 22,28,1, "eob_sewers_walltext_rune_transport_5")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 24,28,3, "eob_sewers_walltext_rune_transport_6")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 23,29,0, "eob_sewers_walltext_rune_transport_7")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 24,27,1, "eob_sewers_walltext_rune_transport_8")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 26,27,3, "eob_sewers_walltext_rune_transport_9")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 25,26,2, "eob_sewers_walltext_rune_transport_10")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 28,28,1, "eob_sewers_walltext_rune_transport_11")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 30,28,3, "eob_sewers_walltext_rune_transport_12")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 30,28,0, "eob_sewers_walltext_rune_transport_13")
	:setWallText("")
spawn("eob_sewers_walltext_rune_transport", 30,26,2, "eob_sewers_walltext_rune_transport_14")
	:setWallText("")
spawn("eob_sewers_secret_door_cube", 3,27,0, "eob_sewers_secret_door_cube_2")
spawn("eob_secret_door_empty", 3,27,2, "eob_secret_door_empty_3")
spawn("eob_secret_door_empty", 3,27,1, "eob_secret_door_empty_4")
spawn("eob_sewers_walltext_rats", 9,25,3, "eob_sewers_walltext_rats_1")
	:setWallText("R.A.T.S.")
spawn("eob_sewers_walltext_rats", 28,10,3, "eob_sewers_walltext_rats_3")
	:setWallText("R.A.T.S.")
spawn("starting_location", 9,26,0, "starting_location_1")

--- level 3 ---

mapName("Lower Sewer Level")
setWallSet("sewers")
playStream("assets/samples/music/dungeon_ambient.ogg")
mapDesc([[
################################
#......#...###............#....#
#.#....#.#.#...######.###...#..#
#.######.#####.#.#...#####.##..#
####.........#.#..#.#....#..##.#
####.#.#####.#.##...###.##.#.#.#
#..#.#.#.##..#...##.#....###.#.#
#.##.#....##.###....#.##.#...#.#
#....##....#....#.#.#......###.#
#.##.##....#.##.#.#..#.#####...#
#.##..##.#.#.#..#.####.........#
#.##.#####.#.####.#...##########
#.##.........#....#.#.##########
#.######.#####....#.#.....#..###
#.#..#.#.#...##.###...###....###
#.#..#...#........###...#.###..#
#.#...#################.#..#...#
#.###.....#..........##.###..#.#
#.####..#.#.######.#.##.....#..#
#.#.##.#......#....#.#######...#
#......#.....##....#.........#.#
########.....##....#...##.##.#.#
#.....##......#....#.####.##.#.#
###.##..#######.####..###......#
#.#.#..##.......#...#.##########
#.#.#.#...#.##.#.......#.......#
#...#.#.#.#.#..#.......#.......#
##......#.....##.......#.......#
#.####.##.#.#..#.......#.......#
#...#...#.#.##.#.......#.......#
#.#...#...#....#.......#.......#
################################
]])
spawn("torch_holder", 26,3,1, "torch_holder_11")
	:addTorch()
spawn("eob_sewers_wall_drainage", 19,4,1, "eob_sewers_wall_drainage_19")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 21,4,3, "eob_sewers_wall_drainage_20")
	:setWallText("")
spawn("torch_holder", 27,25,0, "torch_holder_12")
	:addTorch()
spawn("eob_teleporter_rats", 21,2,2, "eob_teleporter_rats_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:setTeleportTarget(3,20,2,3)
spawn("teleporter", 17,1,1, "teleporter_moveto241")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(24,1,1,3)
	:setChangeFacing(false)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("pressure_plate_hidden", 17,1,2, "pressure_plate_hidden_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
	:setSilent(true)
	:addConnector("activate", "script_moveto241", "activate")
spawn("script_entity", 17,0,3, "script_moveto241")
	:setSource("moveto_level3_241_east = false\
moveto_level3_241_east_passed = false\
\
function activate()\
\9if moveto_level3_241_east then\
\9\9moveto_level3_241_east = false\
\9\9if moveto_level3_241_east_passed then\
\9\9\9return false\
\9\9else\
\9\9\9moveto_level3_241_east_passed = true\
\9\9end\
\9end\
\9local timer = spawn(\"timer\", self.level, self.x, self.y, 0)\
\9timer:addConnector(\"activate\", \"script_moveto241\", \"deactivateByTimer\")\
\9timer:setTimerInterval(0.4)\
\9timer:activate()\
\9teleporter_moveto241:activate()\
end\
\
function deactivateByTimer(sender)\
\9teleporter_moveto241:deactivate()\
\9sender:destroy()\
end\
\
function setMoveFromEast()\
\9moveto_level3_241_east = true\
end\
")
spawn("pressure_plate_hidden", 18,1,3, "pressure_plate_hidden_17")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "script_moveto241", "setMoveFromEast")
spawn("eob_sewers_door_metal", 28,1,1, "eob_sewers_door_metal_12")
	:addPullChain()
spawn("eob_sewers_door_metal", 30,4,0, "eob_sewers_door_metal_13")
	:addPullChain()
spawn("eob_sewers_door_metal", 30,9,0, "eob_sewers_door_metal_14")
	:addPullChain()
spawn("eob_sewers_door_metal", 28,10,3, "eob_sewers_door_metal_15")
	:addPullChain()
spawn("eob_sewers_door_metal", 23,10,3, "eob_sewers_door_metal_16")
	:addPullChain()
spawn("teleporter_rotator180", 30,6,1, "teleporter_rotator180_1")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(30,6,1,3)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("teleporter_rotator180", 25,10,3, "teleporter_rotator180_2")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(25,10,3,3)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_silver_key", 28,9,0, "eob_silver_key_2")
spawn("eob_sewers_wall_text_long", 20,9,2, "eob_sewers_wall_text_long_6")
	:setWallText("Under construction.\
Thank you for playing...")
spawn("teleporter", 27,4,3, "teleporter_10")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setTeleportTarget(28,4,3,2)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
spawn("eob_ladder_up", 27,4,1, "eob_ladder_up_3")
spawn("eob_sewers_ceiling_shaft", 27,4,3, "eob_sewers_ceiling_shaft_11")
spawn("eob_sewers_wall_pipe", 22,10,2, "eob_sewers_wall_pipe_19")
	:setWallText("")
spawn("eob_sewers_wall_pipe", 21,11,1, "eob_sewers_wall_pipe_20")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 25,20,0, "eob_sewers_wall_drainage_21")
	:setWallText("")
spawn("eob_sewers_wall_drainage", 25,18,2, "eob_sewers_wall_drainage_22")
	:setWallText("")
spawn("blocker", 19,9,3, "blocker_7")
spawn("blocker", 1,20,1, "blocker_10")
spawn("eob_teleporter_rats", 3,19,0, "eob_teleporter_rats_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:setTeleportTarget(21,1,0,3)
spawn("eob_kuotoa", 23,4,2, "eob_kuotoa_1")
	:addItem(spawn("eob_rations"))
spawn("pressure_plate_hidden", 30,4,2, "pressure_plate_hidden_10")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "eob_sewers_door_metal_13", "close")
spawn("pressure_plate_hidden", 30,6,0, "pressure_plate_hidden_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "script_entity_4", "message")
spawn("script_entity", 29,8,0, "script_entity_4")
	:setSource("function message()\
\9hudPrint(texts.getT(\"feel_dizzy\"))\
end\
")
spawn("pressure_plate_hidden", 25,10,3, "pressure_plate_hidden_12")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "script_entity_4", "message")
spawn("sewers_fog", 30,6,2, "sewers_fog_28")
spawn("sewers_fog", 25,10,2, "sewers_fog_30")
spawn("pressure_plate_hidden", 30,8,3, "pressure_plate_hidden_13")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "eob_sewers_door_metal_14", "close")
spawn("pressure_plate_hidden", 27,10,2, "pressure_plate_hidden_14")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "eob_sewers_door_metal_15", "close")
spawn("pressure_plate_hidden", 23,10,2, "pressure_plate_hidden_15")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setSilent(true)
	:addConnector("activate", "eob_sewers_door_metal_16", "close")
spawn("eob_flind", 22,8,2, "eob_flind_1")
	:addItem(spawn("eob_mace"))
	:addItem(spawn("eob_silver_key"))
spawn("eob_arrow", 21,6,3, "eob_arrow_4")
spawn("eob_kuotoa", 17,5,2, "eob_kuotoa_2")
spawn("eob_kuotoa", 19,3,2, "eob_kuotoa_3")
spawn("eob_sewers_secret_door", 13,2,1, "eob_sewers_secret_door_30")
spawn("eob_sewers_secret_button_large", 14,3,3, "eob_sewers_secret_button_5")
	:addConnector("toggle", "eob_sewers_secret_door_30", "toggle")
spawn("eob_scroll_cause_light_wnds", 12,2,3, "eob_scroll_cause_light_wnds_1")
spawn("eob_sewers_door_metal", 17,12,0, "eob_sewers_door_metal_17")
	:addPullChain()
spawn("eob_sewers_secret_door", 15,14,0, "eob_sewers_secret_door_31")
spawn("arrow", 15,13,1, "arrow_1")
spawn("eob_lock_silver_large", 16,13,2, "eob_lock_silver_large_1")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "script_entity_9", "ButtonRed1")
spawn("eob_lock_silver_large", 15,13,2, "eob_lock_silver_large_2")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "script_entity_9", "ButtonBlue")
spawn("eob_lock_silver_large", 14,13,2, "eob_lock_silver_large_3")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "script_entity_9", "ButtonRed2")
spawn("eob_sewers_secret_door", 16,13,2, "eob_sewers_secret_door_32")
spawn("eob_sewers_secret_door", 14,13,2, "eob_sewers_secret_door_34")
spawn("script_entity", 15,12,0, "script_entity_9")
	:setSource("LockButtonRed1 = false\
LockButtonRed2 = false\
\
-- spawn Button Red on 16,13\
function ButtonRed1()\
\9eob_lock_silver_large_1:destroy()\
\9spawn(\"eob_lock_button_red\", 3, 16, 13, 2):addConnector('toggle',self.id,'SpawnK1')\
end\
-- spawn Button Red on 14,13\
function ButtonRed2()\
\9eob_lock_silver_large_3:destroy()\
\9spawn(\"eob_lock_button_red\", 3, 14, 13, 2):addConnector('toggle',self.id,'SpawnK2')\
end\
-- spawn Button Blue on 15,13\
function ButtonBlue()\
\9eob_lock_silver_large_2:destroy()\
\9spawn(\"eob_lock_button_blue\", 3, 15, 13, 2, \"button_blue_2_15_13\"):addConnector('toggle',self.id,'OpenDoor')\
end\
\
-- summon Kuo-Toa on 16,12 --\
function SpawnK1()\
\9if not LockButtonRed1 then\
\9\9spawn(\"eob_kuotoa\", 3, 16, 12, 2):addItem(spawn(\"eob_silver_key\")):addItem(spawn(\"eob_rations\"))\
\9\9LockButtonRed1 = true\
\9end\
end\
-- summon Kuo-Toa on 14,12 --\
function SpawnK2()\
\9if not LockButtonRed2 then\
\9\9spawn(\"eob_kuotoa\", 3, 14, 12, 2):addItem(spawn(\"eob_silver_key\")):addItem(spawn(\"eob_rations\"))\
\9\9LockButtonRed2 = true\
\9end\
end\
\
function OpenDoor()\
\9button_blue_2_15_13:destroy()\
\9eob_sewers_secret_door_31:open()\
end")
spawn("pressure_plate_hidden", 12,15,2, "pressure_plate_hidden_16")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_10", "SpawnPit")
spawn("eob_gem_red", 10,15,3, "eob_gem_red_1")
spawn("eob_dagger_backstabber", 10,15,0, "eob_dagger_backstabber_1")
spawn("eob_scroll_detect_magic", 12,14,0, "eob_scroll_detect_magic_2")
spawn("eob_sewers_pit_illusion_off", 11,15,2, "eob_sewers_pit_illusion_off_3")
spawn("teleporter", 11,15,0, "teleporter_pit_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:setTeleportTarget(19,24,0,4)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("script_entity", 11,15,3, "script_entity_10")
	:setSource("function SpawnPit()\
\9illusion_pits.toggle(self)\
end")
spawn("eob_sewers_door_metal", 26,14,3, "eob_sewers_door_metal_18")
spawn("eob_kuotoa", 27,14,3, "eob_kuotoa_4")
spawn("eob_potion_healing", 28,13,3, "eob_potion_healing_3")
spawn("eob_potion_healing_extra", 28,13,2, "eob_potion_healing_extra_2")
spawn("eob_lock_silver", 25,13,1, "eob_lock_silver_5")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "eob_sewers_door_metal_18", "open")
spawn("eob_lock_silver", 26,16,0, "eob_lock_silver_7")
	:setOpenedBy("eob_silver_key")
	:addConnector("activate", "eob_sewers_door_metal_18", "open")
spawn("eob_kuotoa", 28,19,1, "eob_kuotoa_5")
	:addItem(spawn("eob_rations"))
spawn("eob_sewers_pit_illusion_off", 21,20,2, "eob_sewers_pit_illusion_off_5")
spawn("teleporter", 21,20,0, "teleporter_13")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(true)
	:setTeleportTarget(29,29,0,4)
	:setInvisible(true)
	:setSilent(true)
	:setHideLight(true)
	:setScreenFlash(false)
	:deactivate()
spawn("script_entity", 21,20,3, "script_entity_12")
	:setSource("function SpawnPit()\
\9illusion_pits.toggle(self)\
end")
spawn("pressure_plate_hidden", 22,20,2, "pressure_plate_hidden_19")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(false)
	:setTriggeredByItem(false)
	:setActivateOnce(true)
	:setSilent(true)
	:addConnector("activate", "script_entity_12", "SpawnPit")
spawn("eob_sewers_door_metal", 21,24,0, "eob_sewers_door_metal_19")
spawn("eob_sewers_walltext_rats", 22,1,2, "eob_sewers_walltext_rats_2")
	:setWallText("R.A.T.S.")
spawn("eob_sewers_walltext_rats", 4,20,0, "eob_sewers_walltext_rats_4")
	:setWallText("R.A.T.S.")

--- level 4 ---

mapName("Upper Level Dwarven Ruins")
setWallSet("temple")
playStream("assets/samples/music/temple_ambient.ogg")
mapDesc([[
##############################.#
#........................##..#.#
#.#####.#######...##.###.##..#.#
#.#...#.......#...#..##..###.#.#
#.###.#.#####..####..##..#.#.#.#
#.....#.#..........##..###.#...#
#.#.#.#.#..##..#.#.....#.#.#.#.#
#.....#.#.#...#...#.###....#.#.#
#.#.#.#.###.#####.#...####...#.#
#.....#.#.....#.#.#.##..##.###.#
###.###.#.....#.###.....##.#..##
#...###.#.....#...#.####.#.#..##
#.##.##.#.....##.#.....#.#.#.#.#
#.##.#..#.#.#.#..#.##..#..##.#.#
#.#..#.#..#.#..#.#.#.###.#.#...#
#.#..#.#..#.#..#.#.#...#.#.#.#.#
#.##.#.###...####...#.####.#.#.#
#.#..#.###...#....#....###.#.#.#
#.#..#.######..#######...###.#.#
#.#..#.#...#...#.#...#.....#...#
#.####.#...#...#.#...#...#.#.#.#
#.#..#.#...#...#.#...#####.#.#.#
#....#.#####..##.######....#.#.#
#.#..#.#..##.....#...##.#####..#
#.####.#..#.####.#......#...#.##
#.####.#.##.#..#.#...##.#.....##
#..............#.#####......#.##
##.###.##.###.##.#####..#.###.##
#...#...#..##..........#...#...#
#...#...#..#.#.#.#####.#.......#
#...#...#..#...........#...#...#
##############################.#
]])
spawn("eob_ruins_portal_amulet", 16,1,0, "eob_ruins_portal_amulet_4_16_1_N")
spawn("eob_ruins_wall_text", 17,1,0, "eob_ruins_wall_text_4_17_1_N")
	:setWallText("")
spawn("eob_ruins_net_torn", 30,0,0, "eob_ruins_net_torn_4_30_0")
spawn("eob_ruins_door_stone", 14,1,1, "eob_ruins_door_stone_4_14_1")
spawn("eob_ruins_door_stone", 18,1,3, "eob_ruins_door_stone_4_18_1")
	:addPullChain()
spawn("eob_ruins_statue_lever", 3,3,0, "eob_ruins_statue_lever_4_3_3_N")
spawn("eob_ruins_door_stone", 7,2,0, "eob_ruins_door_stone_4_7_2")
	:addPullChain()
spawn("eob_ruins_wall_text", 13,3,0, "eob_ruins_wall_text_4_13_3_N")
	:setWallText("")
spawn("eob_ruins_lever", 15,2,3, "eob_ruins_lever_4_15_2_W")
spawn("eob_ruins_door_stone", 24,2,0, "eob_ruins_door_stone_4_24_2")
	:addPullChain()
spawn("eob_ruins_statue_lock", 1,3,1, "eob_ruins_statue_lock_4_1_3_E")
spawn("eob_ruins_pressure_plate", 9,3,1, "eob_ruins_pressure_plate_4_9_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_pit", 10,3,1, "eob_ruins_pit_4_10_3")
spawn("eob_ruins_pit", 11,3,1, "eob_ruins_pit_4_11_3")
spawn("eob_ruins_pit", 12,3,1, "eob_ruins_pit_4_12_3")
spawn("eob_ruins_wall_small_statue", 15,3,3, "eob_ruins_wall_small_statue_4_15_3_W")
spawn("eob_ruins_wall_small_statue", 17,3,1, "eob_ruins_wall_small_statue_4_17_3_E")
spawn("eob_ruins_alcove", 20,3,1, "eob_ruins_alcove_4_20_3_E")
	:addItem(spawn("eob_potion_cure_poison"))
	:addItem(spawn("eob_potion_cure_poison"))
spawn("eob_ruins_net", 28,3,0, "eob_ruins_net_4_28_3")
spawn("eob_ruins_door_stone", 1,4,0, "eob_ruins_door_stone_4_1_4")
spawn("eob_ruins_illusion_wall", 5,3,2, "eob_ruins_illusion_wall_4_5_3_S")
spawn("eob_ruins_illusion_wall", 5,5,0, "eob_ruins_illusion_wall_4_5_5_N")
spawn("eob_ruins_statue_lever", 13,4,3, "eob_ruins_statue_lever_4_13_4_W")
spawn("eob_ruins_wall_small_statue", 16,3,2, "eob_ruins_wall_small_statue_4_16_3_S")
spawn("eob_ruins_wall_small_statue", 16,5,0, "eob_ruins_wall_small_statue_4_16_5_N")
spawn("eob_ruins_alcove", 20,4,1, "eob_ruins_alcove_4_20_4_E")
	:addItem(spawn("eob_potion_cure_poison"))
	:addItem(spawn("eob_potion_cure_poison"))
spawn("eob_ruins_net", 30,4,2, "eob_ruins_net_4_30_4")
spawn("eob_ruins_statue_lock", 1,5,3, "eob_ruins_statue_lock_4_1_5_W")
spawn("eob_ruins_wall_text", 23,4,2, "eob_ruins_wall_text_4_23_4_S")
	:setWallText("")
spawn("eob_ruins_alcove", 24,4,2, "eob_ruins_alcove_4_24_4_S")
spawn("eob_ruins_wall_text", 2,5,2, "eob_ruins_wall_text_4_2_5_S")
	:setWallText("")
spawn("eob_ruins_button", 1,6,1, "eob_ruins_button_4_1_6_E")
spawn("eob_ruins_door_stone", 3,6,0, "eob_ruins_door_stone_4_3_6")
spawn("eob_ruins_button", 4,5,2, "eob_ruins_button_4_4_5_S")
spawn("eob_ruins_door_stone", 20,6,3, "eob_ruins_door_stone_4_20_6")
	:addPullChain()
spawn("eob_ruins_door_stone", 2,7,3, "eob_ruins_door_stone_4_2_7")
spawn("eob_ruins_door_stone", 4,7,1, "eob_ruins_door_stone_4_4_7")
spawn("eob_ruins_chain_lever", 18,6,2, "eob_ruins_chain_lever_4_18_6_S")
spawn("eob_ruins_net", 25,7,1, "eob_ruins_net_4_25_7")
spawn("eob_ruins_button", 2,9,0, "eob_ruins_button_4_2_9_N")
spawn("eob_ruins_door_stone", 3,8,2, "eob_ruins_door_stone_4_3_8")
spawn("eob_ruins_button", 5,8,3, "eob_ruins_button_4_5_8_W")
spawn("eob_ruins_door_stone", 20,8,3, "eob_ruins_door_stone_4_20_8")
	:addPullChain()
spawn("eob_ruins_statue_lever", 21,8,1, "eob_ruins_statue_lever_4_21_8_E")
spawn("eob_ruins_wall_text", 13,9,1, "eob_ruins_wall_text_4_13_9_E")
	:setWallText("")
spawn("eob_ruins_wall_text", 21,8,2, "eob_ruins_wall_text_4_21_8_S")
	:setWallText("")
spawn("eob_ruins_statue_lock", 2,11,0, "eob_ruins_statue_lock_4_2_11_N")
spawn("eob_ruins_door_stone", 3,10,0, "eob_ruins_door_stone_4_3_10")
spawn("eob_ruins_statue_lock", 4,9,2, "eob_ruins_statue_lock_4_4_9_S")
spawn("eob_ruins_wall_text", 9,10,3, "eob_ruins_wall_text_4_9_10_W")
	:setWallText("")
spawn("eob_ruins_door_stone", 20,10,3, "eob_ruins_door_stone_4_20_10")
	:addPullChain()
spawn("eob_ruins_net_torn", 26,10,0, "eob_ruins_net_torn_4_26_10")
spawn("eob_ruins_wall_text", 13,11,1, "eob_ruins_wall_text_4_13_11_E")
	:setWallText("")
spawn("eob_ruins_stairs_down", 4,12,0, "eob_ruins_stairs_down_4_4_12_S")
spawn("eob_ruins_wall_text", 9,12,3, "eob_ruins_wall_text_4_9_12_W")
	:setWallText("")
spawn("eob_ruins_door_stone", 20,12,3, "eob_ruins_door_stone_4_20_12")
	:addPullChain()
spawn("eob_ruins_net", 28,12,0, "eob_ruins_net_4_28_12")
spawn("eob_ruins_wall_small_statue", 6,13,3, "eob_ruins_wall_small_statue_4_6_13_W")
spawn("eob_ruins_door_stone", 9,13,0, "eob_ruins_door_stone_4_9_13")
	:addPullChain()
spawn("eob_ruins_wall_small_statue", 10,12,2, "eob_ruins_wall_small_statue_4_10_12_S")
spawn("eob_ruins_door_stone", 11,13,0, "eob_ruins_door_stone_4_11_13")
spawn("eob_ruins_statue_lock", 12,12,2, "eob_ruins_statue_lock_4_12_12_S")
spawn("eob_ruins_door_stone", 13,13,0, "eob_ruins_door_stone_4_13_13")
	:addPullChain()
spawn("eob_ruins_wall_text", 14,14,0, "eob_ruins_wall_text_4_14_14_N")
	:setWallText("")
spawn("eob_ruins_statue_lever", 14,14,1, "eob_ruins_statue_lever_4_14_14_E")
spawn("eob_ruins_statue_lock", 4,15,1, "eob_ruins_statue_lock_4_4_15_E")
spawn("eob_ruins_stairs_up", 16,15,2, "eob_ruins_stairs_up_4_16_15_N")
spawn("eob_ruins_door_stone", 4,16,0, "eob_ruins_door_stone_4_4_16")
spawn("eob_ruins_door_stone", 21,16,0, "eob_ruins_door_stone_4_21_16")
	:addPullChain()
spawn("eob_ruins_secret_button_tiny", 6,17,3, "eob_ruins_secret_button_tiny_4_6_17_W")
spawn("eob_ruins_door_stone", 20,17,1, "eob_ruins_door_stone_4_20_17")
	:addPullChain()
spawn("eob_ruins_wall_small_statue", 10,17,2, "eob_ruins_wall_small_statue_4_10_17_S")
spawn("eob_ruins_wall_small_statue", 12,17,2, "eob_ruins_wall_small_statue_4_12_17_S")
spawn("eob_ruins_net_torn", 28,18,2, "eob_ruins_net_torn_4_28_18")
spawn("eob_ruins_chain_lever", 11,18,2, "eob_ruins_chain_lever_4_11_18_S")
spawn("eob_ruins_stairs_up", 16,19,0, "eob_ruins_stairs_up_4_16_19_S")
spawn("eob_ruins_door_stone", 25,19,3, "eob_ruins_door_stone_4_25_19")
spawn("eob_ruins_pressure_plate", 26,19,1, "eob_ruins_pressure_plate_4_26_19")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_wall_text", 10,20,1, "eob_ruins_wall_text_4_10_20_E")
	:setWallText("")
spawn("eob_ruins_wall_small_statue", 16,20,1, "eob_ruins_wall_small_statue_4_16_20_E")
spawn("eob_ruins_wall_text", 20,20,1, "eob_ruins_wall_text_4_20_20_E")
	:setWallText("")
spawn("eob_ruins_button", 24,20,1, "eob_ruins_button_4_24_20_E")
spawn("eob_ruins_net_torn", 30,20,0, "eob_ruins_net_torn_4_30_20")
spawn("eob_ruins_button", 16,21,3, "eob_ruins_button_4_16_21_W")
spawn("eob_ruins_net", 26,21,0, "eob_ruins_net_4_26_21")
spawn("eob_ruins_door_stone", 2,22,1, "eob_ruins_door_stone_4_2_22")
	:addPullChain()
spawn("eob_ruins_door_stone", 16,22,2, "eob_ruins_door_stone_4_16_22")
spawn("eob_ruins_door_stone", 14,23,1, "eob_ruins_door_stone_4_14_23")
spawn("eob_ruins_pressure_plate", 16,23,2, "eob_ruins_pressure_plate_4_16_23")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_net", 23,23,0, "eob_ruins_net_4_23_23")
spawn("eob_ruins_stairs_down", 11,24,0, "eob_ruins_stairs_down_4_11_24_S")
spawn("eob_ruins_statue_lock", 15,23,2, "eob_ruins_statue_lock_4_15_23_S")
spawn("eob_ruins_ceiling_shaft", 19,24,2, "eob_ruins_ceiling_shaft_4_19_24")
spawn("eob_ruins_net", 21,24,3, "eob_ruins_net_4_21_24")
spawn("eob_ruins_door_stone", 8,25,2, "eob_ruins_door_stone_4_8_25")
	:addPullChain()
spawn("eob_ruins_wall_small_statue", 12,26,0, "eob_ruins_wall_small_statue_4_12_26_N")
spawn("eob_ruins_net_torn", 16,26,0, "eob_ruins_net_torn_4_16_26")
spawn("eob_ruins_net", 24,26,1, "eob_ruins_net_4_24_26")
spawn("eob_ruins_door_stone", 2,27,0, "eob_ruins_door_stone_4_2_27")
	:addPullChain()
spawn("eob_ruins_door_stone", 6,27,0, "eob_ruins_door_stone_4_6_27")
	:addPullChain()
spawn("eob_ruins_door_stone", 9,27,0, "eob_ruins_door_stone_4_9_27")
	:addPullChain()
spawn("eob_ruins_door_stone", 13,27,0, "eob_ruins_door_stone_4_13_27")
spawn("eob_ruins_button", 14,26,2, "eob_ruins_button_4_14_26_S")
spawn("eob_ruins_net", 25,27,0, "eob_ruins_net_4_25_27")
spawn("eob_ruins_net", 29,27,2, "eob_ruins_net_4_29_27")
spawn("eob_ruins_pressure_plate", 13,28,2, "eob_ruins_pressure_plate_4_13_28")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_net", 15,28,1, "eob_ruins_net_4_15_28")
spawn("eob_ruins_net_torn", 17,28,3, "eob_ruins_net_torn_4_17_28")
spawn("eob_ruins_statue_lever", 10,29,1, "eob_ruins_statue_lever_4_10_29_E")
spawn("eob_ruins_net", 27,29,1, "eob_ruins_net_4_27_29")
spawn("eob_ruins_ceiling_shaft", 29,29,2, "eob_ruins_ceiling_shaft_4_29_29")
spawn("eob_ruins_net", 13,30,1, "eob_ruins_net_4_13_30")
spawn("eob_ruins_net", 17,30,3, "eob_ruins_net_4_17_30")
spawn("eob_ruins_net", 30,31,0, "eob_ruins_net_4_30_31")
spawn("eob_arrow_u", 29,10,1, "eob_arrow_u_10")
spawn("eob_stone_scepter_u", 27,2,3, "eob_stone_scepter_u_1")
spawn("eob_ring_protection3_u", 24,6,0, "eob_ring_protection3_u_1")
spawn("eob_rations_iron_u", 20,19,1, "eob_rations_iron_u_1")
spawn("eob_axe_drow_cleaver_u", 11,18,2, "eob_axe_drow_cleaver_u_1")
spawn("eob_potion_healing", 3,14,0, "eob_potion_healing_5")
spawn("eob_rock_u", 30,28,1, "eob_rock_u_10")
spawn("eob_arrow_u", 26,4,0, "eob_arrow_u_11")
spawn("eob_key_dwarven_u", 3,7,0, "eob_key_dwarven_u_1")
spawn("eob_potion_cure_poison", 24,15,3, "eob_potion_cure_poison_1")
spawn("eob_rock_u", 19,24,0, "eob_rock_u_11")
spawn("eob_rations_iron_u", 20,19,1, "eob_rations_iron_u_2")
spawn("eob_cleric_scroll_slow_poison", 3,19,2, "eob_cleric_scroll_slow_poison_1")
spawn("eob_robe_u", 10,17,3, "eob_robe_u_1")
spawn("eob_rock_u", 30,12,0, "eob_rock_u_12")
spawn("eob_mace_u", 22,6,2, "eob_mace_u_1")
spawn("eob_arrow_u", 20,25,2, "eob_arrow_u_12")
spawn("eob_shield_u", 10,20,3, "eob_shield_u_4")
spawn("eob_ring2_u", 29,11,2, "eob_ring2_u_1")
spawn("eob_key_dwarven_u", 15,8,0, "eob_key_dwarven_u_2")
spawn("eob_medallion_of_adornment_u", 10,17,3, "eob_medallion_of_adornment_u_1")
spawn("eob_mace_u", 21,13,3, "eob_mace_u_2")
spawn("eob_potion_healing", 3,19,0, "eob_potion_healing_6")
spawn("eob_rations_iron_u", 20,19,1, "eob_rations_iron_u_3")
spawn("eob_key_dwarven_u", 28,28,0, "eob_key_dwarven_u_3")
spawn("eob_key_dwarven_u", 9,15,2, "eob_key_dwarven_u_4")
spawn("eob_dwarven_helmet_u", 10,20,0, "eob_dwarven_helmet_u_1")
spawn("eob_mage_scroll_flame_arrow", 3,19,3, "eob_mage_scroll_flame_arrow_1")
spawn("eob_potion_cure_poison", 24,15,3, "eob_potion_cure_poison_2")
spawn("eob_spider", 29,10,0, "eob_spider_1")
spawn("eob_spider", 28,1,0, "eob_spider_2")
spawn("eob_spider", 3,7,0, "eob_spider_3")
spawn("eob_spider", 25,29,0, "eob_spider_4")
spawn("eob_spider", 28,2,0, "eob_spider_5")
spawn("eob_spider", 28,8,0, "eob_spider_6")
spawn("eob_spider", 26,24,0, "eob_spider_7")
spawn("eob_spider", 28,10,0, "eob_spider_8")
spawn("eob_spider", 29,30,0, "eob_spider_9")
spawn("eob_spider", 15,2,0, "eob_spider_10")
spawn("eob_spider", 18,21,0, "eob_spider_11")
spawn("eob_spider", 27,2,0, "eob_spider_12")
spawn("eob_spider", 27,1,0, "eob_spider_13")
spawn("eob_spider", 21,15,0, "eob_spider_14")
spawn("eob_spider", 18,25,0, "eob_spider_15")
spawn("testpoint", 16,14,0, "testpoint_2")
	:setSource("function activate()\
\
end")
spawn("event", 15,14,0, "event_2")
	:setSource("-- is this event enabled?\
enabled = true\
\
-- name of the imeage to show\
image = \"mod_assets/images/lv4-taghor.dds\"\
\
-- image position\
image_x = 40\
image_y = 60\
\
-- text description position\
text_x = 220\
text_y = 60\
\
-- buttons position\
buttons_x = 220\
buttons_y = 160\
buttons_width = 200\
\
-- initial state\
state = 1\
\
-- functions called after specific buttons being pressed\
function onHeal()\
    hudPrint(\"Healing!\")\
    state = 2\
end\
\
function onTalk()\
    hudPrint(\"Dwarf is in too much pain to talk.\")\
end\
\
function onLeave()\
    enabled = false\
end\
\
function onHealed()\
    hudPrint(\"Healed already!\")\
end\
\
-- defines states. Each entry must have exactly two columns:\
-- first is state number, the second is description shown.\
states = {\
  { 1, \"An injured dwarf lies on the ground before you,\\n\" ..\
       \"nearly unconscious from his wounds.\" },\
  { 2, \"The healed dwarf is happy.\" }\
}\
\
-- defines possible actions in each state. Each entry has\
-- 3 values. First is state number. Second is action name\
-- (will be printed on a button). The third is a function\
-- that will be called when action is taken (i.e. button\
-- is pressed).\
actions = {\
  { 1, \"tend his wounds\", onHeal },\
  { 1, \"talk\", onTalk },\
  { 1, \"leave\", onLeave},\
  { 2, \"healed\", onHealed}\
}\
\
\
\
")
spawn("gw_event", 15,13,2, "gw_event_2")
	:setSource("-- is this event enabled?\
enabled = true\
\
-- name of the imeage to show\
image = \"mod_assets/images/lv4-taghor.dds\"\
\
-- todo: the following x,y coords are temporary.\
--       They should be calculated automatically.\
\
-- image position\
image_x = 40\
image_y = 60\
\
-- text description position\
text_x = 220\
text_y = 60\
\
-- buttons position\
buttons_x = 220\
buttons_y = 160\
buttons_width = 200\
\
-- initial state\
state = 1\
\
-- functions called after specific buttons being pressed\
function onHeal()\
    hudPrint(\"Healing!\")\
    state = 2\
end\
\
function onTalk()\
    hudPrint(\"Dwarf is in too much pain to talk.\")\
end\
\
function onLeave()\
    enabled = false\
end\
\
function onHealed()\
    hudPrint(\"He is healed already!\")\
end\
\
-- defines states. Each entry must have exactly two columns:\
-- first is state number, the second is description shown.\
states = {\
  { 1, \"An injured dwarf lies on the ground before you,\\n\" ..\
       \"nearly unconscious from his wounds.\" },\
  { 2, \"The healed dwarf is happy.\" }\
}\
\
-- defines possible actions in each state. Each entry has\
-- 3 values. First is state number. Second is action name\
-- (will be printed on a button). The third is a function\
-- that will be called when action is taken (i.e. button\
-- is pressed).\
actions = {\
  { 1, \"tend his wounds\", onHeal },\
  { 1, \"talk\", onTalk },\
  { 1, \"leave\", onLeave},\
  { 2, \"healed\", onHealed}\
}\
")

--- level 5 ---

mapName("Dwarven Ruins and Camp")
setWallSet("temple")
playStream("assets/samples/music/temple_ambient.ogg")
mapDesc([[
################################
#.#..#..#..#...#..###...#...####
#....#..#.##.#.#..#...#.###....#
####.#..#....#...##.###.######.#
#....###########..#..........#.#
#...#...........#.####.....#.#.#
##.##..###.###..#.#.#...#..#...#
#..#.###.....###....#...##.#####
#..#..##.....#.....##......#####
#.##.#..#...###.....#.#........#
#................#..#####.####.#
#..###.##...###..#.##...###....#
#....##.......#.#...##.........#
#.#####..#.#..#.#...##.#######.#
#..###...###...##...##.........#
#..#..#.......#..####...#.#.##.#
#..####..#.#..##...#..#......#.#
#.#......#.#.....#####..#.##.#.#
#.#..##.##.##.####...#..#....#.#
#.####...............##.######.#
#....###..##.....#...#.........#
#..........#.###.##.##..########
#######....#..##.##.##.......###
#......#..###.#####.#####....###
#.####.#....#.#####.#...########
#.##.#.#..#######............###
#.......#.####....#.#.######.###
####.#.......#.##.#.......##.###
#..#.###.##..#...##..##.####.###
#.##.#.#####.###....###......###
#....#.......######...#.########
################################
]])
spawn("eob_ruins_alcove", 6,1,0, "eob_ruins_alcove_5_6_1_N")
spawn("eob_ruins_alcove", 7,1,0, "eob_ruins_alcove_5_7_1_N")
spawn("eob_ruins_illusion_wall_rune", 14,1,3, "eob_ruins_illusion_wall_rune_5_14_1_W")
spawn("eob_ruins_illusion_wall_rune", 12,1,1, "eob_ruins_illusion_wall_rune_5_12_1_E")
spawn("eob_ruins_stairs_down", 25,1,3, "eob_ruins_stairs_down_5_25_1_E")
spawn("eob_ruins_door_stone", 2,2,1, "eob_ruins_door_stone_5_2_2")
	:addPullChain()
spawn("eob_ruins_secret_button_tiny", 12,2,1, "eob_ruins_secret_button_tiny_5_12_2_E")
spawn("eob_ruins_illusion_wall", 23,1,2, "eob_ruins_illusion_wall_5_23_1_S")
spawn("eob_ruins_illusion_wall_rune", 23,3,0, "eob_ruins_illusion_wall_rune_5_23_3_N")
spawn("eob_ruins_door_stone", 28,2,3, "eob_ruins_door_stone_5_28_2")
spawn("eob_ruins_ceiling_shaft", 10,3,1, "eob_ruins_ceiling_shaft_5_10_3")
spawn("eob_ruins_ceiling_shaft", 11,3,1, "eob_ruins_ceiling_shaft_5_11_3")
spawn("eob_ruins_ceiling_shaft", 12,3,2, "eob_ruins_ceiling_shaft_5_12_3")
spawn("eob_ruins_wall_text", 23,3,3, "eob_ruins_wall_text_5_23_3_W")
	:setWallText("")
spawn("eob_ruins_alcove", 6,3,2, "eob_ruins_alcove_5_6_3_S")
spawn("eob_ruins_alcove", 7,3,2, "eob_ruins_alcove_5_7_3_S")
spawn("eob_ruins_portal_necklace", 10,5,0, "eob_ruins_portal_necklace_5_10_5_N")
spawn("eob_ruins_illusion_wall", 21,4,3, "eob_ruins_illusion_wall_5_21_4_W")
spawn("eob_ruins_illusion_wall_rune", 19,4,1, "eob_ruins_illusion_wall_rune_5_19_4_E")
spawn("eob_teleporter", 24,4,1, "eob_teleporter_5_24_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 25,4,1, "eob_teleporter_5_25_4")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_alcove", 15,5,1, "eob_ruins_alcove_5_15_5_E")
	:addItem(spawn("eob_stone_necklace_u"))
spawn("eob_ruins_door_stone", 17,5,0, "eob_ruins_door_stone_5_17_5")
	:addPullChain()
spawn("eob_ruins_lever", 21,6,0, "eob_ruins_lever_5_21_6_N")
spawn("eob_teleporter", 22,5,2, "eob_teleporter_5_22_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 24,5,2, "eob_teleporter_5_24_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_door_stone", 28,5,0, "eob_ruins_door_stone_5_28_5")
spawn("eob_ruins_door_stone", 2,6,0, "eob_ruins_door_stone_5_2_6")
	:addPullChain()
spawn("eob_ruins_illusion_wall_statue", 10,5,2, "eob_ruins_illusion_wall_statue_5_10_5_S")
spawn("eob_ruins_illusion_wall_statue", 10,7,0, "eob_ruins_illusion_wall_statue_5_10_7_N")
spawn("eob_teleporter", 22,6,2, "eob_teleporter_5_22_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 23,6,2, "eob_teleporter_5_23_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_lever", 25,6,3, "eob_ruins_lever_5_25_6_W")
spawn("eob_teleporter", 26,6,2, "eob_teleporter_5_26_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_door_stone", 29,6,1, "eob_ruins_door_stone_5_29_6")
spawn("eob_teleporter", 22,7,2, "eob_teleporter_5_22_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_wall_text", 23,7,1, "eob_ruins_wall_text_5_23_7_E")
	:setWallText("")
spawn("eob_teleporter", 26,7,2, "eob_teleporter_5_26_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 21,8,2, "eob_teleporter_5_21_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 23,8,2, "eob_teleporter_5_23_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 24,8,1, "eob_teleporter_5_24_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_door_stone", 1,9,2, "eob_ruins_door_stone_5_1_9")
	:addPullChain()
spawn("eob_ruins_door_stone", 4,9,2, "eob_ruins_door_stone_5_4_9")
	:addPullChain()
spawn("eob_ruins_secret_button_tiny", 6,9,3, "eob_ruins_secret_button_tiny_5_6_9_W")
spawn("eob_ruins_lever", 21,9,3, "eob_ruins_lever_5_21_9_W")
spawn("eob_teleporter", 23,9,2, "eob_teleporter_5_23_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 24,9,2, "eob_teleporter_5_24_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 25,9,2, "eob_teleporter_5_25_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_blocker", 30,9,1, "eob_blocker_5_30_9")
spawn("eob_ruins_illusion_wall_rune", 4,10,3, "eob_ruins_illusion_wall_rune_5_4_10_W")
spawn("eob_ruins_illusion_wall", 2,10,1, "eob_ruins_illusion_wall_5_2_10_E")
spawn("eob_ruins_door_stone", 5,10,1, "eob_ruins_door_stone_5_5_10")
spawn("eob_ruins_door_stone_stacked", 8,10,1, "eob_ruins_door_stone_stacked_5_8_10")
spawn("eob_ruins_door_stone", 14,10,1, "eob_ruins_door_stone_5_14_10")
	:addPullChain()
spawn("eob_ruins_stairs_up", 4,12,1, "eob_ruins_stairs_up_5_4_12_W")
spawn("eob_ruins_illusion_wall_rune", 26,12,3, "eob_ruins_illusion_wall_rune_5_26_12_W")
spawn("eob_ruins_illusion_wall_rune", 24,12,1, "eob_ruins_illusion_wall_rune_5_24_12_E")
spawn("eob_ruins_door_stone", 1,13,0, "eob_ruins_door_stone_5_1_13")
	:addPullChain()
spawn("eob_ruins_wall_text", 10,13,1, "eob_ruins_wall_text_5_10_13_E")
	:setWallText("")
spawn("eob_ruins_ceiling_shaft", 22,13,2, "eob_ruins_ceiling_shaft_5_22_13")
spawn("eob_ruins_illusion_wall", 30,12,2, "eob_ruins_illusion_wall_5_30_12_S")
spawn("eob_ruins_illusion_wall_rune", 30,14,0, "eob_ruins_illusion_wall_rune_5_30_14_N")
spawn("eob_ruins_alcove", 10,13,2, "eob_ruins_alcove_5_10_13_S")
spawn("eob_ruins_pressure_plate", 22,14,2, "eob_ruins_pressure_plate_5_22_14")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_illusion_wall", 25,14,3, "eob_ruins_illusion_wall_5_25_14_W")
spawn("eob_ruins_illusion_wall_rune", 23,14,1, "eob_ruins_illusion_wall_rune_5_23_14_E")
spawn("eob_ruins_secret_button_tiny", 2,15,1, "eob_ruins_secret_button_tiny_5_2_15_E")
spawn("eob_ruins_button", 20,16,0, "eob_ruins_button_5_20_16_N")
spawn("eob_ruins_illusion_wall_rune", 27,14,2, "eob_ruins_illusion_wall_rune_5_27_14_S")
spawn("eob_ruins_illusion_wall", 27,16,0, "eob_ruins_illusion_wall_5_27_16_N")
spawn("eob_ruins_illusion_wall", 25,16,3, "eob_ruins_illusion_wall_5_25_16_W")
spawn("eob_ruins_illusion_wall", 23,16,1, "eob_ruins_illusion_wall_5_23_16_E")
spawn("eob_ruins_illusion_wall", 27,16,3, "eob_ruins_illusion_wall_5_27_16_W")
spawn("eob_ruins_illusion_wall", 25,16,1, "eob_ruins_illusion_wall_5_25_16_E")
spawn("eob_ruins_wall_text", 18,18,0, "eob_ruins_wall_text_5_18_18_N")
	:setWallText("")
spawn("eob_ruins_statue_lever", 19,18,0, "eob_ruins_statue_lever_5_19_18_N")
spawn("eob_ruins_illusion_wall", 1,17,2, "eob_ruins_illusion_wall_5_1_17_S")
spawn("eob_ruins_illusion_wall", 1,19,0, "eob_ruins_illusion_wall_5_1_19_N")
spawn("eob_ruins_statue_lock", 6,19,0, "eob_ruins_statue_lock_5_6_19_N")
spawn("eob_ruins_door_stone", 7,18,2, "eob_ruins_door_stone_5_7_18")
spawn("eob_ruins_statue_lock", 9,19,0, "eob_ruins_statue_lock_5_9_19_N")
spawn("eob_ruins_door_stone", 10,18,2, "eob_ruins_door_stone_5_10_18")
spawn("eob_ruins_statue_lock", 12,19,0, "eob_ruins_statue_lock_5_12_19_N")
spawn("eob_ruins_door_stone", 13,18,2, "eob_ruins_door_stone_5_13_18")
spawn("eob_ruins_door_stone", 23,19,2, "eob_ruins_door_stone_5_23_19")
	:addPullChain()
spawn("eob_ruins_ceiling_shaft", 9,20,2, "eob_ruins_ceiling_shaft_5_9_20")
spawn("eob_ruins_illusion_wall_rune", 6,21,3, "eob_ruins_illusion_wall_rune_5_6_21_W")
spawn("eob_ruins_illusion_wall_rune", 4,21,1, "eob_ruins_illusion_wall_rune_5_4_21_E")
spawn("eob_ruins_wall_text", 20,20,2, "eob_ruins_wall_text_5_20_20_S")
	:setWallText("")
spawn("eob_ruins_stairs_down", 16,22,2, "eob_ruins_stairs_down_5_16_22_N")
spawn("eob_ruins_lever", 19,22,3, "eob_ruins_lever_5_19_22_W")
spawn("eob_ruins_illusion_wall", 8,22,2, "eob_ruins_illusion_wall_5_8_22_S")
spawn("eob_ruins_illusion_wall", 9,23,3, "eob_ruins_illusion_wall_5_9_23_W")
spawn("eob_ruins_illusion_wall", 8,24,0, "eob_ruins_illusion_wall_5_8_24_N")
spawn("eob_ruins_illusion_wall_rune", 9,22,2, "eob_ruins_illusion_wall_rune_5_9_22_S")
spawn("eob_ruins_illusion_wall_rune", 9,24,0, "eob_ruins_illusion_wall_rune_5_9_24_N")
spawn("eob_ruins_illusion_wall", 8,23,1, "eob_ruins_illusion_wall_5_8_23_E")
spawn("eob_ruins_door_stone", 19,23,0, "eob_ruins_door_stone_5_19_23")
spawn("eob_ruins_stairs_up", 11,24,1, "eob_ruins_stairs_up_5_11_24_W")
spawn("eob_ruins_door_stone", 25,25,1, "eob_ruins_door_stone_5_25_25")
	:addPullChain()
spawn("eob_ruins_secret_button_tiny", 3,26,2, "eob_ruins_secret_button_tiny_5_3_26_S")
spawn("eob_ruins_door_stone", 14,27,0, "eob_ruins_door_stone_5_14_27")
	:addPullChain()
spawn("eob_teleporter", 17,27,2, "eob_teleporter_5_17_27_N")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_door_stone", 24,27,3, "eob_ruins_door_stone_5_24_27")
spawn("eob_ruins_ornate_lock", 23,28,1, "eob_ruins_ornate_lock_5_23_28_E")
spawn("eob_ruins_ornate_lock", 25,27,2, "eob_ruins_ornate_lock_5_25_27_S")
spawn("eob_ruins_door_stone", 17,29,3, "eob_ruins_door_stone_5_17_29")
	:addPullChain()
spawn("eob_ruins_door_stone", 25,29,1, "eob_ruins_door_stone_5_25_29")
	:addPullChain()
spawn("eob_ruins_illusion_wall_rune", 8,30,3, "eob_ruins_illusion_wall_rune_5_8_30_W")
spawn("eob_ruins_illusion_wall_rune", 6,30,1, "eob_ruins_illusion_wall_rune_5_6_30_E")
spawn("eob_rations_iron_u", 12,10,1, "eob_rations_iron_u_4")
spawn("eob_rations_iron_u", 8,7,0, "eob_rations_iron_u_5")
spawn("eob_mage_scroll_invisibility 10'", 25,27,1, "eob_mage_scroll_invisibility 10'_1")
spawn("eob_long_sword_u", 25,10,0, "eob_long_sword_u_2")
spawn("eob_key_dwarven_u", 4,25,0, "eob_key_dwarven_u_5")
spawn("eob_spear_u", 21,2,2, "eob_spear_u_2")
spawn("eob_rock_u", 25,16,0, "eob_rock_u_13")
spawn("eob_cleric_scroll_hold_person", 1,1,1, "eob_cleric_scroll_hold_person_1")
spawn("eob_key_u", 28,26,0, "eob_key_u_1")
spawn("eob_rations_iron_u", 6,14,0, "eob_rations_iron_u_6")
spawn("eob_key_u", 14,28,0, "eob_key_u_2")
spawn("eob_rock_u", 21,11,0, "eob_rock_u_14")
spawn("eob_cleric_scroll_prayer", 6,29,0, "eob_cleric_scroll_prayer_1")
spawn("eob_axe_cursed3_u", 20,25,1, "eob_axe_cursed3_u_1")
spawn("eob_wand_cone_of_cold_2_u", 27,16,0, "eob_wand_cone_of_cold_2_u_1")
spawn("eob_mage_scroll_dispel_magic", 5,15,1, "eob_mage_scroll_dispel_magic_1")
spawn("eob_sling_cursed3_u", 19,26,2, "eob_sling_cursed3_u_1")
spawn("eob_cleric_scroll_aid", 5,6,3, "eob_cleric_scroll_aid_1")
spawn("eob_cleric_scroll_detect_magic", 24,8,0, "eob_cleric_scroll_detect_magic_1")
spawn("eob_rations_iron_u", 21,2,2, "eob_rations_iron_u_7")
spawn("eob_leather_boots_u", 19,30,2, "eob_leather_boots_u_2")
spawn("eob_potion_poison", 10,13,2, "eob_potion_poison_1")
spawn("eob_rations_iron_u", 7,12,0, "eob_rations_iron_u_8")
spawn("eob_scale_mail_u", 4,25,3, "eob_scale_mail_u_1")
spawn("eob_mage_scroll_haste", 6,6,2, "eob_mage_scroll_haste_1")
spawn("eob_ring2_feather_fall_u", 22,27,1, "eob_ring2_feather_fall_u_1")
spawn("eob_plate_mail_u", 25,27,2, "eob_plate_mail_u_1")
spawn("eob_dwarf1_1", 19,13,0, "eob_dwarf1_1_1")
spawn("eob_dwarf2_1_group", 14,8,0, "eob_dwarf2_1_group_1")
spawn("eob_dwarf1_2", 15,12,0, "eob_dwarf1_2_1")
spawn("eob_spider", 20,16,0, "eob_spider_16")
spawn("eob_dwarf1_2", 15,13,0, "eob_dwarf1_2_2")
spawn("eob_spider", 22,11,0, "eob_spider_17")
spawn("eob_spider", 22,22,0, "eob_spider_18")
spawn("eob_spider", 6,2,0, "eob_spider_19")
spawn("eob_dwarf1_2", 19,10,0, "eob_dwarf1_2_3")
spawn("eob_spider", 5,15,0, "eob_spider_20")
spawn("eob_spider", 7,2,0, "eob_spider_21")
spawn("eob_spider", 2,16,0, "eob_spider_22")
spawn("eob_spider", 1,2,0, "eob_spider_23")
spawn("eob_dwarf1_2", 17,13,0, "eob_dwarf1_2_4")
spawn("eob_spider", 1,5,0, "eob_spider_24")
spawn("eob_spider", 3,12,0, "eob_spider_25")
spawn("eob_dwarf4_1_group", 18,14,0, "eob_dwarf4_1_group_1")
spawn("eob_dwarf1_1", 17,8,0, "eob_dwarf1_1_2")
spawn("eob_spider", 21,16,0, "eob_spider_26")

--- level 6 ---

mapName("Botton Level of Dwarven Ruins")
setWallSet("temple")
playStream("assets/samples/music/temple_ambient.ogg")
mapDesc([[
####.###########################
####.####...........###...#....#
###...###.######.##.###.###.#..#
##.....##.....##.##...#.#.#.####
#.......#.##..#...#...#........#
#.#####.#.#...#...#...###.#.#..#
#.###.#.#.#################.####
#####.###......................#
###.....###...............#.#..#
#...#.#...#..######..##...#.####
#..#...#..#..#....#..#####....##
#..#...#..#..###..#..#......#.##
#..#...#..#..######..#..##.#...#
#####.#####..........#..##.#...#
#....................#.....#...#
#....................#.###..#.##
########.#.##.########.#..###.##
####...#.#.##.##.......#..#...##
###.#..#.#.#####..#######.#.####
###.##...#.########.......#.#..#
#...#..##..#...####.#####.#.#..#
####...#..##...####.##.........#
#######..####..#....##.####.####
##......###########.##....#.#..#
##.############......#....#....#
##......#.#####......#....#...##
#######.######.....###....#...##
##......######.#####....#####.##
##.#########.#....#...####..#.##
##....########....#...##......##
##....########....#....#......##
################################
]])
spawn("eob_ruins_stairs_up", 4,0,0, "eob_ruins_stairs_up_6_4_0_S")
spawn("eob_ruins_stairs_up", 25,1,1, "eob_ruins_stairs_up_6_25_1_W")
spawn("eob_ruins_door_stone", 16,2,0, "eob_ruins_door_stone_6_16_2")
	:addPullChain()
spawn("eob_ruins_door_stone", 19,2,0, "eob_ruins_door_stone_6_19_2")
	:addPullChain()
spawn("eob_ruins_door_stone", 10,3,3, "eob_ruins_door_stone_6_10_3")
	:addPullChain()
spawn("eob_ruins_pressure_plate", 25,3,0, "eob_ruins_pressure_plate_6_25_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_door_stone", 26,4,1, "eob_ruins_door_stone_6_26_4")
	:addPullChain()
spawn("eob_ruins_door_stone", 1,5,0, "eob_ruins_door_stone_6_1_5")
spawn("eob_ruins_door_stone", 7,5,0, "eob_ruins_door_stone_6_7_5")
spawn("eob_ruins_wall_text", 24,4,2, "eob_ruins_wall_text_6_24_4_S")
	:setWallText("")
spawn("eob_ruins_pressure_plate", 25,5,2, "eob_ruins_pressure_plate_6_25_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_ceiling_shaft", 1,6,2, "eob_ruins_ceiling_shaft_6_1_6")
spawn("eob_ruins_stairs_down", 5,6,0, "eob_ruins_stairs_down_6_5_6_S")
spawn("eob_ruins_ceiling_shaft", 7,6,2, "eob_ruins_ceiling_shaft_6_7_6")
spawn("eob_ruins_ornate_lock", 27,6,3, "eob_ruins_ornate_lock_6_27_6_W")
spawn("eob_ruins_door_stone", 26,7,1, "eob_ruins_door_stone_6_26_7")
spawn("eob_ruins_door_stone", 5,9,2, "eob_ruins_door_stone_6_5_9")
	:addPullChain()
spawn("eob_ruins_dart_firing_pad", 4,10,3, "eob_ruins_dart_firing_pad_6_4_10_W")
spawn("eob_ruins_dart_firing_pad", 6,10,1, "eob_ruins_dart_firing_pad_6_6_10_E")
spawn("eob_ruins_portal_scepter", 12,10,1, "eob_ruins_portal_scepter_6_12_10_E")
spawn("eob_ruins_stairs_down", 14,10,3, "eob_ruins_stairs_down_6_14_10_E")
spawn("eob_ruins_dart_firing_pad", 4,11,3, "eob_ruins_dart_firing_pad_6_4_11_W")
spawn("eob_ruins_pressure_plate", 5,11,2, "eob_ruins_pressure_plate_6_5_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_dart_firing_pad", 6,11,1, "eob_ruins_dart_firing_pad_6_6_11_E")
spawn("eob_ruins_door_stone", 29,11,2, "eob_ruins_door_stone_6_29_11")
	:addPullChain()
spawn("eob_ruins_pit", 2,12,2, "eob_ruins_pit_6_2_12")
spawn("eob_ruins_dart_firing_pad", 4,12,3, "eob_ruins_dart_firing_pad_6_4_12_W")
spawn("eob_ruins_dart_firing_pad", 6,12,1, "eob_ruins_dart_firing_pad_6_6_12_E")
spawn("eob_ruins_pit", 8,12,2, "eob_ruins_pit_6_8_12")
spawn("eob_ruins_door_stone", 5,13,0, "eob_ruins_door_stone_6_5_13")
	:addPullChain()
spawn("eob_ruins_ceiling_shaft", 22,13,2, "eob_ruins_ceiling_shaft_6_22_13")
spawn("eob_ruins_dart_firing_pad", 28,13,3, "eob_ruins_dart_firing_pad_6_28_13_W")
spawn("eob_ruins_pressure_plate", 29,13,2, "eob_ruins_pressure_plate_6_29_13")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_dart_firing_pad", 30,13,1, "eob_ruins_dart_firing_pad_6_30_13_E")
spawn("eob_ruins_door_stone", 29,15,0, "eob_ruins_door_stone_6_29_15")
	:addPullChain()
spawn("eob_ruins_door_stone", 13,16,0, "eob_ruins_door_stone_6_13_16")
	:addPullChain()
spawn("eob_ruins_wall_text", 14,15,2, "eob_ruins_wall_text_6_14_15_S")
	:setWallText("")
spawn("eob_ruins_ornate_lock", 4,17,2, "eob_ruins_ornate_lock_6_4_17_S")
spawn("eob_ruins_stairs_down", 1,20,3, "eob_ruins_stairs_down_6_1_20_E")
spawn("eob_ruins_wall_text", 7,19,2, "eob_ruins_wall_text_6_7_19_S")
	:setWallText("")
spawn("eob_ruins_alcove", 11,21,2, "eob_ruins_alcove_6_11_21_S")
spawn("eob_ruins_alcove", 12,22,3, "eob_ruins_alcove_6_12_22_W")
spawn("eob_ruins_alcove", 11,23,0, "eob_ruins_alcove_6_11_23_N")
spawn("eob_ruins_alcove", 10,22,1, "eob_ruins_alcove_6_10_22_E")
spawn("eob_ruins_alcove", 12,21,2, "eob_ruins_alcove_6_12_21_S")
spawn("eob_ruins_alcove", 13,22,3, "eob_ruins_alcove_6_13_22_W")
spawn("eob_ruins_alcove", 12,23,0, "eob_ruins_alcove_6_12_23_N")
spawn("eob_ruins_alcove", 11,22,1, "eob_ruins_alcove_6_11_22_E")
spawn("eob_ruins_stairs_up", 16,22,3, "eob_ruins_stairs_up_6_16_22_E")
spawn("eob_ruins_door_stone", 18,22,1, "eob_ruins_door_stone_6_18_22")
	:addPullChain()
spawn("eob_ruins_door_stone", 22,22,0, "eob_ruins_door_stone_6_22_22")
spawn("eob_ruins_door_stone", 27,22,0, "eob_ruins_door_stone_6_27_22")
spawn("eob_ruins_dart_firing_pad", 2,23,3, "eob_ruins_dart_firing_pad_6_2_23_W")
spawn("eob_ruins_pressure_plate", 2,23,3, "eob_ruins_pressure_plate_6_2_23")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_pressure_plate", 7,23,2, "eob_ruins_pressure_plate_6_7_23")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_alcove", 11,22,2, "eob_ruins_alcove_6_11_22_S")
spawn("eob_ruins_alcove", 12,23,3, "eob_ruins_alcove_6_12_23_W")
spawn("eob_ruins_alcove", 11,24,0, "eob_ruins_alcove_6_11_24_N")
spawn("eob_ruins_alcove", 10,23,1, "eob_ruins_alcove_6_10_23_E")
spawn("eob_ruins_door_stone", 19,23,2, "eob_ruins_door_stone_6_19_23")
spawn("eob_ruins_alcove", 11,23,2, "eob_ruins_alcove_6_11_23_S")
spawn("eob_ruins_alcove", 12,24,3, "eob_ruins_alcove_6_12_24_W")
spawn("eob_ruins_alcove", 11,25,0, "eob_ruins_alcove_6_11_25_N")
spawn("eob_ruins_alcove", 10,24,1, "eob_ruins_alcove_6_10_24_E")
spawn("eob_ruins_ceiling_shaft", 20,24,1, "eob_ruins_ceiling_shaft_6_20_24")
spawn("eob_ruins_ceiling_shaft", 22,24,2, "eob_ruins_ceiling_shaft_6_22_24")
spawn("eob_ruins_ceiling_shaft", 23,24,2, "eob_ruins_ceiling_shaft_6_23_24")
spawn("eob_ruins_ceiling_shaft", 24,24,2, "eob_ruins_ceiling_shaft_6_24_24")
spawn("eob_ruins_pressure_plate", 2,25,2, "eob_ruins_pressure_plate_6_2_25")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_pressure_plate", 7,25,1, "eob_ruins_pressure_plate_6_7_25")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_ruins_dart_firing_pad", 7,25,1, "eob_ruins_dart_firing_pad_6_7_25_E")
spawn("eob_ruins_alcove", 11,24,2, "eob_ruins_alcove_6_11_24_S")
spawn("eob_ruins_alcove", 12,25,3, "eob_ruins_alcove_6_12_25_W")
spawn("eob_ruins_alcove", 11,26,0, "eob_ruins_alcove_6_11_26_N")
spawn("eob_ruins_alcove", 10,25,1, "eob_ruins_alcove_6_10_25_E")
spawn("eob_ruins_ceiling_shaft", 18,25,2, "eob_ruins_ceiling_shaft_6_18_25")
spawn("eob_ruins_ceiling_shaft", 19,25,2, "eob_ruins_ceiling_shaft_6_19_25")
spawn("eob_ruins_ceiling_shaft", 20,25,2, "eob_ruins_ceiling_shaft_6_20_25")
spawn("eob_ruins_ceiling_shaft", 22,25,2, "eob_ruins_ceiling_shaft_6_22_25")
spawn("eob_ruins_ceiling_shaft", 23,25,2, "eob_ruins_ceiling_shaft_6_23_25")
spawn("eob_ruins_ceiling_shaft", 24,25,2, "eob_ruins_ceiling_shaft_6_24_25")
spawn("eob_ruins_ceiling_shaft", 25,25,2, "eob_ruins_ceiling_shaft_6_25_25")
spawn("eob_ruins_ceiling_shaft", 27,25,2, "eob_ruins_ceiling_shaft_6_27_25")
spawn("eob_ruins_ceiling_shaft", 28,25,2, "eob_ruins_ceiling_shaft_6_28_25")
spawn("eob_ruins_ceiling_shaft", 29,25,2, "eob_ruins_ceiling_shaft_6_29_25")
spawn("eob_ruins_dart_firing_pad", 2,25,2, "eob_ruins_dart_firing_pad_6_2_25_S")
spawn("eob_ruins_alcove", 9,25,2, "eob_ruins_alcove_6_9_25_S")
spawn("eob_ruins_alcove", 10,26,3, "eob_ruins_alcove_6_10_26_W")
spawn("eob_ruins_alcove", 9,27,0, "eob_ruins_alcove_6_9_27_N")
spawn("eob_ruins_alcove", 8,26,1, "eob_ruins_alcove_6_8_26_E")
spawn("eob_ruins_alcove", 10,25,2, "eob_ruins_alcove_6_10_25_S")
spawn("eob_ruins_alcove", 11,26,3, "eob_ruins_alcove_6_11_26_W")
spawn("eob_ruins_alcove", 10,27,0, "eob_ruins_alcove_6_10_27_N")
spawn("eob_ruins_alcove", 9,26,1, "eob_ruins_alcove_6_9_26_E")
spawn("eob_ruins_alcove", 11,25,2, "eob_ruins_alcove_6_11_25_S")
spawn("eob_ruins_alcove", 12,26,3, "eob_ruins_alcove_6_12_26_W")
spawn("eob_ruins_alcove", 11,27,0, "eob_ruins_alcove_6_11_27_N")
spawn("eob_ruins_alcove", 10,26,1, "eob_ruins_alcove_6_10_26_E")
spawn("eob_ruins_ceiling_shaft", 15,26,2, "eob_ruins_ceiling_shaft_6_15_26")
spawn("eob_ruins_ceiling_shaft", 16,26,2, "eob_ruins_ceiling_shaft_6_16_26")
spawn("eob_ruins_ceiling_shaft", 17,26,2, "eob_ruins_ceiling_shaft_6_17_26")
spawn("eob_ruins_ceiling_shaft", 18,26,2, "eob_ruins_ceiling_shaft_6_18_26")
spawn("eob_ruins_ceiling_shaft", 22,26,2, "eob_ruins_ceiling_shaft_6_22_26")
spawn("eob_ruins_ceiling_shaft", 29,26,2, "eob_ruins_ceiling_shaft_6_29_26")
spawn("eob_ruins_alcove", 9,26,2, "eob_ruins_alcove_6_9_26_S")
spawn("eob_ruins_alcove", 10,27,3, "eob_ruins_alcove_6_10_27_W")
spawn("eob_ruins_alcove", 9,28,0, "eob_ruins_alcove_6_9_28_N")
spawn("eob_ruins_alcove", 8,27,1, "eob_ruins_alcove_6_8_27_E")
spawn("eob_ruins_alcove", 10,26,2, "eob_ruins_alcove_6_10_26_S")
spawn("eob_ruins_alcove", 11,27,3, "eob_ruins_alcove_6_11_27_W")
spawn("eob_ruins_alcove", 10,28,0, "eob_ruins_alcove_6_10_28_N")
spawn("eob_ruins_alcove", 9,27,1, "eob_ruins_alcove_6_9_27_E")
spawn("eob_ruins_alcove", 11,26,2, "eob_ruins_alcove_6_11_26_S")
spawn("eob_ruins_alcove", 12,27,3, "eob_ruins_alcove_6_12_27_W")
spawn("eob_ruins_alcove", 11,28,0, "eob_ruins_alcove_6_11_28_N")
spawn("eob_ruins_alcove", 10,27,1, "eob_ruins_alcove_6_10_27_E")
spawn("eob_ruins_ceiling_shaft", 20,27,3, "eob_ruins_ceiling_shaft_6_20_27")
spawn("eob_ruins_ceiling_shaft", 21,27,1, "eob_ruins_ceiling_shaft_6_21_27")
spawn("eob_ruins_ceiling_shaft", 22,27,2, "eob_ruins_ceiling_shaft_6_22_27")
spawn("eob_ruins_ceiling_shaft", 23,27,2, "eob_ruins_ceiling_shaft_6_23_27")
spawn("eob_ruins_ceiling_shaft", 29,27,2, "eob_ruins_ceiling_shaft_6_29_27")
spawn("eob_ruins_alcove", 2,28,1, "eob_ruins_alcove_6_2_28_E")
	:addItem(spawn("eob_dart_plus4_u"))
	:addItem(spawn("eob_dagger_u"))
spawn("eob_ruins_alcove", 9,27,2, "eob_ruins_alcove_6_9_27_S")
spawn("eob_ruins_alcove", 10,28,3, "eob_ruins_alcove_6_10_28_W")
spawn("eob_ruins_alcove", 9,29,0, "eob_ruins_alcove_6_9_29_N")
spawn("eob_ruins_alcove", 8,28,1, "eob_ruins_alcove_6_8_28_E")
spawn("eob_ruins_alcove", 10,27,2, "eob_ruins_alcove_6_10_27_S")
spawn("eob_ruins_alcove", 11,28,3, "eob_ruins_alcove_6_11_28_W")
spawn("eob_ruins_alcove", 10,29,0, "eob_ruins_alcove_6_10_29_N")
spawn("eob_ruins_alcove", 9,28,1, "eob_ruins_alcove_6_9_28_E")
spawn("eob_ruins_alcove", 11,27,2, "eob_ruins_alcove_6_11_27_S")
spawn("eob_ruins_alcove", 12,28,3, "eob_ruins_alcove_6_12_28_W")
spawn("eob_ruins_alcove", 11,29,0, "eob_ruins_alcove_6_11_29_N")
spawn("eob_ruins_alcove", 10,28,1, "eob_ruins_alcove_6_10_28_E")
spawn("eob_ruins_ceiling_shaft", 15,28,1, "eob_ruins_ceiling_shaft_6_15_28")
spawn("eob_ruins_ceiling_shaft", 16,28,1, "eob_ruins_ceiling_shaft_6_16_28")
spawn("eob_ruins_ceiling_shaft", 17,28,1, "eob_ruins_ceiling_shaft_6_17_28")
spawn("eob_ruins_ceiling_shaft", 20,28,2, "eob_ruins_ceiling_shaft_6_20_28")
spawn("eob_ruins_ceiling_shaft", 21,28,2, "eob_ruins_ceiling_shaft_6_21_28")
spawn("eob_ruins_ceiling_shaft", 29,28,2, "eob_ruins_ceiling_shaft_6_29_28")
spawn("eob_ruins_alcove", 6,28,2, "eob_ruins_alcove_6_6_28_S")
	:addItem(spawn("eob_wand_magic_missile_20_u"))
spawn("eob_ruins_alcove", 7,29,3, "eob_ruins_alcove_6_7_29_W")
	:addItem(spawn("eob_wand_magic_missile_20_u"))
spawn("eob_ruins_alcove", 6,30,0, "eob_ruins_alcove_6_6_30_N")
	:addItem(spawn("eob_wand_magic_missile_20_u"))
spawn("eob_ruins_alcove", 5,29,1, "eob_ruins_alcove_6_5_29_E")
	:addItem(spawn("eob_wand_magic_missile_20_u"))
spawn("eob_ruins_alcove", 7,28,2, "eob_ruins_alcove_6_7_28_S")
spawn("eob_ruins_alcove", 8,29,3, "eob_ruins_alcove_6_8_29_W")
spawn("eob_ruins_alcove", 7,30,0, "eob_ruins_alcove_6_7_30_N")
spawn("eob_ruins_alcove", 6,29,1, "eob_ruins_alcove_6_6_29_E")
spawn("eob_ruins_alcove", 8,28,2, "eob_ruins_alcove_6_8_28_S")
	:addItem(spawn("eob_key_dwarven_u"))
spawn("eob_ruins_alcove", 9,29,3, "eob_ruins_alcove_6_9_29_W")
	:addItem(spawn("eob_key_dwarven_u"))
spawn("eob_ruins_alcove", 8,30,0, "eob_ruins_alcove_6_8_30_N")
	:addItem(spawn("eob_key_dwarven_u"))
spawn("eob_ruins_alcove", 7,29,1, "eob_ruins_alcove_6_7_29_E")
	:addItem(spawn("eob_key_dwarven_u"))
spawn("eob_ruins_alcove", 9,28,2, "eob_ruins_alcove_6_9_28_S")
spawn("eob_ruins_alcove", 10,29,3, "eob_ruins_alcove_6_10_29_W")
spawn("eob_ruins_alcove", 9,30,0, "eob_ruins_alcove_6_9_30_N")
spawn("eob_ruins_alcove", 8,29,1, "eob_ruins_alcove_6_8_29_E")
spawn("eob_ruins_alcove", 10,28,2, "eob_ruins_alcove_6_10_28_S")
spawn("eob_ruins_alcove", 11,29,3, "eob_ruins_alcove_6_11_29_W")
spawn("eob_ruins_alcove", 10,30,0, "eob_ruins_alcove_6_10_30_N")
spawn("eob_ruins_alcove", 9,29,1, "eob_ruins_alcove_6_9_29_E")
spawn("eob_ruins_alcove", 11,28,2, "eob_ruins_alcove_6_11_28_S")
spawn("eob_ruins_alcove", 12,29,3, "eob_ruins_alcove_6_12_29_W")
spawn("eob_ruins_alcove", 11,30,0, "eob_ruins_alcove_6_11_30_N")
spawn("eob_ruins_alcove", 10,29,1, "eob_ruins_alcove_6_10_29_E")
spawn("eob_ruins_secret_button_tiny", 12,28,2, "eob_ruins_secret_button_tiny_6_12_28_S")
spawn("eob_ruins_ceiling_shaft", 17,29,2, "eob_ruins_ceiling_shaft_6_17_29")
spawn("eob_ruins_ceiling_shaft", 19,29,2, "eob_ruins_ceiling_shaft_6_19_29")
spawn("eob_ruins_ceiling_shaft", 20,29,2, "eob_ruins_ceiling_shaft_6_20_29")
spawn("eob_ruins_ceiling_shaft", 24,29,3, "eob_ruins_ceiling_shaft_6_24_29")
spawn("eob_ruins_ceiling_shaft", 25,29,1, "eob_ruins_ceiling_shaft_6_25_29")
spawn("eob_ruins_ceiling_shaft", 27,29,2, "eob_ruins_ceiling_shaft_6_27_29")
spawn("eob_ruins_ceiling_shaft", 28,29,1, "eob_ruins_ceiling_shaft_6_28_29")
spawn("eob_ruins_ceiling_shaft", 29,29,2, "eob_ruins_ceiling_shaft_6_29_29")
spawn("eob_ruins_wall_text", 5,30,1, "eob_ruins_wall_text_6_5_30_E")
	:setWallText("")
spawn("eob_ruins_wall_text", 8,29,2, "eob_ruins_wall_text_6_8_29_S")
	:setWallText("")
spawn("eob_ruins_alcove", 9,29,2, "eob_ruins_alcove_6_9_29_S")
spawn("eob_ruins_alcove", 10,30,3, "eob_ruins_alcove_6_10_30_W")
spawn("eob_ruins_alcove", 9,31,0, "eob_ruins_alcove_6_9_31_N")
spawn("eob_ruins_alcove", 8,30,1, "eob_ruins_alcove_6_8_30_E")
spawn("eob_ruins_alcove", 10,29,2, "eob_ruins_alcove_6_10_29_S")
spawn("eob_ruins_alcove", 11,30,3, "eob_ruins_alcove_6_11_30_W")
spawn("eob_ruins_alcove", 10,31,0, "eob_ruins_alcove_6_10_31_N")
spawn("eob_ruins_alcove", 9,30,1, "eob_ruins_alcove_6_9_30_E")
spawn("eob_ruins_alcove", 11,29,2, "eob_ruins_alcove_6_11_29_S")
spawn("eob_ruins_alcove", 12,30,3, "eob_ruins_alcove_6_12_30_W")
spawn("eob_ruins_alcove", 11,31,0, "eob_ruins_alcove_6_11_31_N")
spawn("eob_ruins_alcove", 10,30,1, "eob_ruins_alcove_6_10_30_E")
spawn("eob_ruins_secret_button_tiny", 19,30,3, "eob_ruins_secret_button_tiny_6_19_30_W")
spawn("eob_ruins_secret_button_tiny", 17,30,1, "eob_ruins_secret_button_tiny_6_17_30_E")
spawn("eob_ruins_ceiling_shaft", 20,30,2, "eob_ruins_ceiling_shaft_6_20_30")
spawn("eob_ruins_ceiling_shaft", 21,30,2, "eob_ruins_ceiling_shaft_6_21_30")
spawn("eob_egg_30_u", 21,5,2, "eob_egg_30_u_1")
spawn("eob_rock_u", 13,13,0, "eob_rock_u_15")
spawn("eob_shield_dwarven_u", 9,25,0, "eob_shield_dwarven_u_1")
spawn("eob_egg_30_u", 19,5,0, "eob_egg_30_u_2")
spawn("eob_key_dwarven_u", 1,6,0, "eob_key_dwarven_u_6")
spawn("eob_rock_u", 17,25,0, "eob_rock_u_16")
spawn("eob_key_u", 19,22,0, "eob_key_u_3")
spawn("eob_potion_extra_healing", 27,15,1, "eob_potion_extra_healing_3")
spawn("eob_egg_20_u", 11,5,3, "eob_egg_20_u_1")
spawn("eob_egg_40_u", 15,5,0, "eob_egg_40_u_1")
spawn("eob_halberd_chieftain_u", 14,18,2, "eob_halberd_chieftain_u_1")
spawn("eob_egg_20_u", 17,5,3, "eob_egg_20_u_2")
spawn("eob_mage_scroll_hold_person", 27,15,3, "eob_mage_scroll_hold_person_1")
spawn("eob_egg_10_u", 17,18,1, "eob_egg_10_u_1")
spawn("eob_egg_10_u", 16,5,2, "eob_egg_10_u_2")
spawn("eob_stone_ring_u", 17,11,2, "eob_stone_ring_u_1")
spawn("eob_cleric_scroll_flame_blade", 22,30,1, "eob_cleric_scroll_flame_blade_2")
spawn("eob_ring2_u", 15,29,0, "eob_ring2_u_2")
spawn("eob_bracers_u", 26,28,0, "eob_bracers_u_1")
spawn("eob_egg_30_u", 15,4,2, "eob_egg_30_u_3")
spawn("eob_cleric_scroll_dispel_magic", 14,20,2, "eob_cleric_scroll_dispel_magic_1")
spawn("eob_mace_plus3", 12,28,3, "eob_mace_plus3_1")
spawn("eob_cleric_scroll_cure_serious_wnds", 14,20,1, "eob_cleric_scroll_cure_serious_wnds_1")
spawn("eob_egg_20_u", 15,5,3, "eob_egg_20_u_3")
spawn("eob_egg_40_u", 29,8,3, "eob_egg_40_u_2")
spawn("eob_key_dwarven_u", 7,6,0, "eob_key_dwarven_u_7")
spawn("eob_kenku1_1", 15,15,0, "eob_kenku1_1_1")
spawn("eob_kenku1_2", 15,5,0, "eob_kenku1_2_1")
spawn("eob_kenku1_1", 13,3,0, "eob_kenku1_1_2")
spawn("eob_kenku1_2", 14,7,0, "eob_kenku1_2_2")
spawn("eob_kenku1_1", 23,7,0, "eob_kenku1_1_3")
spawn("eob_kenku1_2", 20,12,0, "eob_kenku1_2_3")
spawn("eob_kenku1_2", 3,18,0, "eob_kenku1_2_4")
spawn("eob_kenku1_2", 30,4,0, "eob_kenku1_2_5")
spawn("eob_kenku1_2", 21,5,0, "eob_kenku1_2_6")
spawn("eob_kenku1_1", 13,5,0, "eob_kenku1_1_4")
spawn("eob_kenku2_1_group", 13,17,0, "eob_kenku2_1_group_1")
spawn("eob_kenku1_1", 19,5,0, "eob_kenku1_1_5")
spawn("eob_kenku1_1", 16,8,0, "eob_kenku1_1_6")
spawn("eob_kenku1_2", 16,13,0, "eob_kenku1_2_7")
spawn("eob_kenku1_2", 5,15,0, "eob_kenku1_2_8")
spawn("eob_kenku1_2", 16,4,0, "eob_kenku1_2_9")
spawn("eob_kenku1_1", 21,3,0, "eob_kenku1_1_7")
spawn("eob_kenku1_1", 30,7,0, "eob_kenku1_1_8")
spawn("eob_kenku1_1", 30,24,0, "eob_kenku1_1_9")
spawn("eob_kenku1_2", 30,1,0, "eob_kenku1_2_10")
spawn("eob_kenku1_2", 9,14,0, "eob_kenku1_2_11")
spawn("eob_kenku1_2", 14,28,0, "eob_kenku1_2_12")
spawn("eob_kenku1_1", 11,11,0, "eob_kenku1_1_10")
spawn("eob_kenku1_1", 19,30,0, "eob_kenku1_1_11")
spawn("eob_kenku1_2", 12,5,0, "eob_kenku1_2_13")
spawn("eob_kenku1_1", 17,4,0, "eob_kenku1_1_12")
spawn("eob_kenku1_1", 11,5,0, "eob_kenku1_1_13")

--- level 7 ---

mapName("Upper Reaches of The Drow")
setWallSet("prison")
playStream("assets/samples/music/prison_ambient.ogg")
mapDesc([[
################################
#......#...##........###########
#..###.#.#.##.#.####.#......####
#..###...#.#..#.#..#.#..###.####
######.###.#.#..#....#....#...##
##.....#.#...#..#..#.#..#.#.####
##.#.#.#.###########.#..#.#.####
#..#.#.#.............####.#....#
#..#.#.#.###.####.####..#..#.###
#..#.....#.#.###...##...#..#...#
#.##.###.#.#...#.#....####.#.###
#.#..#...#..####...###.....#...#
#.#..#...##......##....###..#..#
#.#######...####....###...#.####
#.#...###.#.########....#.#....#
#.#...###.#..#...########.###..#
#.#.......#..#.#.#...#.##.##.###
#.####.##.####...#.###.##..#.###
#......##...####...#.#.##....###
#.##......##########.#.######.##
#.##.#.##.##....#....#.#.......#
####.#.##...####..##.#.#.#.#.###
#....#..##.####..###.#.#.#.#.###
####.##.##.#....#.#.##.##.#.####
#..........#.####.#.#...#.#.####
#.######.###.#......#...#......#
#..#.#...#...####.#.#...#.#.####
##.#.#.###.######.#.#####.#.####
#..#.#.#...#...######...########
#.##.#.###.#...#######.#########
#........#.............#########
################################
]])
spawn("eob_drow_door", 24,2,3, "eob_drow_door_7_24_2")
	:addPullChain()
spawn("eob_drow_fireball_firing_pad", 25,4,0, "eob_drow_fireball_firing_pad_7_25_4_N")
spawn("eob_drow_wall_text", 2,5,0, "eob_drow_wall_text_7_2_5_N")
	:setWallText("")
spawn("eob_drow_fireball_firing_pad", 4,5,0, "eob_drow_fireball_firing_pad_7_4_5_N")
spawn("eob_drow_door", 19,4,1, "eob_drow_door_7_19_4")
	:addPullChain()
spawn("eob_drow_door", 28,4,3, "eob_drow_door_7_28_4")
spawn("eob_drow_pressure_plate", 4,5,1, "eob_drow_pressure_plate_7_4_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 6,5,2, "eob_drow_pressure_plate_7_6_5")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_door", 13,7,3, "eob_drow_door_7_13_7")
	:addPullChain()
spawn("eob_drow_door", 29,7,3, "eob_drow_door_7_29_7")
spawn("eob_drow_pit", 26,8,1, "eob_drow_pit_7_26_8")
spawn("eob_drow_pressure_plate", 4,9,2, "eob_drow_pressure_plate_7_4_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 6,9,2, "eob_drow_pressure_plate_7_6_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_lock_spider", 12,9,1, "eob_drow_lock_spider_7_12_9_E")
spawn("eob_drow_pit", 26,9,2, "eob_drow_pit_7_26_9")
spawn("eob_drow_door", 29,9,3, "eob_drow_door_7_29_9")
spawn("eob_drow_door", 13,10,3, "eob_drow_door_7_13_10")
spawn("eob_drow_stairs_up", 14,10,1, "eob_drow_stairs_up_7_14_10_W")
spawn("eob_drow_button", 26,10,3, "eob_drow_button_7_26_10_W")
spawn("eob_drow_pressure_plate", 29,11,1, "eob_drow_pressure_plate_7_29_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_lock_spider", 11,13,1, "eob_drow_lock_spider_7_11_13_E")
spawn("eob_drow_button", 20,14,0, "eob_drow_button_7_20_14_N")
spawn("eob_drow_wall_text", 22,14,0, "eob_drow_wall_text_7_22_14_N")
	:setWallText("")
spawn("eob_drow_door", 11,14,0, "eob_drow_door_7_11_14")
spawn("eob_drow_wall_text", 14,15,0, "eob_drow_wall_text_7_14_15_N")
	:setWallText("")
spawn("eob_drow_alcove", 20,14,3, "eob_drow_alcove_7_20_14_W")
spawn("eob_drow_door", 21,14,1, "eob_drow_door_7_21_14")
	:addPullChain()
spawn("eob_drow_pit", 16,15,1, "eob_drow_pit_7_16_15")
spawn("eob_drow_stairs_down", 22,16,0, "eob_drow_stairs_down_7_22_16_S")
spawn("eob_drow_door", 25,16,2, "eob_drow_door_7_25_16")
	:addPullChain()
spawn("eob_drow_stairs_down", 28,16,0, "eob_drow_stairs_down_7_28_16_S")
spawn("eob_drow_wall_text", 22,17,3, "eob_drow_wall_text_7_22_17_W")
	:setWallText("")
spawn("eob_drow_stairs_down", 11,18,1, "eob_drow_stairs_down_7_11_18")
spawn("eob_drow_wall_text", 22,18,1, "eob_drow_wall_text_7_22_18_E")
	:setWallText("")
spawn("eob_drow_door", 27,18,1, "eob_drow_door_7_27_18")
	:addPullChain()
spawn("eob_drow_wall_text", 18,20,0, "eob_drow_wall_text_7_18_20_N")
	:setWallText("")
spawn("eob_drow_door", 20,19,2, "eob_drow_door_7_20_19")
spawn("eob_drow_door", 22,19,0, "eob_drow_door_7_22_19")
	:addPullChain()
spawn("eob_drow_wall_text", 24,20,0, "eob_drow_wall_text_7_24_20_N")
	:setWallText("")
spawn("eob_drow_wall_text", 26,20,0, "eob_drow_wall_text_7_26_20_N")
	:setWallText("")
spawn("eob_drow_wall_text", 28,18,2, "eob_drow_wall_text_7_28_18_S")
	:setWallText("")
spawn("eob_drow_wall_text", 28,20,0, "eob_drow_wall_text_7_28_20_N")
	:setWallText("")
spawn("eob_drow_stairs_up", 1,20,2, "eob_drow_stairs_up_7_1_20_N")
spawn("eob_drow_stairs_down", 12,20,3, "eob_drow_stairs_down_7_12_20")
spawn("eob_drow_door", 14,20,3, "eob_drow_door_7_14_20")
spawn("eob_drow_stairs_down", 15,20,1, "eob_drow_stairs_down_7_15_20")
spawn("eob_teleporter", 30,20,1, "eob_teleporter_7_30_20_W")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_lock_spider", 13,20,2, "eob_drow_lock_spider_7_13_20_S")
spawn("eob_drow_door", 20,21,0, "eob_drow_door_7_20_21")
spawn("eob_drow_door", 24,21,0, "eob_drow_door_7_24_21")
spawn("eob_drow_lever", 25,20,2, "eob_drow_lever_7_25_20_S")
spawn("eob_drow_door", 26,21,0, "eob_drow_door_7_26_21")
spawn("eob_drow_lever", 27,20,2, "eob_drow_lever_7_27_20_S")
spawn("eob_drow_door", 28,21,0, "eob_drow_door_7_28_21")
spawn("eob_drow_lever", 29,20,2, "eob_drow_lever_7_29_20_S")
spawn("eob_teleporter", 20,22,2, "eob_teleporter_7_20_22_N")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_wall_text", 22,22,1, "eob_drow_wall_text_7_22_22_E")
	:setWallText("")
spawn("eob_drow_door", 22,23,0, "eob_drow_door_7_22_23")
	:addPullChain()
spawn("eob_drow_wall_text", 13,23,2, "eob_drow_wall_text_7_13_23_S")
	:setWallText("")
spawn("eob_drow_button", 16,25,0, "eob_drow_button_7_16_25_N")
spawn("eob_drow_door", 17,24,2, "eob_drow_door_7_17_24")
spawn("eob_drow_button", 18,25,0, "eob_drow_button_7_18_25_N")
spawn("eob_drow_door", 19,24,2, "eob_drow_door_7_19_24")
spawn("eob_drow_button", 20,25,0, "eob_drow_button_7_20_25_N")
spawn("eob_drow_button", 24,25,0, "eob_drow_button_7_24_25_N")
spawn("eob_drow_door", 25,24,2, "eob_drow_door_7_25_24")
spawn("eob_drow_button", 26,25,0, "eob_drow_button_7_26_25_N")
spawn("eob_drow_door", 27,24,2, "eob_drow_door_7_27_24")
spawn("eob_drow_door", 15,25,1, "eob_drow_door_7_15_25")
spawn("eob_drow_door", 29,25,3, "eob_drow_door_7_29_25")
spawn("eob_drow_fireball_firing_pad", 4,26,3, "eob_drow_fireball_firing_pad_7_4_26_W")
spawn("eob_drow_fireball_firing_pad", 4,26,1, "eob_drow_fireball_firing_pad_7_4_26_E")
spawn("eob_drow_door", 17,26,0, "eob_drow_door_7_17_26")
spawn("eob_drow_button", 18,25,2, "eob_drow_button_7_18_25_S")
spawn("eob_drow_door", 19,26,0, "eob_drow_door_7_19_26")
spawn("eob_drow_button", 20,25,2, "eob_drow_button_7_20_25_S")
spawn("eob_drow_button", 24,25,2, "eob_drow_button_7_24_25_S")
spawn("eob_drow_door", 25,26,0, "eob_drow_door_7_25_26")
spawn("eob_drow_button", 26,25,2, "eob_drow_button_7_26_25_S")
spawn("eob_drow_door", 27,26,0, "eob_drow_door_7_27_26")
spawn("eob_drow_button", 28,25,2, "eob_drow_button_7_28_25_S")
spawn("eob_drow_fireball_firing_pad", 4,27,3, "eob_drow_fireball_firing_pad_7_4_27_W")
spawn("eob_drow_fireball_firing_pad", 4,27,1, "eob_drow_fireball_firing_pad_7_4_27_E")
spawn("eob_drow_door", 10,27,0, "eob_drow_door_7_10_27")
spawn("eob_drow_portal_necklace", 12,28,0, "eob_drow_portal_necklace_7_12_28_N")
spawn("eob_drow_portal_dagger", 13,28,0, "eob_drow_portal_dagger_7_13_28_N")
spawn("eob_drow_portal_amulet", 14,28,0, "eob_drow_portal_amulet_7_14_28_N")
spawn("eob_drow_button", 22,26,2, "eob_drow_button_7_22_26_S")
spawn("eob_drow_fireball_firing_pad", 4,28,3, "eob_drow_fireball_firing_pad_7_4_28_W")
spawn("eob_drow_fireball_firing_pad", 4,28,1, "eob_drow_fireball_firing_pad_7_4_28_E")
spawn("eob_drow_stairs_down", 8,28,3, "eob_drow_stairs_down_7_8_28_E")
spawn("eob_drow_portal_cross", 12,28,3, "eob_drow_portal_cross_7_12_28_W")
spawn("eob_drow_portal_gem", 14,28,1, "eob_drow_portal_gem_7_14_28_E")
spawn("eob_drow_door", 4,29,2, "eob_drow_door_7_4_29")
	:addPullChain()
spawn("eob_drow_door", 10,29,2, "eob_drow_door_7_10_29")
spawn("eob_drow_lock_ornate", 11,30,0, "eob_drow_lock_ornate_7_11_30_N")
spawn("eob_drow_door", 15,30,1, "eob_drow_door_7_15_30")
spawn("eob_drow_door", 17,30,1, "eob_drow_door_7_17_30")
spawn("eob_drow_door", 19,30,1, "eob_drow_door_7_19_30")
spawn("eob_drow_door", 21,30,1, "eob_drow_door_7_21_30")
spawn("eob_drow_alcove", 12,30,2, "eob_drow_alcove_7_12_30_S")
	:addItem(spawn("eob_rock_glowing_u"))
spawn("eob_drow_alcove", 13,30,2, "eob_drow_alcove_7_13_30_S")
	:addItem(spawn("eob_wand_u"))
spawn("eob_drow_alcove", 14,30,2, "eob_drow_alcove_7_14_30_S")
spawn("eob_drow_lock_ornate", 16,30,2, "eob_drow_lock_ornate_7_16_30_S")
spawn("eob_drow_lock_ornate", 18,30,2, "eob_drow_lock_ornate_7_18_30_S")
spawn("eob_drow_lock_ornate", 20,30,2, "eob_drow_lock_ornate_7_20_30_S")
spawn("eob_drow_lock_ornate", 22,30,2, "eob_drow_lock_ornate_7_22_30_S")
spawn("eob_banded_armor_u", 25,23,0, "eob_banded_armor_u_1")
spawn("eob_bones_human_ileria_u", 29,4,1, "eob_bones_human_ileria_u_1")
spawn("eob_potion_healing", 4,26,0, "eob_potion_healing_7")
spawn("eob_arrow_u", 27,23,0, "eob_arrow_u_13")
spawn("eob_arrow_u", 12,16,2, "eob_arrow_u_14")
spawn("eob_key_jeweled_u", 19,23,0, "eob_key_jeweled_u_1")
spawn("eob_short_sword_slicer", 24,22,2, "eob_short_sword_slicer_1")
spawn("eob_shield_u", 30,14,3, "eob_shield_u_5")
spawn("eob_cleric_scroll_cure_light_wnds", 19,27,2, "eob_cleric_scroll_cure_light_wnds_1")
spawn("eob_mage_scroll_lightning_bolt", 30,25,1, "eob_mage_scroll_lightning_bolt_1")
spawn("eob_key_drow_u", 17,27,3, "eob_key_drow_u_1")
spawn("eob_cleric_scroll_remove_paralysis", 30,11,0, "eob_cleric_scroll_remove_paralysis_1")
spawn("eob_cleric_scroll_bless", 17,5,3, "eob_cleric_scroll_bless_1")
spawn("eob_ring_protection2_u", 14,15,3, "eob_ring_protection2_u_1")
spawn("eob_cleric_scroll_protect_evil10", 30,11,1, "eob_cleric_scroll_protect_evil10_1")
spawn("eob_key_jeweled_u", 25,27,2, "eob_key_jeweled_u_2")
spawn("eob_ring2_wizardry_u", 28,22,2, "eob_ring2_wizardry_u_1")
spawn("eob_cleric_scroll_create_food", 6,12,3, "eob_cleric_scroll_create_food_1")
spawn("eob_key_u", 4,26,1, "eob_key_u_4")
spawn("eob_mage_scroll_fireball", 2,3,2, "eob_mage_scroll_fireball_2")
spawn("eob_arrow_u", 7,22,1, "eob_arrow_u_15")
spawn("eob_medallion_luck_stone_u", 3,14,0, "eob_medallion_luck_stone_u_1")
spawn("eob_key_u", 30,12,2, "eob_key_u_5")
spawn("eob_bracers_defense3_u", 26,22,2, "eob_bracers_defense3_u_1")
spawn("eob_cleric_scroll_slow_poison", 3,12,3, "eob_cleric_scroll_slow_poison_2")
spawn("eob_medallion_of_adornment_u", 17,5,3, "eob_medallion_of_adornment_u_2")
spawn("eob_arrow_u", 12,16,3, "eob_arrow_u_16")
spawn("eob_arrow_u", 12,16,1, "eob_arrow_u_17")
spawn("eob_arrow_u", 27,23,1, "eob_arrow_u_18")
spawn("eob_rations_iron_u", 17,5,3, "eob_rations_iron_u_9")
spawn("eob_key_drow_u", 14,25,0, "eob_key_drow_u_2")
spawn("eob_arrow_u", 27,23,3, "eob_arrow_u_19")
spawn("eob_mage_scroll_fear", 17,23,0, "eob_mage_scroll_fear_1")
spawn("eob_arrow_u", 22,8,0, "eob_arrow_u_20")
spawn("eob_key_ruby_u", 27,27,2, "eob_key_ruby_u_1")
spawn("eob_holy_symbol", 29,4,1, "eob_holy_symbol_1")
spawn("eob_skelwar2_1_group", 27,27,0, "eob_skelwar2_1_group_1")
spawn("eob_skelwar1_1", 19,27,0, "eob_skelwar1_1_1")
spawn("eob_skelwar1_2", 27,23,0, "eob_skelwar1_2_1")
spawn("eob_drowelf1_1", 3,16,0, "eob_drowelf1_1_1")
spawn("eob_skelwar1_1", 29,4,0, "eob_skelwar1_1_2")
spawn("eob_drowelf1_1", 3,15,0, "eob_drowelf1_1_2")
spawn("eob_skelwar2_1_group", 20,18,0, "eob_skelwar2_1_group_2")
spawn("eob_skelwar1_2", 30,9,0, "eob_skelwar1_2_2")
spawn("eob_drowelf1_1", 6,2,0, "eob_drowelf1_1_3")
spawn("eob_skelwar2_2_group", 30,25,0, "eob_skelwar2_2_group_1")
spawn("eob_skelwar1_1", 30,7,0, "eob_skelwar1_1_3")
spawn("eob_drowelf2_1_group", 2,2,0, "eob_drowelf2_1_group_1")
spawn("eob_skelwar1_2", 17,27,0, "eob_skelwar1_2_3")
spawn("eob_drowelf1_1", 7,11,0, "eob_drowelf1_1_4")
spawn("eob_drowelf1_1", 7,12,0, "eob_drowelf1_1_5")
spawn("eob_drowelf2_1_group", 1,18,0, "eob_drowelf2_1_group_2")
spawn("eob_drowelf1_1", 3,14,0, "eob_drowelf1_1_6")
spawn("eob_drowelf2_1_group", 1,17,0, "eob_drowelf2_1_group_3")
spawn("eob_skelwar1_1", 17,23,0, "eob_skelwar1_1_4")
spawn("eob_drowelf1_1", 17,4,0, "eob_drowelf1_1_7")
spawn("eob_skelwar1_1", 26,18,0, "eob_skelwar1_1_5")
spawn("eob_skelwar1_1", 25,23,0, "eob_skelwar1_1_6")
spawn("eob_skelwar1_1", 14,25,0, "eob_skelwar1_1_7")

--- level 8 ---

mapName("Drow Outcasts")
setWallSet("prison")
playStream("assets/samples/music/prison_ambient.ogg")
mapDesc([[
################################
#####..........................#
######.#.#.#.##.##.##.########.#
######.#.#.#.#...#.##........#.#
#...#........#.#.#...###.....#.#
#...##########.#.#############.#
#.###..........#............#..#
#.#.....######.#.###.#.##...#..#
#.#.##.#.##..#.#.#.#.#..#...#..#
#.#.#.....#..#.....#.##.#...#..#
#.#.##.#.###########..#.########
#.#.#.....#...........#........#
#.#.#.#.#.#.#############.##...#
#.#.#.....#.#...##...###...#...#
#.#.#####.#.#...#.##.###...#...#
#...#...###.#.##..###.########.#
##.##...##..#...##.##.#......#.#
#..###.###.####.##.#..###.####.#
#..#.....#.#.......##.#.....#..#
##.#.....#.###.###...##.....#..#
##..##.###.###.#.###.###.#.##..#
##..##.....#####.####.##...##..#
##.###.###.##.##....#.####.###.#
#..#.#.#.#....#...##...#...#.#.#
#..#.....#..#.#.####.#.#####.#.#
##.###.######.#........##....#.#
##............################.#
######.###.###..........##.....#
#....#...#.###...######....#.#.#
#.##.#####.#..####......##.#.#.#
#..........#........######.....#
################################
]])
spawn("eob_drow_button", 5,1,3, "eob_drow_button_8_5_1_W")
spawn("eob_drow_door", 23,1,1, "eob_drow_door_8_23_1")
	:addPullChain()
spawn("eob_drow_door", 6,2,0, "eob_drow_door_8_6_2")
spawn("eob_drow_door", 8,2,0, "eob_drow_door_8_8_2")
spawn("eob_drow_door", 10,2,0, "eob_drow_door_8_10_2")
spawn("eob_drow_door", 12,2,0, "eob_drow_door_8_12_2")
spawn("eob_drow_door", 15,2,0, "eob_drow_door_8_15_2")
	:addPullChain()
spawn("eob_drow_dart_firing_pad", 24,3,0, "eob_drow_dart_firing_pad_8_24_3_N")
spawn("eob_drow_dart_firing_pad", 25,3,0, "eob_drow_dart_firing_pad_8_25_3_N")
spawn("eob_drow_dart_firing_pad", 26,3,0, "eob_drow_dart_firing_pad_8_26_3_N")
spawn("eob_drow_dart_firing_pad", 27,3,0, "eob_drow_dart_firing_pad_8_27_3_N")
spawn("eob_drow_dart_firing_pad", 28,3,0, "eob_drow_dart_firing_pad_8_28_3_N")
spawn("eob_drow_door", 23,3,1, "eob_drow_door_8_23_3")
	:addPullChain()
spawn("eob_drow_pressure_plate", 24,3,1, "eob_drow_pressure_plate_8_24_3")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_dart_firing_pad", 28,3,1, "eob_drow_dart_firing_pad_8_28_3_E")
spawn("eob_drow_stairs_down", 20,4,1, "eob_drow_stairs_down_8_20_4_W")
spawn("eob_drow_dart_firing_pad", 28,4,1, "eob_drow_dart_firing_pad_8_28_4_E")
spawn("eob_drow_alcove", 3,5,1, "eob_drow_alcove_8_3_5_E")
	:addItem(spawn("eob_ring2_sustenance_u"))
spawn("eob_drow_dart_firing_pad", 24,4,2, "eob_drow_dart_firing_pad_8_24_4_S")
spawn("eob_drow_dart_firing_pad", 25,4,2, "eob_drow_dart_firing_pad_8_25_4_S")
spawn("eob_drow_dart_firing_pad", 26,4,2, "eob_drow_dart_firing_pad_8_26_4_S")
spawn("eob_drow_dart_firing_pad", 27,4,2, "eob_drow_dart_firing_pad_8_27_4_S")
spawn("eob_drow_dart_firing_pad", 28,4,2, "eob_drow_dart_firing_pad_8_28_4_S")
spawn("eob_drow_wall_text", 16,6,3, "eob_drow_wall_text_8_16_6_W")
	:setWallText("")
spawn("eob_drow_wall_text", 14,6,1, "eob_drow_wall_text_8_14_6_E")
	:setWallText("")
spawn("eob_drow_door", 19,6,1, "eob_drow_door_8_19_6")
spawn("eob_drow_door", 24,6,1, "eob_drow_door_8_24_6")
	:addPullChain()
spawn("eob_teleporter", 27,6,1, "eob_teleporter_8_27_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_button", 11,8,0, "eob_drow_button_8_11_8_N")
spawn("eob_drow_door", 6,8,0, "eob_drow_door_8_6_8")
	:addPullChain()
spawn("eob_drow_ceiling_shaft", 26,8,2, "eob_drow_ceiling_shaft_8_26_8")
spawn("eob_drow_pressure_plate", 6,9,2, "eob_drow_pressure_plate_8_6_9")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_wall_illusion", 18,9,3, "eob_drow_wall_illusion_8_18_9_W")
spawn("eob_drow_wall_illusion", 16,9,1, "eob_drow_wall_illusion_8_16_9_E")
spawn("eob_drow_ceiling_shaft", 26,9,2, "eob_drow_ceiling_shaft_8_26_9")
spawn("eob_drow_secret_button_tiny", 9,9,2, "eob_drow_secret_button_tiny_8_9_9_S")
spawn("eob_drow_pressure_plate", 28,11,1, "eob_drow_pressure_plate_8_28_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pit", 29,11,1, "eob_drow_pit_8_29_11")
spawn("eob_drow_button", 30,11,1, "eob_drow_button_8_30_11_E")
spawn("eob_drow_door", 25,12,0, "eob_drow_door_8_25_12")
	:addPullChain()
spawn("eob_drow_pressure_plate", 28,12,2, "eob_drow_pressure_plate_8_28_12")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pit", 29,12,2, "eob_drow_pit_8_29_12")
spawn("eob_drow_button", 30,12,1, "eob_drow_button_8_30_12_E")
spawn("eob_drow_stairs_down", 18,13,3, "eob_drow_stairs_down_8_18_13_E")
spawn("eob_drow_pressure_plate", 28,13,2, "eob_drow_pressure_plate_8_28_13")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pit", 29,13,2, "eob_drow_pit_8_29_13")
spawn("eob_drow_button", 30,13,1, "eob_drow_button_8_30_13_E")
spawn("eob_drow_fireball_firing_pad", 2,15,0, "eob_drow_fireball_firing_pad_8_2_15_N")
spawn("eob_drow_portal_scepter", 6,15,0, "eob_drow_portal_scepter_8_6_15_N")
spawn("eob_teleporter", 17,14,0, "eob_teleporter_8_17_14")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 28,14,2, "eob_drow_pressure_plate_8_28_14")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pit", 29,14,2, "eob_drow_pit_8_29_14")
spawn("eob_drow_button", 30,14,1, "eob_drow_button_8_30_14_E")
spawn("eob_blocker", 1,15,2, "eob_blocker_8_1_15")
spawn("eob_blocker", 3,15,2, "eob_blocker_8_3_15")
spawn("eob_drow_door", 13,15,0, "eob_drow_door_8_13_15")
spawn("eob_drow_ceiling_shaft", 16,15,3, "eob_drow_ceiling_shaft_8_16_15")
spawn("eob_drow_wall_text", 17,15,1, "eob_drow_wall_text_8_17_15_E")
	:setWallText("")
spawn("eob_drow_lock_spider", 13,16,3, "eob_drow_lock_spider_8_13_16_W")
spawn("eob_drow_stairs_down", 18,16,0, "eob_drow_stairs_down_8_18_16_S")
spawn("eob_drow_door", 21,16,2, "eob_drow_door_8_21_16")
spawn("eob_drow_stairs_up", 23,16,3, "eob_drow_stairs_up_8_23_16_E")
spawn("eob_drow_stairs_up", 28,16,1, "eob_drow_stairs_up_8_28_16_W")
spawn("eob_drow_pit", 1,17,3, "eob_drow_pit_8_1_17")
spawn("eob_drow_door", 6,17,0, "eob_drow_door_8_6_17")
	:addPullChain()
spawn("eob_drow_wall_illusion_with_spider", 15,16,2, "eob_drow_wall_illusion_with_spider_8_15_16_S")
spawn("eob_drow_wall_illusion_with_spider", 15,18,0, "eob_drow_wall_illusion_with_spider_8_15_18_N")
spawn("eob_drow_lock_gem", 24,18,0, "eob_drow_lock_gem_8_24_18_N")
spawn("eob_drow_door", 25,17,0, "eob_drow_door_8_25_17")
spawn("eob_drow_stairs_up", 12,18,3, "eob_drow_stairs_up_8_12_18_E")
spawn("eob_teleporter", 21,18,2, "eob_teleporter_8_21_18")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_button", 27,18,1, "eob_drow_button_8_27_18_E")
spawn("eob_drow_alcove", 27,19,1, "eob_drow_alcove_8_27_19_E")
spawn("eob_drow_door", 6,20,0, "eob_drow_door_8_6_20")
	:addPullChain()
spawn("eob_drow_stairs_up", 14,20,2, "eob_drow_stairs_up_8_14_20_N")
spawn("eob_drow_stairs_up", 16,20,0, "eob_drow_stairs_up_8_16_20")
spawn("eob_drow_wall_text", 25,19,2, "eob_drow_wall_text_8_25_19_S")
	:setWallText("")
spawn("eob_drow_portal_scepter", 29,20,3, "eob_drow_portal_scepter_8_29_20_W")
spawn("eob_drow_pit", 3,21,2, "eob_drow_pit_8_3_21")
spawn("eob_drow_stairs_down", 19,22,1, "eob_drow_stairs_down_8_19_22")
spawn("eob_drow_door", 21,22,2, "eob_drow_door_8_21_22")
spawn("eob_drow_alcove", 29,21,2, "eob_drow_alcove_8_29_21_S")
	:addItem(spawn("eob_wand_lightning_bolt_10_u"))
spawn("eob_drow_stairs_down", 24,23,3, "eob_drow_stairs_down_8_24_23_E")
spawn("eob_drow_door", 5,24,1, "eob_drow_door_8_5_24")
	:addPullChain()
spawn("eob_drow_door", 7,24,3, "eob_drow_door_8_7_24")
	:addPullChain()
spawn("eob_drow_secret_button_tiny", 25,23,2, "eob_drow_secret_button_tiny_8_25_23_S")
spawn("eob_drow_wall_illusion_with_spider", 28,23,2, "eob_drow_wall_illusion_with_spider_8_28_23_S")
spawn("eob_drow_wall_illusion_with_spider", 28,25,0, "eob_drow_wall_illusion_with_spider_8_28_25_N")
spawn("eob_drow_door", 2,25,0, "eob_drow_door_8_2_25")
spawn("eob_drow_button", 2,26,3, "eob_drow_button_8_2_26_W")
spawn("eob_drow_door", 3,26,1, "eob_drow_door_8_3_26")
	:addPullChain()
spawn("eob_drow_door", 4,26,1, "eob_drow_door_8_4_26")
	:addPullChain()
spawn("eob_drow_door", 5,26,1, "eob_drow_door_8_5_26")
	:addPullChain()
spawn("eob_drow_door", 30,26,2, "eob_drow_door_8_30_26")
	:addPullChain()
spawn("eob_drow_fireball_firing_pad", 2,26,2, "eob_drow_fireball_firing_pad_8_2_26_S")
spawn("eob_drow_pressure_plate", 21,27,1, "eob_drow_pressure_plate_8_21_27")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_door", 22,27,1, "eob_drow_door_8_22_27")
	:addPullChain()
spawn("eob_drow_stairs_up", 8,28,1, "eob_drow_stairs_up_8_8_28_W")
spawn("eob_drow_door", 25,28,1, "eob_drow_door_8_25_28")
	:addPullChain()
spawn("eob_drow_pressure_plate", 21,29,1, "eob_drow_pressure_plate_8_21_29")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_door", 22,29,1, "eob_drow_door_8_22_29")
	:addPullChain()
spawn("eob_drow_door", 5,30,3, "eob_drow_door_8_5_30")
	:addPullChain()
spawn("eob_drow_door", 9,30,1, "eob_drow_door_8_9_30")
	:addPullChain()
spawn("eob_gem_red_u", 20,20,2, "eob_gem_red_u_2")
spawn("eob_mage_scroll_vampiric_touch", 15,14,2, "eob_mage_scroll_vampiric_touch_1")
spawn("eob_key_drow_u", 28,23,1, "eob_key_drow_u_3")
spawn("eob_key_ruby_u", 25,16,0, "eob_key_ruby_u_2")
spawn("eob_robe_u", 1,28,0, "eob_robe_u_2")
spawn("eob_cleric_scroll_cure_critical_wnds", 28,3,2, "eob_cleric_scroll_cure_critical_wnds_1")
spawn("eob_bow_u", 15,14,2, "eob_bow_u_2")
spawn("eob_key_jeweled_u", 21,21,0, "eob_key_jeweled_u_3")
spawn("eob_mace_u", 1,28,0, "eob_mace_u_3")
spawn("eob_flail_u", 8,23,1, "eob_flail_u_1")
spawn("eob_medallion_of_adornment_u", 5,4,0, "eob_medallion_of_adornment_u_3")
spawn("eob_key_ruby_u", 15,13,1, "eob_key_ruby_u_3")
spawn("eob_plate_mail_cursed3_u", 4,23,0, "eob_plate_mail_cursed3_u_1")
spawn("eob_rock_glowing_u", 28,12,3, "eob_rock_glowing_u_1")
spawn("eob_ring2_u", 5,4,0, "eob_ring2_u_3")
spawn("eob_long_sword_night_stalker_u", 18,8,0, "eob_long_sword_night_stalker_u_1")
spawn("eob_cleric_scroll_neutral_poison", 28,3,2, "eob_cleric_scroll_neutral_poison_1")
spawn("eob_potion_extra_healing", 21,15,0, "eob_potion_extra_healing_4")
spawn("eob_cleric_scroll_prayer", 28,3,1, "eob_cleric_scroll_prayer_2")
spawn("eob_key_drow_u", 20,14,2, "eob_key_drow_u_4")
spawn("eob_mage_scroll_shield", 21,21,0, "eob_mage_scroll_shield_2")
spawn("eob_key_drow_u", 20,20,3, "eob_key_drow_u_5")
spawn("eob_cleric_scroll_protect_evil", 5,15,0, "eob_cleric_scroll_protect_evil_1")
spawn("eob_mage_scroll_ice_storm", 14,28,3, "eob_mage_scroll_ice_storm_1")
spawn("eob_cleric_scroll_hold_person", 12,9,2, "eob_cleric_scroll_hold_person_2")
	:setScrollText("")
spawn("eob_cleric_scroll_raise_dead", 21,15,0, "eob_cleric_scroll_raise_dead_1")
spawn("eob_mage_scroll_invisibility 10'", 9,14,2, "eob_mage_scroll_invisibility 10'_2")
spawn("eob_leather_boots_u", 7,15,1, "eob_leather_boots_u_3")
spawn("eob_lock_picks_u", 12,29,0, "eob_lock_picks_u_2")
spawn("eob_drider", 8,4,0, "eob_drider_1")
spawn("eob_drider", 5,12,0, "eob_drider_2")
spawn("eob_drider", 6,10,0, "eob_drider_3")
spawn("eob_hellhnd1_1", 5,16,0, "eob_hellhnd1_1_1")
spawn("eob_drider", 24,13,0, "eob_drider_4")
spawn("eob_hellhnd1_1", 5,19,0, "eob_hellhnd1_1_2")
spawn("eob_drider", 9,11,0, "eob_drider_5")
spawn("eob_drider", 15,28,0, "eob_drider_6")
spawn("eob_drider", 8,9,0, "eob_drider_7")
spawn("eob_drider2_group", 2,5,0, "eob_drider2_group_1")
spawn("eob_drider", 10,4,0, "eob_drider_8")
spawn("eob_hellhnd1_1", 4,19,0, "eob_hellhnd1_1_3")
spawn("eob_hellhnd1_1", 29,6,0, "eob_hellhnd1_1_4")
spawn("eob_hellhnd1_1", 29,7,0, "eob_hellhnd1_1_5")
spawn("eob_hellhnd1_1", 7,19,0, "eob_hellhnd1_1_6")
spawn("eob_drider", 6,4,0, "eob_drider_9")
spawn("eob_drider", 7,13,0, "eob_drider_10")
spawn("eob_hellhnd1_1", 2,28,0, "eob_hellhnd1_1_7")
spawn("eob_drider", 7,4,0, "eob_drider_11")
spawn("eob_hellhnd1_1", 7,16,0, "eob_hellhnd1_1_8")
spawn("eob_hellhnd1_1", 14,11,0, "eob_hellhnd1_1_9")
spawn("eob_drider", 9,4,0, "eob_drider_12")
spawn("eob_drider", 25,14,0, "eob_drider_13")
spawn("eob_drider", 8,13,0, "eob_drider_14")
spawn("eob_drider", 8,19,0, "eob_drider_15")
spawn("eob_drider", 26,7,0, "eob_drider_16")
spawn("eob_hellhnd1_1", 10,26,0, "eob_hellhnd1_1_10")

--- level 9 ---

mapName("Lower Reaches of The Drow")
setWallSet("prison")
playStream("assets/samples/music/prison_ambient.ogg")
mapDesc([[
################################
#......................##...####
#.#######..###########.##.#.#..#
#.#..#...###..#..#####....#....#
#.#..#.#...........#......#.#..#
#.#....###########.###.##.#.####
#.#.#####..#..#..#.##...#.#.#..#
#.#................###.##.#....#
#.#.#.############.##...#.#.#..#
#.#.#.############.###.##.#.####
#...###.....##.###.....##.#...##
###..............#.....##.###.##
#.##..#.....##..#########...#.##
#.############.#...#...####.#.##
#.#.########...#.###.#.#..#.#.##
##....#.#.#..###.....#.#..#.####
#...#.#.....#####.####.#.......#
#...#.#.....#####.#....####.#..#
##.##.#.....####.##....#.##.#..#
#...#...#.#.#..#.##....###...#.#
#..##.########...#####.#.....#.#
###...#...#..###.###.#.###...#.#
###..##......###.###.#.####.##.#
##############.......#...##....#
####..........#############.####
####.########.###......#..#.#..#
####.#.....##.#...#..#.#.......#
####.#####.##.#.#.####.#..#.#..#
####.#...#.#....#.#..#.####.####
####.#####.#.####.#....####.#..#
####.......#......####.........#
################################
]])
spawn("eob_drow_door", 5,1,1, "eob_drow_door_9_5_1")
spawn("eob_drow_door", 11,1,1, "eob_drow_door_9_11_1")
	:addPullChain()
spawn("eob_drow_lock_spider", 4,1,2, "eob_drow_lock_spider_9_4_1_S")
spawn("eob_drow_lock_spider", 6,1,2, "eob_drow_lock_spider_9_6_1_S")
spawn("eob_drow_door", 22,2,2, "eob_drow_door_9_22_2")
	:addPullChain()
spawn("eob_drow_door", 25,2,2, "eob_drow_door_9_25_2")
	:addPullChain()
spawn("eob_drow_door", 28,3,3, "eob_drow_door_9_28_3")
spawn("eob_drow_door", 11,4,1, "eob_drow_door_9_11_4")
	:addPullChain()
spawn("eob_drow_door", 14,4,1, "eob_drow_door_9_14_4")
	:addPullChain()
spawn("eob_drow_door", 17,4,1, "eob_drow_door_9_17_4")
	:addPullChain()
spawn("eob_drow_stairs_up", 20,4,3, "eob_drow_stairs_up_9_20_4_E")
spawn("eob_drow_lock_gem", 27,4,1, "eob_drow_lock_gem_9_27_4_E")
spawn("eob_drow_door", 22,5,0, "eob_drow_door_9_22_5")
	:addPullChain()
spawn("eob_drow_door", 25,5,0, "eob_drow_door_9_25_5")
	:addPullChain()
spawn("eob_drow_door", 3,6,0, "eob_drow_door_9_3_6")
	:addPullChain()
spawn("eob_drow_wall_text", 21,6,3, "eob_drow_wall_text_9_21_6_W")
	:setWallText("")
spawn("eob_drow_pressure_plate", 21,6,3, "eob_drow_pressure_plate_9_21_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 23,6,1, "eob_drow_pressure_plate_9_23_6")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_wall_text", 25,6,3, "eob_drow_wall_text_9_25_6_W")
	:setWallText("")
spawn("eob_drow_wall_text", 23,6,1, "eob_drow_wall_text_9_23_6_E")
	:setWallText("")
spawn("eob_drow_door", 8,7,1, "eob_drow_door_9_8_7")
	:addPullChain()
spawn("eob_drow_door", 11,7,1, "eob_drow_door_9_11_7")
	:addPullChain()
spawn("eob_drow_door", 14,7,1, "eob_drow_door_9_14_7")
	:addPullChain()
spawn("eob_drow_door", 17,7,1, "eob_drow_door_9_17_7")
	:addPullChain()
spawn("eob_drow_alcove", 25,7,3, "eob_drow_alcove_9_25_7_W")
spawn("eob_drow_door", 28,7,3, "eob_drow_door_9_28_7")
spawn("eob_drow_wall_text", 21,8,3, "eob_drow_wall_text_9_21_8_W")
	:setWallText("")
spawn("eob_drow_pressure_plate", 21,8,3, "eob_drow_pressure_plate_9_21_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 23,8,1, "eob_drow_pressure_plate_9_23_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_alcove", 25,8,3, "eob_drow_alcove_9_25_8_W")
spawn("eob_drow_wall_text", 23,8,1, "eob_drow_wall_text_9_23_8_E")
	:setWallText("")
spawn("eob_drow_lock_gem", 27,8,1, "eob_drow_lock_gem_9_27_8_E")
spawn("eob_drow_dart_firing_pad", 7,10,0, "eob_drow_dart_firing_pad_9_7_10_N")
spawn("eob_drow_dart_firing_pad", 8,10,0, "eob_drow_dart_firing_pad_9_8_10_N")
spawn("eob_drow_dart_firing_pad", 9,10,0, "eob_drow_dart_firing_pad_9_9_10_N")
spawn("eob_drow_dart_firing_pad", 10,10,0, "eob_drow_dart_firing_pad_9_10_10_N")
spawn("eob_drow_dart_firing_pad", 11,10,0, "eob_drow_dart_firing_pad_9_11_10_N")
spawn("eob_drow_dart_firing_pad", 14,10,0, "eob_drow_dart_firing_pad_9_14_10_N")
spawn("eob_drow_door", 18,9,2, "eob_drow_door_9_18_9")
	:addPullChain()
spawn("eob_drow_door", 22,9,2, "eob_drow_door_9_22_9")
spawn("eob_drow_alcove", 25,9,3, "eob_drow_alcove_9_25_9_W")
spawn("eob_drow_wall_illusion", 8,10,3, "eob_drow_wall_illusion_9_8_10_W")
spawn("eob_drow_wall_illusion", 7,11,0, "eob_drow_wall_illusion_9_7_11_N")
spawn("eob_drow_wall_illusion", 10,10,3, "eob_drow_wall_illusion_9_10_10_W")
spawn("eob_drow_wall_illusion", 9,11,0, "eob_drow_wall_illusion_9_9_11_N")
spawn("eob_drow_wall_illusion", 8,10,1, "eob_drow_wall_illusion_9_8_10_E")
spawn("eob_drow_wall_illusion", 11,11,0, "eob_drow_wall_illusion_9_11_11_N")
spawn("eob_drow_wall_illusion", 10,10,1, "eob_drow_wall_illusion_9_10_10_E")
spawn("eob_drow_alcove", 25,10,3, "eob_drow_alcove_9_25_10_W")
spawn("eob_drow_wall_text", 29,10,1, "eob_drow_wall_text_9_29_10_E")
	:setWallText("")
spawn("eob_drow_pressure_plate", 8,11,2, "eob_drow_pressure_plate_9_8_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 10,11,2, "eob_drow_pressure_plate_9_10_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_pressure_plate", 14,11,2, "eob_drow_pressure_plate_9_14_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("prison_secret_door", 16,11,3, "wall_9_16_11_W")
spawn("eob_drow_dart_firing_pad", 15,11,1, "eob_drow_dart_firing_pad_9_15_11_E")
spawn("eob_drow_alcove", 25,11,3, "eob_drow_alcove_9_25_11_W")
spawn("eob_drow_ceiling_shaft", 29,11,2, "eob_drow_ceiling_shaft_9_29_11")
spawn("eob_drow_stairs_down", 1,12,0, "eob_drow_stairs_down_9_1_12_S")
spawn("eob_drow_wall_text", 5,12,1, "eob_drow_wall_text_9_5_12_E")
	:setWallText("")
spawn("eob_drow_wall_illusion", 7,11,2, "eob_drow_wall_illusion_9_7_11_S")
spawn("eob_drow_wall_illusion", 8,12,3, "eob_drow_wall_illusion_9_8_12_W")
spawn("eob_drow_wall_illusion", 9,11,2, "eob_drow_wall_illusion_9_9_11_S")
spawn("eob_drow_wall_illusion", 10,12,3, "eob_drow_wall_illusion_9_10_12_W")
spawn("eob_drow_wall_illusion", 8,12,1, "eob_drow_wall_illusion_9_8_12_E")
spawn("eob_drow_wall_illusion", 11,11,2, "eob_drow_wall_illusion_9_11_11_S")
spawn("eob_drow_wall_illusion", 10,12,1, "eob_drow_wall_illusion_9_10_12_E")
spawn("eob_drow_wall_illusion", 15,11,2, "eob_drow_wall_illusion_9_15_11_S")
spawn("eob_drow_wall_illusion", 14,12,1, "eob_drow_wall_illusion_9_14_12_E")
spawn("eob_drow_pressure_plate", 26,12,1, "eob_drow_pressure_plate_9_26_12")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_ceiling_shaft", 29,12,2, "eob_drow_ceiling_shaft_9_29_12")
spawn("eob_drow_button", 3,14,0, "eob_drow_button_9_3_14_N")
spawn("eob_drow_dart_firing_pad", 7,12,2, "eob_drow_dart_firing_pad_9_7_12_S")
spawn("eob_drow_dart_firing_pad", 8,12,2, "eob_drow_dart_firing_pad_9_8_12_S")
spawn("eob_drow_dart_firing_pad", 9,12,2, "eob_drow_dart_firing_pad_9_9_12_S")
spawn("eob_drow_dart_firing_pad", 10,12,2, "eob_drow_dart_firing_pad_9_10_12_S")
spawn("eob_drow_dart_firing_pad", 11,12,2, "eob_drow_dart_firing_pad_9_11_12_S")
spawn("eob_drow_stairs_up", 18,13,1, "eob_drow_stairs_up_9_18_13_W")
spawn("eob_drow_lock_spider", 22,13,1, "eob_drow_lock_spider_9_22_13_E")
spawn("eob_drow_wall_text", 25,12,2, "eob_drow_wall_text_9_25_12_S")
	:setWallText("")
spawn("eob_drow_ceiling_shaft", 29,13,2, "eob_drow_ceiling_shaft_9_29_13")
spawn("eob_drow_wall_throwable", 3,15,0, "eob_drow_wall_throwable_9_3_15_N")
spawn("eob_drow_magic_missile_firing_pad", 7,15,0, "eob_drow_magic_missile_firing_pad_9_7_15_N")
spawn("eob_drow_button", 9,15,0, "eob_drow_button_9_9_15_N")
spawn("eob_drow_wall_text", 12,14,3, "eob_drow_wall_text_9_12_14_W")
	:setWallText("")
spawn("eob_drow_magic_missile_firing_pad", 11,15,0, "eob_drow_magic_missile_firing_pad_9_11_15_N")
spawn("eob_drow_door", 16,14,2, "eob_drow_door_9_16_14")
spawn("eob_drow_door", 22,14,0, "eob_drow_door_9_22_14")
spawn("eob_drow_ceiling_shaft", 29,14,2, "eob_drow_ceiling_shaft_9_29_14")
spawn("eob_drow_pit", 2,15,3, "eob_drow_pit_9_2_15")
spawn("eob_drow_pressure_plate", 12,15,2, "eob_drow_pressure_plate_9_12_15")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_magic_missile_firing_pad", 14,14,2, "eob_drow_magic_missile_firing_pad_9_14_14_S")
spawn("eob_drow_lock_spider", 16,15,3, "eob_drow_lock_spider_9_16_15_W")
spawn("eob_blocker", 25,15,2, "eob_blocker_9_25_15")
spawn("eob_drow_pit", 3,16,2, "eob_drow_pit_9_3_16")
spawn("eob_drow_magic_missile_firing_pad", 7,16,3, "eob_drow_magic_missile_firing_pad_9_7_16_W")
spawn("eob_drow_button", 11,16,1, "eob_drow_button_9_11_16_E")
spawn("eob_blocker", 24,16,2, "eob_blocker_9_24_16")
spawn("eob_drow_pressure_plate", 25,16,2, "eob_drow_pressure_plate_9_25_16")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_door", 26,16,1, "eob_drow_door_9_26_16")
	:addPullChain()
spawn("eob_drow_door", 28,16,3, "eob_drow_door_9_28_16")
	:addPullChain()
spawn("eob_drow_ceiling_shaft", 1,17,2, "eob_drow_ceiling_shaft_9_1_17")
spawn("eob_drow_pressure_plate", 3,17,2, "eob_drow_pressure_plate_9_3_17")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_drow_button", 7,17,3, "eob_drow_button_9_7_17_W")
spawn("eob_drow_magic_missile_firing_pad", 11,17,1, "eob_drow_magic_missile_firing_pad_9_11_17_E")
spawn("eob_drow_stairs_up", 17,17,2, "eob_drow_stairs_up_9_17_17")
spawn("eob_drow_wall_text", 19,17,3, "eob_drow_wall_text_9_19_17_W")
	:setWallText("")
spawn("eob_drow_wall_illusion", 2,17,2, "eob_drow_wall_illusion_9_2_17_S")
spawn("eob_drow_wall_illusion", 2,19,0, "eob_drow_wall_illusion_9_2_19_N")
spawn("eob_drow_magic_missile_firing_pad", 7,18,3, "eob_drow_magic_missile_firing_pad_9_7_18_W")
spawn("eob_drow_button", 11,18,1, "eob_drow_button_9_11_18_E")
spawn("eob_drow_alcove", 19,18,3, "eob_drow_alcove_9_19_18_W")
spawn("eob_drow_wall_text", 22,18,1, "eob_drow_wall_text_9_22_18_E")
	:setWallText("")
spawn("eob_drow_button", 24,18,1, "eob_drow_button_9_24_18_E")
spawn("eob_drow_door", 3,19,1, "eob_drow_door_9_3_19")
	:addPullChain()
spawn("eob_drow_door", 6,19,1, "eob_drow_door_9_6_19")
spawn("eob_drow_lock_spider", 7,19,1, "eob_drow_lock_spider_9_7_19_E")
spawn("eob_drow_wall_illusion", 14,20,0, "eob_drow_wall_illusion_9_14_20_N")
spawn("eob_drow_wall_illusion", 13,19,1, "eob_drow_wall_illusion_9_13_19_E")
spawn("eob_drow_door", 16,19,2, "eob_drow_door_9_16_19")
spawn("eob_drow_button", 19,19,3, "eob_drow_button_9_19_19_W")
spawn("eob_drow_wall_illusion", 30,18,2, "eob_drow_wall_illusion_9_30_18_S")
spawn("eob_drow_wall_illusion", 30,20,0, "eob_drow_wall_illusion_9_30_20_N")
spawn("eob_drow_door", 5,20,0, "eob_drow_door_9_5_20")
spawn("eob_drow_button", 7,19,2, "eob_drow_button_9_7_19_S")
spawn("eob_drow_magic_missile_firing_pad", 9,19,2, "eob_drow_magic_missile_firing_pad_9_9_19_S")
spawn("eob_drow_button", 11,19,2, "eob_drow_button_9_11_19_S")
spawn("eob_drow_door", 15,20,1, "eob_drow_door_9_15_20")
	:addPullChain()
spawn("eob_drow_lock_spider", 22,20,1, "eob_drow_lock_spider_9_22_20_E")
spawn("eob_drow_wall_illusion", 26,20,3, "eob_drow_wall_illusion_9_26_20_W")
spawn("eob_drow_wall_illusion", 24,20,1, "eob_drow_wall_illusion_9_24_20_E")
spawn("eob_drow_portal_dagger", 28,20,1, "eob_drow_portal_dagger_9_28_20_E")
spawn("eob_drow_ceiling_shaft", 3,21,3, "eob_drow_ceiling_shaft_9_3_21")
spawn("eob_drow_stairs_up", 20,21,0, "eob_drow_stairs_up_9_20_21")
spawn("eob_drow_door", 22,21,0, "eob_drow_door_9_22_21")
spawn("eob_drow_door", 22,22,0, "eob_drow_door_9_22_22")
	:addPullChain()
spawn("eob_drow_door", 15,23,1, "eob_drow_door_9_15_23")
	:addPullChain()
spawn("eob_drow_stairs_up", 24,23,1, "eob_drow_stairs_up_9_24_23_W")
spawn("eob_drow_wall_text", 20,23,2, "eob_drow_wall_text_9_20_23_S")
	:setWallText("")
spawn("eob_drow_secret_button_tiny", 9,24,2, "eob_drow_secret_button_tiny_9_9_24_S")
spawn("eob_drow_door", 18,25,1, "eob_drow_door_9_18_25")
	:addPullChain()
spawn("eob_drow_door", 21,25,1, "eob_drow_door_9_21_25")
spawn("eob_drow_wall_text", 24,25,3, "eob_drow_wall_text_9_24_25_W")
	:setWallText("")
spawn("eob_drow_stairs_down", 6,26,3, "eob_drow_stairs_down_9_6_26_E")
spawn("eob_drow_alcove", 24,26,3, "eob_drow_alcove_9_24_26_W")
spawn("eob_drow_door", 26,26,1, "eob_drow_door_9_26_26")
	:addPullChain()
spawn("eob_drow_door", 28,26,3, "eob_drow_door_9_28_26")
	:addPullChain()
spawn("eob_drow_stairs_down", 6,28,3, "eob_drow_stairs_down_9_6_28_E")
spawn("eob_drow_button", 19,28,3, "eob_drow_button_9_19_28_W")
spawn("eob_drow_alcove", 19,29,3, "eob_drow_alcove_9_19_29_W")
spawn("eob_drow_door", 21,29,1, "eob_drow_door_9_21_29")
	:addPullChain()
spawn("eob_drow_wall_illusion", 29,30,3, "eob_drow_wall_illusion_9_29_30_W")
spawn("eob_drow_wall_illusion", 27,30,1, "eob_drow_wall_illusion_9_27_30_E")
spawn("eob_spear_u", 14,23,0, "eob_spear_u_3")
spawn("eob_arrow_u", 25,14,3, "eob_arrow_u_21")
spawn("eob_holy_symbol_u", 11,11,1, "eob_holy_symbol_u_1")
spawn("eob_dart_plus4_u", 10,9,0, "eob_dart_plus4_u_1")
spawn("eob_mage_scroll_stone_skin", 30,8,2, "eob_mage_scroll_stone_skin_1")
spawn("eob_arrow_u", 25,14,2, "eob_arrow_u_22")
spawn("eob_long_sword_severious_u", 11,11,1, "eob_long_sword_severious_u_1")
spawn("eob_dart_plus4_u", 11,13,0, "eob_dart_plus4_u_2")
spawn("eob_dart_plus4_u", 8,9,0, "eob_dart_plus4_u_3")
spawn("eob_key_drow_u", 9,15,3, "eob_key_drow_u_6")
spawn("eob_plate_mail_u", 11,11,1, "eob_plate_mail_u_2")
spawn("eob_shield_u", 11,11,1, "eob_shield_u_6")
spawn("eob_cleric_scroll_raise_dead", 8,28,1, "eob_cleric_scroll_raise_dead_2")
spawn("eob_potion_poison", 15,6,0, "eob_potion_poison_2")
spawn("eob_bones_human_beohram_u", 11,11,1, "eob_bones_human_beohram_u_1")
spawn("eob_wand_fireball_10_u", 20,26,2, "eob_wand_fireball_10_u_1")
spawn("eob_cleric_scroll_dispel_magic", 2,16,1, "eob_cleric_scroll_dispel_magic_2")
spawn("eob_mage_scroll_invisibility", 29,18,3, "eob_mage_scroll_invisibility_2")
spawn("eob_dart_plus4_u", 11,9,0, "eob_dart_plus4_u_4")
spawn("eob_potion_extra_healing", 3,22,3, "eob_potion_extra_healing_5")
spawn("eob_cleric_scroll_raise_dead", 12,21,3, "eob_cleric_scroll_raise_dead_3")
spawn("eob_orb_of_power_u", 24,18,2, "eob_orb_of_power_u_1")
spawn("eob_cleric_scroll_detect_magic", 12,3,0, "eob_cleric_scroll_detect_magic_2")
spawn("eob_shield_drow_u", 24,20,0, "eob_shield_drow_u_1")
spawn("eob_leather_boots_u", 28,21,2, "eob_leather_boots_u_4")
spawn("eob_dart_plus4_u", 8,13,0, "eob_dart_plus4_u_5")
spawn("eob_dart_plus4_u", 9,9,0, "eob_dart_plus4_u_6")
spawn("eob_cleric_scroll_cure_serious_wnds", 2,16,2, "eob_cleric_scroll_cure_serious_wnds_2")
spawn("eob_chain_mail_u", 30,29,1, "eob_chain_mail_u_2")
spawn("eob_cleric_scroll_protect_evil10", 1,20,3, "eob_cleric_scroll_protect_evil10_2")
spawn("eob_orb_of_power_u", 24,18,0, "eob_orb_of_power_u_2")
spawn("eob_dart_plus4_u", 10,13,0, "eob_dart_plus4_u_7")
spawn("eob_arrow_u", 25,14,1, "eob_arrow_u_23")
spawn("eob_dart_plus4_u", 9,13,0, "eob_dart_plus4_u_8")
spawn("eob_orb_of_power_u", 24,18,1, "eob_orb_of_power_u_3")
spawn("eob_mage_scroll_armor", 14,20,0, "eob_mage_scroll_armor_1")
spawn("eob_cleric_scroll_flame_blade", 13,19,0, "eob_cleric_scroll_flame_blade_3")
spawn("eob_dart_plus4_u", 7,13,0, "eob_dart_plus4_u_9")
spawn("eob_dwarven_helmet_u", 11,11,1, "eob_dwarven_helmet_u_2")
spawn("eob_dart_plus4_u", 7,9,0, "eob_dart_plus4_u_10")
spawn("eob_key_drow_u", 30,2,1, "eob_key_drow_u_7")
spawn("eob_rust", 15,4,0, "eob_rust_1")
spawn("eob_disbeast", 13,28,0, "eob_disbeast_1")
spawn("eob_rust", 9,6,0, "eob_rust_2")
spawn("eob_rust", 29,26,0, "eob_rust_3")
spawn("eob_rust", 24,14,0, "eob_rust_4")
spawn("eob_rust", 29,4,0, "eob_rust_5")
spawn("eob_rust", 24,26,0, "eob_rust_6")
spawn("eob_rust", 29,2,0, "eob_rust_7")
spawn("eob_disbeast", 5,9,0, "eob_disbeast_3")
spawn("eob_rust", 19,11,0, "eob_rust_8")
spawn("eob_rust", 19,10,0, "eob_rust_9")
spawn("eob_disbeast", 3,3,0, "eob_disbeast_4")
spawn("eob_rust", 12,4,0, "eob_rust_10")
spawn("eob_disbeast", 4,3,0, "eob_disbeast_5")
spawn("eob_rust", 10,1,0, "eob_rust_11")
spawn("eob_rust", 16,18,0, "eob_rust_12")
spawn("eob_rust", 25,14,0, "eob_rust_13")
spawn("eob_rust", 10,2,0, "eob_rust_14")
spawn("eob_rust", 9,2,0, "eob_rust_15")
spawn("eob_rust", 9,1,0, "eob_rust_16")
spawn("eob_rust", 12,6,0, "eob_rust_17")

--- level 10 ---

mapName("Xanthar's Outer Sanctum, Mantis Hive")
setWallSet("dungeon")
playStream("assets/samples/music/dungeon_ambient.ogg")
mapDesc([[
################################
################################
################################
################################
################################
################################
################################
################################
################################
####.######.......##############
#.......###.#####.##############
#.##.##.....#...#.#########..###
#.#.##.######...#.###...#.##.###
###.....##..##.##.#.###.#....###
#######.##.##...#.#......#.#####
#...##......#####.####.###.#####
#...#..#.##.................####
#...##.#...###.########..##.####
##.###...#..########.#.#..#.####
##.#..##.####..#..#.....########
##......................#.....##
##.#..##.####..#..#.....#.....##
#..####......########.###.....##
#..#..#.####...######.##########
#..#..#......#..#...#.#.....####
##.#.###.##.#####.#.#.#.#..#####
##.....#.....#....#.....#...####
#######..###.#...##.....#..#####
##.....#...#.#.#..#.....#...####
##...################.###..#####
##....................###...####
################################
]])
spawn("eob_hive_wall_rift", 17,9,1, "eob_hive_wall_rift_10_17_9_E")
spawn("eob_hive_wall_rift", 9,11,0, "eob_hive_wall_rift_10_9_11_N")
spawn("eob_hive_wall_text", 13,11,0, "eob_hive_wall_text_10_13_11_N")
	:setWallText("")
spawn("eob_hive_wall_text", 15,11,0, "eob_hive_wall_text_10_15_11_N")
	:setWallText("")
spawn("eob_hive_alcove", 13,11,3, "eob_hive_alcove_10_13_11_W")
	:addItem(spawn("eob_potion_giant_strength"))
spawn("eob_hive_pit", 14,11,1, "eob_hive_pit_10_14_11")
spawn("eob_hive_alcove", 15,11,1, "eob_hive_alcove_10_15_11_E")
	:addItem(spawn("eob_ring2_feather_fall_u"))
spawn("eob_hive_stairs_up", 1,12,2, "eob_hive_stairs_up_10_1_12")
spawn("eob_hive_wall_rift", 11,13,0, "eob_hive_wall_rift_10_11_13_N")
spawn("eob_hive_wall_rift", 22,14,0, "eob_hive_wall_rift_10_22_14_N")
spawn("eob_hive_wall_rift", 3,15,0, "eob_hive_wall_rift_10_3_15_N")
spawn("eob_hive_lever", 13,14,3, "eob_hive_lever_10_13_14_W")
	:setLeverState("activated")
spawn("eob_hive_lever", 15,14,1, "eob_hive_lever_10_15_14_E")
	:setLeverState("activated")
spawn("eob_hive_wall_rift", 24,14,1, "eob_hive_wall_rift_10_24_14_E")
spawn("eob_hive_ceiling_shaft", 2,15,1, "eob_hive_ceiling_shaft_10_2_15")
spawn("eob_blocker", 11,15,1, "eob_blocker_10_11_15")
spawn("eob_hive_ceiling_shaft", 3,16,2, "eob_hive_ceiling_shaft_10_3_16")
spawn("eob_hive_wall_rift", 8,16,1, "eob_hive_wall_rift_10_8_16_E")
spawn("eob_hive_door", 16,16,1, "eob_hive_door_10_16_16")
	:addPullChain()
spawn("eob_hive_door", 20,16,3, "eob_hive_door_10_20_16")
	:addPullChain()
spawn("eob_hive_wall_text", 19,16,2, "eob_hive_wall_text_10_19_16_S")
	:setWallText("")
spawn("eob_hive_switch", 20,18,0, "eob_hive_switch_10_20_18_N")
spawn("eob_hive_switch", 22,18,0, "eob_hive_switch_10_22_18_N")
spawn("eob_hive_door", 2,18,0, "eob_hive_door_10_2_18")
	:addPullChain()
spawn("eob_hive_lever", 14,17,2, "eob_hive_lever_10_14_17_S")
	:setLeverState("activated")
spawn("eob_hive_wall_text", 19,19,0, "eob_hive_wall_text_10_19_19_N")
	:setWallText("")
spawn("eob_hive_door", 20,18,2, "eob_hive_door_10_20_18")
	:addPullChain()
spawn("eob_hive_wall_rift", 21,19,0, "eob_hive_wall_rift_10_21_19_N")
spawn("eob_hive_door", 22,18,2, "eob_hive_door_10_22_18")
	:addPullChain()
spawn("eob_hive_wall_text", 23,19,0, "eob_hive_wall_text_10_23_19_N")
	:setWallText("")
spawn("eob_hive_secret_button_tiny", 27,18,3, "eob_hive_secret_button_tiny_10_27_18_W")
spawn("eob_hive_wall_text", 7,20,0, "eob_hive_wall_text_10_7_20_N")
	:setWallText("")
spawn("eob_hive_door", 8,19,2, "eob_hive_door_10_8_19")
	:addPullChain()
spawn("eob_hive_door", 15,20,1, "eob_hive_door_10_15_20")
	:addPullChain()
spawn("eob_hive_door", 18,20,1, "eob_hive_door_10_18_20")
	:addPullChain()
spawn("eob_hive_door", 2,21,0, "eob_hive_door_10_2_21")
	:addPullChain()
spawn("eob_hive_wall_text", 7,20,2, "eob_hive_wall_text_10_7_20_S")
	:setWallText("")
spawn("eob_hive_door", 8,21,0, "eob_hive_door_10_8_21")
	:addPullChain()
spawn("eob_hive_wall_rift", 23,21,1, "eob_hive_wall_rift_10_23_21_E")
spawn("eob_hive_wall_rift", 29,21,1, "eob_hive_wall_rift_10_29_21_E")
spawn("eob_hive_pressure_plate", 1,22,3, "eob_hive_pressure_plate_10_1_22")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_hive_wall_rift", 5,23,0, "eob_hive_wall_rift_10_5_23_N")
spawn("eob_hive_wall_rift", 16,21,2, "eob_hive_wall_rift_10_16_21_S")
spawn("eob_hive_lock", 20,21,2, "eob_hive_lock_10_20_21_S")
spawn("eob_hive_door", 21,22,0, "eob_hive_door_10_21_22")
spawn("eob_hive_wall_rift", 22,21,2, "eob_hive_wall_rift_10_22_21_S")
spawn("eob_hive_pressure_plate", 1,23,2, "eob_hive_pressure_plate_10_1_23")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_hive_pressure_plate", 1,24,2, "eob_hive_pressure_plate_10_1_24")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_hive_wall_text", 21,24,1, "eob_hive_wall_text_10_21_24_E")
	:setWallText("")
spawn("eob_blocker", 26,24,1, "eob_blocker_10_26_24")
spawn("eob_hive_wall_text", 2,25,3, "eob_hive_wall_text_10_2_25_W")
	:setWallText("")
spawn("eob_hive_wall_rift", 9,24,2, "eob_hive_wall_rift_10_9_24_S")
spawn("eob_hive_door", 19,25,2, "eob_hive_door_10_19_25")
	:addPullChain()
spawn("eob_hive_door", 21,25,2, "eob_hive_door_10_21_25")
	:addPullChain()
spawn("eob_hive_door", 23,25,2, "eob_hive_door_10_23_25")
	:addPullChain()
spawn("eob_hive_alcove", 26,25,1, "eob_hive_alcove_10_26_25_E")
	:addItem(spawn("eob_potion_poison"))
spawn("eob_hive_stairs_up", 6,26,1, "eob_hive_stairs_up_10_6_26")
spawn("eob_hive_wall_rift", 19,26,3, "eob_hive_wall_rift_10_19_26_W")
spawn("eob_blocker", 26,26,2, "eob_blocker_10_26_26")
spawn("eob_hive_wall_rift", 14,27,3, "eob_hive_wall_rift_10_14_27_W")
spawn("eob_hive_portal_scepter", 19,27,3, "eob_hive_portal_scepter_10_19_27_W")
spawn("eob_hive_portal_ring", 23,27,1, "eob_hive_portal_ring_10_23_27_E")
spawn("eob_hive_alcove", 26,27,1, "eob_hive_alcove_10_26_27_E")
	:addItem(spawn("eob_wand_cone_of_cold_10_u"))
spawn("eob_hive_stairs_up", 6,28,1, "eob_hive_stairs_up_10_6_28")
spawn("eob_hive_alcove", 19,28,3, "eob_hive_alcove_10_19_28_W")
	:addItem(spawn("eob_cleric_scroll_flame_blade"))
	:addItem(spawn("eob_cleric_scroll_remove_paralysis"))
spawn("eob_hive_prison_manacles", 17,28,1, "eob_hive_prison_manacles_10_17_28_E")
spawn("eob_hive_alcove", 23,28,1, "eob_hive_alcove_10_23_28_E")
spawn("eob_blocker", 26,28,2, "eob_blocker_10_26_28")
spawn("eob_hive_wall_rift", 2,29,3, "eob_hive_wall_rift_10_2_29_W")
spawn("eob_hive_lever", 7,30,0, "eob_hive_lever_10_7_30_N")
spawn("eob_hive_lever", 9,30,0, "eob_hive_lever_10_9_30_N")
spawn("eob_hive_lever", 11,30,0, "eob_hive_lever_10_11_30_N")
spawn("eob_hive_lever", 13,30,0, "eob_hive_lever_10_13_30_N")
spawn("eob_hive_lever", 15,30,0, "eob_hive_lever_10_15_30_N")
spawn("eob_hive_lever", 17,30,0, "eob_hive_lever_10_17_30_N")
spawn("eob_hive_wall_rift", 19,28,2, "eob_hive_wall_rift_10_19_28_S")
spawn("eob_hive_lever", 19,30,0, "eob_hive_lever_10_19_30_N")
spawn("eob_hive_wall_rift", 23,28,2, "eob_hive_wall_rift_10_23_28_S")
spawn("eob_hive_alcove", 26,29,1, "eob_hive_alcove_10_26_29_E")
	:addItem(spawn("eob_cleric_scroll_flame_blade"))
	:addItem(spawn("eob_cleric_scroll_cure_critical_wnds"))
spawn("eob_hive_pressure_plate", 5,30,1, "eob_hive_pressure_plate_10_5_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 6,30,1, "eob_teleporter_10_6_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 8,30,1, "eob_teleporter_10_8_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 10,30,1, "eob_teleporter_10_10_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 12,30,1, "eob_teleporter_10_12_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 14,30,1, "eob_teleporter_10_14_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 16,30,1, "eob_teleporter_10_16_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_teleporter", 18,30,1, "eob_teleporter_10_18_30")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_hive_secret_button_small", 25,30,3, "eob_hive_secret_button_small_10_25_30_W")
spawn("eob_blocker", 26,30,2, "eob_blocker_10_26_30")
spawn("eob_hive_wall_rift", 7,30,2, "eob_hive_wall_rift_10_7_30_S")
spawn("eob_hive_wall_rift", 11,30,2, "eob_hive_wall_rift_10_11_30_S")
spawn("eob_hive_wall_rift", 15,30,2, "eob_hive_wall_rift_10_15_30_S")
spawn("eob_hive_wall_text", 20,30,2, "eob_hive_wall_text_10_20_30_S")
	:setWallText("")
spawn("eob_hive_wall_text", 21,30,2, "eob_hive_wall_text_10_21_30_S")
	:setWallText("")
spawn("eob_cleric_scroll_neutral_poison", 19,13,0, "eob_cleric_scroll_neutral_poison_2")
spawn("eob_mage_scroll_cone_of_cold", 25,22,3, "eob_mage_scroll_cone_of_cold_1")
spawn("eob_arrow_u", 15,24,1, "eob_arrow_u_24")
spawn("eob_arrow_u", 4,11,3, "eob_arrow_u_25")
spawn("eob_bones_elf_tyrra_u", 3,12,1, "eob_bones_elf_tyrra_u_1")
spawn("eob_plate_mail_u", 2,28,0, "eob_plate_mail_u_3")
spawn("eob_wand_u", 14,27,0, "eob_wand_u_1")
spawn("eob_key_skull_u", 3,12,0, "eob_key_skull_u_1")
spawn("eob_mantis1_1", 27,24,0, "eob_mantis1_1_1")
spawn("eob_mantis1_2", 16,21,0, "eob_mantis1_2_1")
spawn("eob_mantis1_1", 5,24,0, "eob_mantis1_1_2")
spawn("eob_mantis1_2", 27,26,0, "eob_mantis1_2_2")
spawn("eob_mantis1_2", 27,30,0, "eob_mantis1_2_3")
spawn("eob_mantis1_1", 6,15,0, "eob_mantis1_1_3")
spawn("eob_mantis1_1", 27,28,0, "eob_mantis1_1_4")
spawn("eob_mantis1_2", 12,23,0, "eob_mantis1_2_4")
spawn("eob_mantis1_2", 2,16,0, "eob_mantis1_2_5")
spawn("eob_mantis1_2", 8,24,0, "eob_mantis1_2_6")
spawn("eob_mantis1_1", 10,14,0, "eob_mantis1_1_5")
spawn("eob_mantis1_1", 16,19,0, "eob_mantis1_1_6")
spawn("eob_mantis1_1", 8,27,0, "eob_mantis1_1_7")
spawn("eob_mantis1_2", 8,16,0, "eob_mantis1_2_7")

--- level 11 ---

mapName("Xanthar's Outer Sanctum, Lower Reaches")
setWallSet("dungeon")
playStream("assets/samples/music/dungeon_ambient.ogg")
mapDesc([[
################################
#..####....#..........#...#...##
#.......##.#######..#.#...##...#
#######.#....#...####.#.###..#.#
#...###.#....#.#............#..#
#.#...#.###############.###...##
#...#.#.#...........#...#...#..#
#######.#.#########.#...#.#..#.#
#...###.#.#.......#.#.###..#...#
#.#.##..#.#.##.##.#.#....#...###
#...##.##.#.#...#.#.####.##.#..#
######..#.#.#.#.#...#..#.#...#.#
#...#####.#.#...#.#.##.#.#.#...#
#.#.....#.#.#####.#.#..#.#####.#
#...###.#.#.......#.#.##.#.#...#
#######.#.#########.#.#..#.#...#
#...###.#...........#.#..#######
#.#.###.#############.####..#..#
#...###......#.#............#..#
#######.####...#.#########..#..#
##......#..#####.#.......#####.#
##...##.#..#####...#.#.#.......#
##...##........###.......#####.#
#########..###.###########..#..#
#.......#..###.#.........#..#..#
#.......######.#..##.....##.#..#
#..#.#..#......#######.##...####
#..#.#..#...##.#..###...#.###.##
#..###..#...##.#....#...#..#...#
#.......#...#...###.##.###.#...#
#.......#...#...###........#...#
################################
]])
spawn("eob_hive_wall_rift", 21,1,0, "eob_hive_wall_rift_11_21_1_N")
spawn("eob_hive_door", 3,2,3, "eob_hive_door_11_3_2")
	:addPullChain()
spawn("eob_hive_door", 10,2,2, "eob_hive_door_11_10_2")
	:addPullChain()
spawn("eob_hive_door", 21,3,2, "eob_hive_door_11_21_3")
	:addPullChain()
spawn("eob_hive_door", 23,3,2, "eob_hive_door_11_23_3")
	:addPullChain()
spawn("eob_hive_door", 14,4,0, "eob_hive_door_11_14_4")
	:addPullChain()
spawn("eob_blocker", 27,4,2, "eob_blocker_11_27_4")
spawn("eob_hive_door", 4,5,3, "eob_hive_door_11_4_5")
	:addPullChain()
spawn("eob_hive_button", 14,6,0, "eob_hive_button_11_14_6_N")
spawn("eob_hive_door", 23,5,0, "eob_hive_door_11_23_5")
	:addPullChain()
spawn("eob_hive_wall_text", 14,8,0, "eob_hive_wall_text_11_14_8_N")
	:setWallText("")
spawn("eob_hive_wall_rift", 30,7,3, "eob_hive_wall_rift_11_30_7_W")
spawn("eob_hive_door", 21,8,0, "eob_hive_door_11_21_8")
	:addPullChain()
spawn("eob_hive_wall_rift", 3,9,1, "eob_hive_wall_rift_11_3_9_E")
spawn("eob_hive_lever", 24,9,1, "eob_hive_lever_11_24_9_E")
	:setLeverState("activated")
spawn("eob_hive_ceiling_shaft", 14,10,2, "eob_hive_ceiling_shaft_11_14_10")
spawn("eob_hive_lever", 24,10,1, "eob_hive_lever_11_24_10_E")
spawn("eob_hive_door", 7,11,3, "eob_hive_door_11_7_11")
	:addPullChain()
spawn("eob_hive_wall_star", 11,11,3, "eob_hive_wall_star_11_11_11_W")
spawn("eob_hive_wall_text", 13,11,3, "eob_hive_wall_text_11_13_11_W")
	:setWallText("")
spawn("eob_hive_portal_cross", 15,11,3, "eob_hive_portal_cross_11_15_11_W")
spawn("eob_hive_wall_rift", 13,11,1, "eob_hive_wall_rift_11_13_11_E")
spawn("eob_hive_button", 15,11,1, "eob_hive_button_11_15_11_E")
spawn("eob_hive_wall_star", 19,11,1, "eob_hive_wall_star_11_19_11_E")
spawn("eob_hive_door", 21,11,1, "eob_hive_door_11_21_11")
	:addPullChain()
spawn("eob_hive_lever", 24,11,1, "eob_hive_lever_11_24_11_E")
spawn("eob_hive_lever", 24,12,1, "eob_hive_lever_11_24_12_E")
spawn("eob_hive_door", 4,13,3, "eob_hive_door_11_4_13")
	:addPullChain()
spawn("eob_hive_wall_star", 14,12,2, "eob_hive_wall_star_11_14_12_S")
spawn("eob_hive_lever", 24,13,1, "eob_hive_lever_11_24_13_E")
	:setLeverState("activated")
spawn("eob_hive_door", 30,13,2, "eob_hive_door_11_30_13")
	:addPullChain()
spawn("eob_hive_wall_rift", 1,14,3, "eob_hive_wall_rift_11_1_14_W")
spawn("eob_hive_lever", 24,14,1, "eob_hive_lever_11_24_14_E")
	:setLeverState("activated")
spawn("eob_hive_button", 14,14,2, "eob_hive_button_11_14_14_S")
spawn("eob_hive_lever", 24,15,1, "eob_hive_lever_11_24_15_E")
	:setLeverState("activated")
spawn("eob_hive_secret_button_small", 28,15,3, "eob_hive_secret_button_small_11_28_15_W")
spawn("eob_hive_wall_rift", 1,16,3, "eob_hive_wall_rift_11_1_16_W")
spawn("eob_hive_lever", 24,16,1, "eob_hive_lever_11_24_16_E")
spawn("eob_hive_wall_text", 30,15,2, "eob_hive_wall_text_11_30_15_S")
	:setWallText("")
spawn("eob_hive_wall_text", 14,16,2, "eob_hive_wall_text_11_14_16_S")
	:setWallText("")
spawn("eob_hive_alcove", 24,16,2, "eob_hive_alcove_11_24_16_S")
	:addItem(spawn("eob_dwarven_potion_healing"))
spawn("eob_hive_door", 8,18,1, "eob_hive_door_11_8_18")
spawn("eob_hive_door", 14,18,2, "eob_hive_door_11_14_18")
	:addPullChain()
spawn("eob_hive_lock", 9,18,2, "eob_hive_lock_11_9_18_S")
spawn("eob_hive_door", 6,20,1, "eob_hive_door_11_6_20")
	:addPullChain()
spawn("eob_hive_door", 30,20,2, "eob_hive_door_11_30_20")
	:addPullChain()
spawn("eob_hive_door", 17,21,1, "eob_hive_door_11_17_21")
	:addPullChain()
spawn("eob_hive_wall_text", 18,21,1, "eob_hive_wall_text_11_18_21_E")
	:setWallText("")
spawn("eob_hive_secret_button_tiny", 22,21,3, "eob_hive_secret_button_tiny_11_22_21_W")
spawn("eob_hive_wall_rift", 24,21,3, "eob_hive_wall_rift_11_24_21_W")
spawn("eob_hive_door", 25,21,3, "eob_hive_door_11_25_21")
	:addPullChain()
spawn("eob_hive_door", 8,22,1, "eob_hive_door_11_8_22")
	:addPullChain()
spawn("eob_hive_door", 11,22,3, "eob_hive_door_11_11_22")
	:addPullChain()
spawn("eob_hive_door", 30,22,0, "eob_hive_door_11_30_22")
	:addPullChain()
spawn("eob_hive_secret_button_tiny", 4,22,2, "eob_hive_secret_button_tiny_11_4_22_S")
spawn("eob_hive_wall_rift", 6,24,0, "eob_hive_wall_rift_11_6_24_N")
spawn("eob_hive_wall_rift", 10,24,1, "eob_hive_wall_rift_11_10_24_E")
spawn("eob_hive_door", 18,24,3, "eob_hive_door_11_18_24")
	:addPullChain()
spawn("eob_hive_wall_rift", 29,24,3, "eob_hive_wall_rift_11_29_24_W")
spawn("eob_hive_door", 27,25,0, "eob_hive_door_11_27_25")
	:addPullChain()
spawn("eob_hive_lock", 3,25,2, "eob_hive_lock_11_3_25_S")
spawn("eob_hive_door", 4,26,0, "eob_hive_door_11_4_26")
spawn("eob_hive_door", 13,26,1, "eob_hive_door_11_13_26")
	:addPullChain()
spawn("eob_hive_door", 22,26,0, "eob_hive_door_11_22_26")
	:addPullChain()
spawn("eob_hive_secret_button_tiny", 30,25,2, "eob_hive_secret_button_tiny_11_30_25_S")
spawn("eob_hive_wall_rift", 6,27,3, "eob_hive_wall_rift_11_6_27_W")
spawn("eob_hive_secret_button_tiny", 9,27,3, "eob_hive_secret_button_tiny_11_9_27_W")
spawn("eob_hive_portal_orb", 4,27,2, "eob_hive_portal_orb_11_4_27_S")
spawn("eob_hive_door", 14,28,2, "eob_hive_door_11_14_28")
	:addPullChain()
spawn("eob_hive_door", 18,28,3, "eob_hive_door_11_18_28")
	:addPullChain()
spawn("eob_hive_wall_rift", 7,29,1, "eob_hive_wall_rift_11_7_29_E")
spawn("eob_hive_door", 22,29,0, "eob_hive_door_11_22_29")
	:addPullChain()
spawn("eob_hive_wall_rift", 13,30,3, "eob_hive_wall_rift_11_13_30_W")
spawn("eob_spell_book_u", 16,27,0, "eob_spell_book_u_1")
spawn("eob_ring_protection2_u", 16,27,0, "eob_ring_protection2_u_2")
spawn("eob_key_drow_u", 16,24,0, "eob_key_drow_u_8")
spawn("eob_stone_holy_symbol_u", 17,27,0, "eob_stone_holy_symbol_u_1")
spawn("eob_cleric_scroll_raise_dead", 5,6,2, "eob_cleric_scroll_raise_dead_4")
spawn("eob_cleric_scroll_raise_dead", 25,1,1, "eob_cleric_scroll_raise_dead_5")
spawn("eob_banded_armor_plus3_u", 1,1,0, "eob_banded_armor_plus3_u_1")
spawn("eob_stone_orb_u", 26,15,2, "eob_stone_orb_u_1")
spawn("eob_dagger_flicka_u", 16,27,0, "eob_dagger_flicka_u_1")
spawn("eob_cleric_scroll_cure_serious_wnds", 23,16,3, "eob_cleric_scroll_cure_serious_wnds_3")
spawn("eob_key_drow_u", 26,15,2, "eob_key_drow_u_9")
spawn("eob_rock_mossy_u", 9,11,0, "eob_rock_mossy_u_1")
spawn("eob_medallion_luck_stone_u", 5,6,3, "eob_medallion_luck_stone_u_2")
spawn("eob_bones_human_kirath_u", 16,27,0, "eob_bones_human_kirath_u_1")
spawn("eob_orb_of_power__from_level11_u", 28,30,3, "eob_orb_of_power__from_level11_u_1")
spawn("eob_robe_protection5_u", 16,27,0, "eob_robe_protection5_u_1")
spawn("eob_wand_lightning_bolt_10_u", 3,8,1, "eob_wand_lightning_bolt_10_u_1")
spawn("eob_mage_scroll_hold_monster", 1,17,0, "eob_mage_scroll_hold_monster_1")
spawn("eob_long_sword_slasher", 1,1,0, "eob_long_sword_slasher_1")
spawn("eob_rock_mossy_u", 25,1,1, "eob_rock_mossy_u_2")
spawn("eob_ring2_u", 12,4,2, "eob_ring2_u_4")
spawn("eob_bracers_defense2_u", 16,27,0, "eob_bracers_defense2_u_1")
spawn("eob_mflayer1_1", 15,30,0, "eob_mflayer1_1_1")
spawn("eob_mflayer1_1", 4,27,0, "eob_mflayer1_1_2")
spawn("eob_mflayer1_1", 27,23,0, "eob_mflayer1_1_3")
spawn("eob_xorn", 23,2,0, "eob_xorn_1")
spawn("eob_xorn", 30,4,0, "eob_xorn_2")
spawn("eob_xorn", 30,10,0, "eob_xorn_3")
spawn("eob_xorn", 1,24,0, "eob_xorn_4")
spawn("eob_xorn", 30,8,0, "eob_xorn_5")
spawn("eob_mflayer1_1", 9,26,0, "eob_mflayer1_1_4")
spawn("eob_mflayer1_1", 29,25,0, "eob_mflayer1_1_5")
spawn("eob_mflayer1_1", 17,28,0, "eob_mflayer1_1_6")
spawn("eob_xorn", 27,7,0, "eob_xorn_6")
spawn("eob_mflayer1_1", 17,25,0, "eob_mflayer1_1_7")
spawn("eob_xorn", 25,2,0, "eob_xorn_7")
spawn("eob_xorn", 22,24,0, "eob_xorn_8")
spawn("eob_mflayer1_1", 29,19,0, "eob_mflayer1_1_8")
spawn("eob_mflayer1_1", 26,18,0, "eob_mflayer1_1_9")
spawn("eob_xorn", 27,1,0, "eob_xorn_9")
spawn("eob_xorn", 25,8,0, "eob_xorn_10")
spawn("eob_xorn", 7,30,0, "eob_xorn_11")
spawn("eob_xorn", 24,1,0, "eob_xorn_12")
spawn("eob_xorn", 26,12,0, "eob_xorn_13")

--- level 12 ---

mapName("Xanthar's Inner Sanctum")
setWallSet("temple")
playStream("assets/samples/music/temple_ambient.ogg")
mapDesc([[
################################
#.#....#...#...................#
#...............###.###.###.##.#
#.#######.##....#.#.###.###.##.#
#.######...####.#####..........#
#.######...#....#...#.##########
#.######...#....#...#.##...#..##
#.#######.#########.#..........#
#.......#.........#....#...##..#
#.###############.####.#####...#
#.#.#...#...#...#.#.##.#.#..#.##
#.....#...#.#.#.#....#......#.##
#.#.#...#...#...#.#.##.#.#..#.##
#.###############.####.######.##
#.#..#.....#....#.#..#.#..#....#
#....#...#.#....#....#....#....#
#.#..#...#.#....#.#..#.#..#...##
#.####...#.#....#.####.####...##
#........#.#....#....#.....#####
##########.##...####.#####.....#
#.......#...#.....#...#..####..#
#.......#...#.....#...#.....####
#.......#...#.....#####........#
#.......##.##..................#
#........#.#...................#
#........#.#...................#
#........###...................#
#..............................#
#..............................#
#..............................#
#..............................#
################################
]])
spawn("eob_sanctum_button", 6,1,0, "eob_sanctum_button_12_6_1_N")
spawn("eob_sanctum_pedestal", 3,1,3, "eob_sanctum_pedestal_12_3_1")
spawn("eob_sanctum_pedestal", 4,1,1, "eob_sanctum_pedestal_12_4_1")
spawn("eob_sanctum_pedestal", 5,1,1, "eob_sanctum_pedestal_12_5_1")
spawn("eob_sanctum_door", 26,1,1, "eob_sanctum_door_12_26_1")
	:addPullChain()
spawn("eob_sanctum_door", 7,2,1, "eob_sanctum_door_12_7_2")
	:addPullChain()
spawn("eob_sanctum_door", 11,2,1, "eob_sanctum_door_12_11_2")
spawn("eob_sanctum_pedestal", 13,2,2, "eob_sanctum_pedestal_12_13_2")
spawn("eob_sanctum_button", 18,1,2, "eob_sanctum_button_12_18_1_S")
spawn("eob_sanctum_door", 19,2,0, "eob_sanctum_door_12_19_2")
spawn("eob_sanctum_door", 23,2,0, "eob_sanctum_door_12_23_2")
spawn("eob_sanctum_skull_lock", 24,1,2, "eob_sanctum_skull_lock_12_24_1_S")
spawn("eob_sanctum_alcove", 28,1,2, "eob_sanctum_alcove_12_28_1_S")
	:addItem(spawn("eob_rations_iron_u"))
spawn("eob_sanctum_alcove", 30,2,3, "eob_sanctum_alcove_12_30_2_W")
	:addItem(spawn("eob_rations_iron_u"))
spawn("eob_sanctum_door", 1,3,0, "eob_sanctum_door_12_1_3")
	:addPullChain()
spawn("eob_sanctum_text", 3,2,2, "eob_sanctum_text_12_3_2_S")
	:setWallText("")
spawn("eob_sanctum_text", 4,2,2, "eob_sanctum_text_12_4_2_S")
	:setWallText("")
spawn("eob_sanctum_text", 5,2,2, "eob_sanctum_text_12_5_2_S")
	:setWallText("")
spawn("eob_sanctum_door", 9,3,0, "eob_sanctum_door_12_9_3")
	:addPullChain()
spawn("eob_sanctum_skull_lock", 22,4,0, "eob_sanctum_skull_lock_12_22_4_N")
spawn("eob_sanctum_door", 23,3,2, "eob_sanctum_door_12_23_3")
spawn("eob_sanctum_alcove", 27,3,1, "eob_sanctum_alcove_12_27_3_E")
	:addItem(spawn("eob_rations_iron_u"))
spawn("eob_sanctum_alcove", 29,4,0, "eob_sanctum_alcove_12_29_4_N")
	:addItem(spawn("eob_rations_iron_u"))
spawn("eob_sanctum_pedestal", 8,4,3, "eob_sanctum_pedestal_12_8_4")
spawn("eob_sanctum_pedestal_eye", 9,4,2, "eob_sanctum_pedestal_eye_12_9_4")
spawn("eob_sanctum_pedestal", 10,4,1, "eob_sanctum_pedestal_12_10_4")
spawn("eob_sanctum_secret_button_tiny", 14,3,2, "eob_sanctum_secret_button_tiny_12_14_3_S")
spawn("eob_sanctum_door", 15,4,0, "eob_sanctum_door_12_15_4")
spawn("eob_sanctum_door", 26,4,1, "eob_sanctum_door_12_26_4")
	:addPullChain()
spawn("eob_sanctum_secret_button_tiny", 17,5,3, "eob_sanctum_secret_button_tiny_12_17_5_W")
spawn("eob_sanctum_fireball_firing_pad", 29,6,0, "eob_sanctum_fireball_firing_pad_12_29_6_N")
spawn("eob_sanctum_door", 21,6,2, "eob_sanctum_door_12_21_6")
	:addPullChain()
spawn("eob_sanctum_wall_lamp", 1,7,3, "eob_sanctum_wall_lamp_12_1_7_W")
spawn("eob_sanctum_text", 9,7,3, "eob_sanctum_text_12_9_7_W")
	:setWallText("")
spawn("eob_sanctum_pressure_plate", 21,7,2, "eob_sanctum_pressure_plate_12_21_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_pressure_plate", 22,7,1, "eob_sanctum_pressure_plate_12_22_7")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_door", 23,7,3, "eob_sanctum_door_12_23_7")
	:addPullChain()
spawn("eob_blocker", 24,7,2, "eob_blocker_12_24_7")
spawn("eob_sanctum_door", 27,7,1, "eob_sanctum_door_12_27_7")
spawn("eob_sanctum_pressure_plate", 6,8,1, "eob_sanctum_pressure_plate_12_6_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_fireball_firing_pad", 7,8,1, "eob_sanctum_fireball_firing_pad_12_7_8_E")
spawn("eob_sanctum_door", 20,8,1, "eob_sanctum_door_12_20_8")
	:addPullChain()
spawn("eob_sanctum_pressure_plate", 21,8,2, "eob_sanctum_pressure_plate_12_21_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_pressure_plate", 22,8,2, "eob_sanctum_pressure_plate_12_22_8")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_door", 1,9,0, "eob_sanctum_door_12_1_9")
	:addPullChain()
spawn("eob_sanctum_secret_button_small", 6,8,2, "eob_sanctum_secret_button_small_12_6_8_S")
spawn("eob_sanctum_wall_lamp_smoke", 13,10,0, "eob_sanctum_wall_lamp_smoke_12_13_10_N")
spawn("eob_sanctum_wall_lamp", 15,10,0, "eob_sanctum_wall_lamp_12_15_10_N")
spawn("eob_sanctum_door", 17,9,0, "eob_sanctum_door_12_17_9")
	:addPullChain()
spawn("eob_sanctum_door", 22,9,0, "eob_sanctum_door_12_22_9")
	:addPullChain()
spawn("eob_sanctum_pedestal_eye", 28,9,3, "eob_sanctum_pedestal_eye_12_28_9_E")
spawn("eob_sanctum_pedestal_eye", 30,9,1, "eob_sanctum_pedestal_eye_12_30_9_W")
spawn("eob_sanctum_secret_button_tiny", 7,10,1, "eob_sanctum_secret_button_tiny_12_7_10_E")
spawn("eob_sanctum_fireball_firing_pad", 13,10,3, "eob_sanctum_fireball_firing_pad_12_13_10_W")
spawn("eob_sanctum_wall_lamp", 15,10,1, "eob_sanctum_wall_lamp_12_15_10_E")
spawn("eob_sanctum_fireball_firing_pad", 26,10,3, "eob_sanctum_fireball_firing_pad_12_26_10_W")
spawn("eob_sanctum_button", 27,10,1, "eob_sanctum_button_12_27_10_E")
spawn("eob_sanctum_wall_lamp", 1,11,3, "eob_sanctum_wall_lamp_12_1_11_W")
spawn("eob_sanctum_pressure_plate", 3,11,2, "eob_sanctum_pressure_plate_12_3_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_door", 4,11,1, "eob_sanctum_door_12_4_11")
	:addPullChain()
spawn("eob_sanctum_text", 7,11,3, "eob_sanctum_text_12_7_11_W")
	:setWallText("")
spawn("eob_sanctum_door", 8,11,1, "eob_sanctum_door_12_8_11")
	:addPullChain()
spawn("eob_sanctum_text", 11,11,3, "eob_sanctum_text_12_11_11_W")
	:setWallText("")
spawn("eob_sanctum_wall_lamp", 13,11,3, "eob_sanctum_wall_lamp_12_13_11_W")
spawn("eob_sanctum_portal_orb", 15,11,3, "eob_sanctum_portal_orb_12_15_11_W")
spawn("eob_sanctum_pressure_plate", 19,11,2, "eob_sanctum_pressure_plate_12_19_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_door", 20,11,3, "eob_sanctum_door_12_20_11")
spawn("eob_sanctum_button", 20,11,1, "eob_sanctum_button_12_20_11_E")
spawn("eob_sanctum_pressure_plate", 24,11,2, "eob_sanctum_pressure_plate_12_24_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_door", 25,11,1, "eob_sanctum_door_12_25_11")
	:addPullChain()
spawn("eob_sanctum_pressure_plate", 26,11,2, "eob_sanctum_pressure_plate_12_26_11")
	:setTriggeredByParty(true)
	:setTriggeredByMonster(true)
	:setTriggeredByItem(true)
spawn("eob_sanctum_button", 27,11,1, "eob_sanctum_button_12_27_11_E")
spawn("eob_sanctum_wall_lamp", 15,12,1, "eob_sanctum_wall_lamp_12_15_12_E")
spawn("eob_sanctum_fireball_firing_pad", 26,12,3, "eob_sanctum_fireball_firing_pad_12_26_12_W")
spawn("eob_sanctum_button", 27,12,1, "eob_sanctum_button_12_27_12_E")
spawn("eob_sanctum_door", 1,13,0, "eob_sanctum_door_12_1_13")
	:addPullChain()
spawn("eob_sanctum_wall_lamp", 14,12,2, "eob_sanctum_wall_lamp_12_14_12_S")
spawn("eob_sanctum_door", 17,13,0, "eob_sanctum_door_12_17_13")
	:addPullChain()
spawn("eob_sanctum_door", 22,13,0, "eob_sanctum_door_12_22_13")
	:addPullChain()
spawn("eob_sanctum_button", 4,14,1, "eob_sanctum_button_12_4_14_E")
spawn("eob_sanctum_door", 9,14,1, "eob_sanctum_door_12_9_14")
spawn("eob_sanctum_button", 20,14,1, "eob_sanctum_button_12_20_14_E")
spawn("eob_sanctum_button", 25,14,1, "eob_sanctum_button_12_25_14_E")
spawn("eob_sanctum_door", 2,15,3, "eob_sanctum_door_12_2_15")
	:addPullChain()
spawn("eob_sanctum_button", 4,15,1, "eob_sanctum_button_12_4_15_E")
spawn("eob_sanctum_pedestal", 7,15,2, "eob_sanctum_pedestal_12_7_15")
spawn("eob_sanctum_skull_lock", 8,15,1, "eob_sanctum_skull_lock_12_8_15_E")
spawn("eob_sanctum_door", 18,15,3, "eob_sanctum_door_12_18_15")
	:addPullChain()
spawn("eob_sanctum_button", 20,15,1, "eob_sanctum_button_12_20_15_E")
spawn("eob_sanctum_door", 23,15,3, "eob_sanctum_door_12_23_15")
	:addPullChain()
spawn("eob_sanctum_button", 25,15,1, "eob_sanctum_button_12_25_15_E")
spawn("eob_sanctum_button", 4,16,1, "eob_sanctum_button_12_4_16_E")
spawn("eob_sanctum_pedestal", 7,16,2, "eob_sanctum_pedestal_12_7_16")
spawn("eob_sanctum_button", 20,16,1, "eob_sanctum_button_12_20_16_E")
spawn("eob_sanctum_button", 25,16,1, "eob_sanctum_button_12_25_16_E")
spawn("eob_sanctum_pedestal_eye", 27,16,2, "eob_sanctum_pedestal_eye_12_27_16")
spawn("eob_sanctum_pedestal_eye", 29,16,2, "eob_sanctum_pedestal_eye_12_29_16")
spawn("eob_sanctum_pedestal", 7,17,2, "eob_sanctum_pedestal_12_7_17")
spawn("eob_sanctum_pedestal_eye", 27,17,3, "eob_sanctum_pedestal_eye_12_27_17_E")
spawn("eob_sanctum_spike_trap", 28,17,2, "eob_sanctum_spike_trap_12_28_17")
spawn("eob_sanctum_pedestal_eye", 29,17,1, "eob_sanctum_pedestal_eye_12_29_17_W")
spawn("eob_blocker", 1,18,2, "eob_blocker_12_1_18")
spawn("eob_sanctum_alcove", 28,17,2, "eob_sanctum_alcove_12_28_17_S")
	:addItem(spawn("eob_stone_scepter_u"))
	:addItem(spawn("eob_stone_holy_symbol_u"))
	:addItem(spawn("eob_stone_orb_u"))
	:addItem(spawn("eob_stone_scepter_u"))
	:addItem(spawn("eob_stone_medallion_u"))
	:addItem(spawn("eob_stone_necklace_u"))
	:addItem(spawn("eob_stone_dagger_u"))
spawn("eob_sanctum_door", 20,19,0, "eob_sanctum_door_12_20_19")
	:addPullChain()
spawn("eob_sanctum_door", 28,19,1, "eob_sanctum_door_12_28_19")
	:addPullChain()
spawn("eob_sanctum_pedestal_eye", 9,21,2, "eob_sanctum_pedestal_eye_12_9_21")
spawn("eob_sanctum_pedestal_eye", 11,21,2, "eob_sanctum_pedestal_eye_12_11_21")
spawn("eob_blocker", 10,22,2, "eob_blocker_12_10_22")
spawn("eob_sanctum_alcove", 9,22,2, "eob_sanctum_alcove_12_9_22_S")
	:addItem(spawn("eob_potion_invisibility"))
	:addItem(spawn("eob_potion_vitality"))
spawn("eob_sanctum_alcove", 11,22,2, "eob_sanctum_alcove_12_11_22_S")
	:addItem(spawn("eob_potion_invisibility"))
	:addItem(spawn("eob_potion_vitality"))
spawn("eob_wand_magic_missile_20_u", 23,2,3, "eob_wand_magic_missile_20_u_1")
spawn("eob_potion_invisibility", 17,3,0, "eob_potion_invisibility_1")
spawn("eob_potion_invisibility", 17,3,2, "eob_potion_invisibility_2")
spawn("eob_golem", 3,10,0, "eob_golem_1")
spawn("eob_golem1_1", 3,12,0, "eob_golem1_1_1")
spawn("eob_golem", 19,3,0, "eob_golem_2")
spawn("eob_golem", 10,25,0, "eob_golem_3")
spawn("eob_golem", 10,24,0, "eob_golem_4")
spawn("eob_golem", 10,23,0, "eob_golem_5")
spawn("eob_golem", 1,10,0, "eob_golem_6")
spawn("eob_golem", 1,12,0, "eob_golem_7")
